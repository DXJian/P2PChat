(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{"/MoV":function(e,t,i){"use strict";i.d(t,"i",(function(){return s})),i.d(t,"c",(function(){return c})),i.d(t,"g",(function(){return d})),i.d(t,"d",(function(){return l})),i.d(t,"a",(function(){return u})),i.d(t,"f",(function(){return m})),i.d(t,"h",(function(){return p})),i.d(t,"e",(function(){return h})),i.d(t,"b",(function(){return f}));var n=i("g6NE"),r=n.a.getters["config/configs"],o=n.a.getters["config/vars"],a=function(){return{timezone:r.authenticated?r.system.timezone:moment.tz.guess(),defaultDateFormat:o.defaultDateFormat,defaultDateTimeFormat:o.defaultDateTimeFormat,serverDateFormat:o.serverDateFormat,serverDateTimeFormat:o.serverDateTimeFormat,calendarLocale:{lastDay:o.defaultDateFormat,sameDay:o.defaultTimeFormat,lastWeek:o.defaultDateFormat,sameElse:o.defaultDateFormat}}},s=function(e,t){var i=a(),n=moment.utc().tz(t||i.timezone);return e&&e.hasOwnProperty("moment")&&e.moment?n:n.format(e||i.defaultDateTimeFormat)},c=function(e,t){var i=a(),n=moment(e,i.serverDateFormat);return e?(Array.isArray(e)&&(n=moment(e[0],e[1])),t&&t.hasOwnProperty("moment")&&t.moment?n:n.format(t||i.defaultDateFormat)):"INVALID DATE STRING"},d=function(e,t){var i=a(),n=moment(e,i.serverTimeFormat);return e?(Array.isArray(e)&&(n=moment(e[0],e[1])),t&&t.hasOwnProperty("moment")&&t.moment?n:n.format(t||i.defaultTimeFormat)):"INVALID TIME STRING"},l=function(e,t){var i=a(),n=moment(e,i.serverDateTimeFormat);return e?(Array.isArray(e)&&(n=moment(e[0],e[1])),t&&t.hasOwnProperty("moment")&&t.moment?n:n.format(t||i.defaultDateTimeFormat)):"INVALID DATE TIME STRING"},u=function(e,t){var i=a(),n=moment(e,i.serverDateTimeFormat);return e?(Array.isArray(e)&&(n=moment(e[0],e[1])),t&&t.hasOwnProperty("moment")&&t.moment?n:n.calendar(t||i.calendarLocale)):"INVALID DATE TIME STRING"},m=function(e,t,i){var n=a();if(!e)return"INVALID DATE STRING";var r=moment.utc(e,n.serverDateFormat);return"NOW"===e&&(r=moment.utc()),Array.isArray(e)&&(r=moment.utc(e[0],e[1])),t&&t.hasOwnProperty("moment")&&t.moment?r.tz(i||n.timezone):r.tz(i||n.timezone).format(t||n.defaultDateFormat)},p=function(e,t,i){var n=a(),r=moment.utc("".concat(moment().format(n.serverDateFormat)," ").concat(e),n.serverTimeFormat);return e?(Array.isArray(e)&&(r=moment.utc(e[0],e[1])),t&&t.hasOwnProperty("moment")&&t.moment?r.tz(i||n.timezone):r.tz(i||n.timezone).format(t||n.defaultTimeFormat)):"INVALID TIME STRING"},h=function(e,t,i){var n,r=a();return e?(n="NOW"===e?moment.utc():Array.isArray(e)?moment.utc(e[0],e[1]):moment.utc(e,r.serverDateTimeFormat),t&&t.hasOwnProperty("moment")&&t.moment?n.tz(i||r.timezone):n.tz(i||r.timezone).format(t||r.defaultDateTimeFormat)):"INVALID DATE TIME STRING"},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=a(),r=moment.utc(e,n.serverDateTimeFormat);if(!e)return"INVALID DATE TIME STRING";Array.isArray(e)&&(r=moment.utc(e[0],e[1]));var o=r.tz(i||n.timezone);return t&&t.hasOwnProperty("moment")&&t.moment?o:o=o.calendar(t||n.calendarLocale)}},0:function(e,t){},"0D4p":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("Vjiq"),r=i("vDqi"),o=i.n(r),a=i("eC5B"),s=i.n(a),c=i("g6NE"),d=function(){var e=c.a.getters["config/configs"],t=e.hasOwnProperty("pusher")?e.pusher:null;!window.Echo&&t&&t.pusherAppKey&&(t.debugMode?s.a.logToConsole=!0:s.a.logToConsole=!1,window.Echo=new n.a({broadcaster:"pusher",cluster:t.pusherAppCluster,encrypted:!0,key:t.pusherAppKey,authorizer:function(e,t){return{authorize:function(t,i){o.a.post("/api/broadcasting/auth",{socket_id:t,channel_name:e.name}).then((function(e){e&&e.data?i(!1,e.data):console.error("Invalid Data!")})).catch((function(e){i(!0,e)}))}}}}),window.EchoOpts={subscriptions:{}})}},"1TzJ":function(e,t,i){"use strict";var n=i("p46w"),r=i.n(n),o=i("7Cbv");!function(){var e=1,t=2;function i(i){var n="";switch(i){case e:n=window.name;break;case t:null!=(n=decodeURIComponent(r.a.get("my-application-browser-tab")))&&"undefined"!=n||(n="")}return n}function n(i,n){switch(i){case e:window.name=n;break;case t:r.a.set("my-application-browser-tab",n||"")}}function a(){var r=i(e)||Object(o.a)();n(e,r);var a=i(t),s=(""==a?null:JSON.parse(a))||null;if(null===s||s.timestamp<(new Date).getTime()-5e3||s.guid===r){var c=function(){var e={guid:r,timestamp:(new Date).getTime()};n(t,JSON.stringify(e))};return c(),setInterval(c,500),!1}return!0}window.isDuplicate=function(){return a()},window.addEventListener("beforeunload",(function(){0==a()&&n(t,"")}))}()},"8uEn":function(e,t,i){"use strict";function n(e,t){t||(t={});var i=t.max||100,n=t.boxCount||50,r=t.boxCountRed||5,o=t.boxCountYellow||5,a=t.boxGapFraction||0,s=t.jitter||.02,c=t.width||"auto",d=e.width,l=e.height,u=0,m=e.parentElement,p=e.nextElementSibling||e.previousElementSibling;"auto"!==c&&"parent"!==c||!m.clientWidth?"sibling"===c&&p.clientWidth&&(d=p.clientWidth,e.width=d):(d=m.clientWidth,e.width=d);var h=d/(n+(n+1)*a),f=h*a,v=l-2*f,g=(l-v)/2,b=e.getContext("2d");function C(e,t){return e>n-r?y(e,t)?"rgba(255,47,30,0.9)":"rgba(64,12,8,0.9)":e>n-r-o?y(e,t)?"rgba(255,215,5,0.9)":"rgba(64,53,0,0.9)":y(e,t)?"rgba(53,255,30,0.9)":"rgba(13,64,8,0.9)"}function y(e,t){return e<=Math.ceil(t/i*n)}!function t(){var r=parseInt(e.dataset.val,10);if(u<=r?u+=(r-u)/5:u-=(u-r)/5,s>0&&u>0){var o=Math.random()*s*i;Math.random()>.5&&(o=-o),u+=o}u<0&&(u=0),b.save(),b.beginPath(),b.rect(0,0,d,l),b.fillStyle="rgb(32,32,32)",b.fill(),b.restore(),function(e,t){e.save(),e.translate(g,f);for(var i=0;i<n;i++){var r=(o=i,Math.abs(o)+1);e.beginPath(),e.rect(0,0,h,v),e.fillStyle=C(r,t),e.fill(),e.translate(h+f,0)}var o;e.restore()}(b,u),requestAnimationFrame(t)}()}i.d(t,"a",(function(){return n}))},U8Zb:function(e,t,i){"use strict";i.r(t);var n,r=i("L2JU"),o=i("gFX4"),a=i.n(o),s=i("zWga"),c=i.n(s),d=(i("qe5e"),i("mpN2"),i("x18S")),l=i.n(d),u=(i("l4sq"),i("k7+O")),m=i.n(u),p=i("0D4p"),h=i("akQX"),f=i("V0LQ"),v=i("lUM2"),g=i("PCDP"),b=i("/MoV"),C=i("8uEn"),y=(i("1TzJ"),i("kogc"));function S(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return w(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function T(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function R(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?T(Object(i),!0).forEach((function(t){E(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):T(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function E(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var k=document.createElement("script");k.setAttribute("src","/js/EBML.js"),document.head.appendChild(k),window.io=a.a,window.hark=l.a;var P={components:{RTCMultiConnection:c.a},data:function(){return{uuid:null,entity:null,entityDatesBackup:{},isLoading:!1,prevRoute:null,fullScreenItemId:null,meetingRoomId:null,initUrl:"meetings",fallBackRoute:"login",newMessages:!1,roomIdAlive:!1,showFlipClock:!0,duplicateTab:!1,fullScreenInOn:!1,mediaDeviceIssue:!1,permissionRejected:!1,needStreamAddOrReplace:!1,membersLive:[],videoList:[],mediaConfigFormData:{},mediaConfigurations:{selectedAudioInput:null,selectedAudioOutput:null,selectedVideoInput:null,activeAudioInput:null,activeVideoInput:null,activeFacingMode:null,selectedResolution:"Auto",facingMode:"auto",frameRate:"auto",bandwidth:{audio:"auto",video:"auto",screen:"auto",audioMin:6,videoMin:100,screenMin:300},recording:{type:"video",mimeType:"video/webm",timeSlice:5e3,disableLogs:!1}},audioBandwidthOpts:[{uuid:"auto",label:"Auto"},{uuid:64,label:"64 kbps"},{uuid:128,label:"128 kbps"},{uuid:256,label:"256 kbps"},{uuid:510,label:"512 kbps"}],videoBandwidthOpts:[{uuid:"auto",label:"Auto"},{uuid:128,label:"128 kbps"},{uuid:256,label:"256 kbps"},{uuid:512,label:"512 kbps"},{uuid:1024,label:"1 mbps"},{uuid:2e3,label:"2 mbps"}],screenBandwidthOpts:[{uuid:"auto",label:"Auto"},{uuid:512,label:"512 kbps"},{uuid:1024,label:"1 mbps"},{uuid:2048,label:"2 mbps"},{uuid:3e3,label:"3 mbps"},{uuid:4e3,label:"4 mbps"}],mediaDevices:{audioInput:[{uuid:"auto",name:"Auto"}],audioOutput:[{uuid:"auto",name:"Auto"}],videoInput:[{uuid:"auto",name:"Auto"}],resolutions:[{label:"Auto",constraints:{}},{label:"240p",constraints:{width:{max:320,ideal:320},height:{max:240,ideal:240}}},{label:"240p Wide",constraints:{width:{max:426,ideal:426},height:{max:240,ideal:240}},wide:!0},{label:"360p",constraints:{width:{max:640,ideal:640},height:{max:480,ideal:480}}},{label:"360p Wide",constraints:{width:{max:640,ideal:640},height:{max:360,ideal:360}},wide:!0},{label:"720p",constraints:{width:{max:960,ideal:960},height:{max:720,ideal:720}}},{label:"720p Wide",constraints:{width:{max:1280,ideal:1280},height:{max:720,ideal:720}},wide:!0},{label:"1080p",constraints:{width:{max:1920,ideal:1920},height:{max:1080,ideal:1080}}},{label:"4K",constraints:{width:{max:4096,ideal:4096},height:{max:2160,ideal:2160}}}],facingModes:[{uuid:"auto",label:"Auto"},{uuid:"user",label:"User"},{uuid:"environment",label:"Environment"}],frameRates:[{uuid:"auto",label:"Auto"},{uuid:30,label:"30 fps"},{uuid:60,label:"60 fps"}]},socketURL:"aHR0cHM6Ly9zaWduYWwua29kZW1pbnQuaW46OTAwMS8=",rtcmConnection:null,localVideo:null,localScreenStreamid:null,localWhiteboardStreamid:null,localGreenRoomStream:null,audioConstraints:{},videoConstraints:{},pageConfigs:{hasAgenda:!0,enableChat:!0,enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!0,showEnableVideoBtn:!0,showDeviceConfig:!0,enableScreenSharing:!0,enableRecording:!1,enableAutoRecording:!1,autoUploadRecording:!1,autoUploadRecorded:!1,canStopAutoRecording:!1,recordingTimeSlice:5e3,enableHandGesture:!0,enableWhiteboard:!1,footerAutoHide:!1,disableScroll:!1,speechDetection:!1,muteParticipantsOnStart:!1,allowJoiningWithoutDevices:!1,enableFileSharing:!0,enableLinkSharing:!0,enableSnapshot:!1,anyoneCanTakeSnapshot:!1,enableSnapshotAlert:!1,snapshotAlertToUserOnly:!1,snapshotAlertToModerators:!1,askHostBeforeJoining:!1,preferRearCameraFirst:!1,enableUserAvatar:!1,enableFullUserAvatar:!1,enableMeetingInfo:!1,forceUpdateUsername:!1,autoEndMeeting:!1,alertBeforeAutoEnd:!1,canSnoozeAutoEnd:!1,canCancelAutoEnd:!1,alertBeforeAutoEndTime:1,endTimeSnoozePeriod:1,layout:"fullpage",lastLayout:"fullpage",maxParticipantCount:1e3},meetingRulesHost:{session:{audio:!1,video:!1,screen:!1,data:!1,oneway:!1},mediaConstraints:{audio:!1,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},autoCloseEntireSession:!1},meetingRulesGuest:{session:{audio:!1,video:!1,screen:!1,data:!1,oneway:!1},mediaConstraints:{audio:!1,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},autoCloseEntireSession:!1},snoozeOpts:[{uuid:5,name:5,type:"m"},{uuid:10,name:10,type:"m"},{uuid:15,name:15,type:"m"},{uuid:30,name:30,type:"m"},{uuid:60,name:1,type:"h"}],isHandUp:!1,recording:!1,recorded:!1,recordingPaused:!1,recordingDuration:null,showDevicesModal:!1,showFileSharing:!1,showWhiteboard:!1,showAgenda:!0,fileSharingConnection:null,canvasDesigner:null,autoEndingToast:null,micVolumeActivity:20,meetingRoomNotFound:!1,profile:{uuid:"",username:"",name:""}}},computed:R(R({},Object(r.c)("config",["configs","uiConfigs","vars"])),{},{user:function(){return this.profile},hasVideos:function(){return this.videoList&&this.videoList.length>0?this.videoList.length:0},hasVideosClasses:function(){if(!this.hasVideos)return"has-no-video";var e="has-videos "+(this.pageConfigs.disableScroll?"disable-scroll ":"")+"has-".concat(this.hasVideos,"-videos "),t=this.hasVideos>15?4:this.hasVideos>8?3:this.hasVideos>3?2:1,i=this.hasVideos>20?6:16===this.hasVideos?4:this.hasVideos>12?5:this.hasVideos>9?4:9===this.hasVideos?3:this.hasVideos>6?4:this.hasVideos>4?3:4===this.hasVideos?2:this.hasVideos;return e+(this.hasVideos>20?"has-gt-20-videos":this.hasVideos>12?"has-gt-12-videos":this.hasVideos>4?"has-gt-4-videos":this.hasVideos>1?"has-2-3-videos":"has-1-video")+" has-".concat(t,"-rows has-").concat(i,"-per-row")},liveMembersCount:function(){return this.membersLive.length-1},startDateTimeIsFuture:function(){var e=this.entity&&this.showFlipClock&&this.isStartDateTimeInFuture();return e?this.startCountDown():window.countdownInterval&&clearInterval(window.countdownInterval),e},enableLogs:function(){return this.rtcmConnection&&this.rtcmConnection.enableLogs||this.configs.meeting.debugMode},coverPageStyles:function(){return this.entity&&this.entity.cover&&this.hasVideos?{backgroundImage:"url("+this.entity.cover+")"}:{}}}),watch:{liveMembersCount:function(e,t){window.isLiveMeetingDestroyed||e===t||this.meetingRoomCreated(this.entity)}},methods:R(R(R({},Object(r.b)("config",["GetConfig","SetUiConfig"])),Object(r.b)("common",["Init","Get","Custom","GetPreRequisite"])),{},(n={stopAutoEndMeeting:function(){window.autoEndMeetingTimeout&&(clearInterval(window.autoEndMeetingTimeout),window.autoEndMeetingTimeout=null),this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(y.e.close(),this.autoEndingToast=null)},startAutoEndMeeting:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300;window.autoEndMeetingTimeout&&(clearInterval(window.autoEndMeetingTimeout),window.autoEndMeetingTimeout=null),window.autoEndMeetingTimeout=setTimeout((function(){e.getOffline()}),1e3*t)},startMeetingTimer:function(){var e=this;if(window.meetingDurationInterval&&(this.meetingDuration=null,clearInterval(window.meetingDurationInterval)),this.entity&&"live"===this.entity.status){var t=moment(this.entity.startedAt,this.vars.serverDateTimeFormat).valueOf();window.meetingDurationInterval=window.setInterval((function(){var i=b.i({moment:!0}).valueOf();e.meetingDuration=Object(f.b)((i-t)/1e3),function(){if(!e.entity||"live"!==e.entity.status)return e.stopAutoEndMeeting(),void e.stopMeetingTimer();if(e.pageConfigs.autoEndMeeting&&e.entity.estimatedEndTime){var t=e.pageConfigs.alertBeforeAutoEndTime||5,i=moment(e.entity.estimatedEndTime,e.vars.serverDateTimeFormat),n=b.i({moment:!0}),r=((i.valueOf()-n.valueOf())/1e3).toFixed(0);if(r<=0)window.autoEndMeetingTimeout&&(clearInterval(window.autoEndMeetingTimeout),window.autoEndMeetingTimeout=null),e.getOffline();else if(r<=60*t){var o=Object(f.b)(r)+" "+$t("list.general.durations.seconds");if(r>=60?o=Object(f.b)(r)+" "+$t("list.general.durations.minutes"):r>=3600&&(o=Object(f.b)(r)+" "+$t("list.general.durations.hours")),e.pageConfigs.alertBeforeAutoEnd)if(window.autoEndMeetingTimeout&&e.autoEndingToast&&y.a.isVisible()&&y.a.isTimerRunning())y.e.update({title:$t("meeting.auto_ending_msg",{attribute:o})});else{if(!e.autoEndingToast&&y.a.isVisible())return;e.autoEndingToast&&e.autoEndingToast.close&&_.isFunction(e.autoEndingToast.close)&&(y.e.close(),e.autoEndingToast=null),e.autoEndingToast=y.e.fire({iconHtml:'<i class="far fa-clock"></i>',title:$t("meeting.auto_ending_msg",{attribute:o}),timer:1e3*r,showConfirmButton:!1,position:"bottom"})}window.autoEndMeetingTimeout&&e.autoEndingToast||(e.stopAutoEndMeeting(),e.startAutoEndMeeting(r))}else r>60*t?e.autoEndingToast&&e.autoEndingToast.close&&_.isFunction(e.autoEndingToast.close)&&(y.e.close(),e.autoEndingToast=null):e.stopAutoEndMeeting()}}()}),1e3)}},stopMeetingTimer:function(){window.meetingDurationInterval&&(this.meetingDuration=null,clearInterval(window.meetingDurationInterval))},shareURL:function(){var e=this;if(this.entity){this.$gaEvent("engagement","shareURL","Shown");var t=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");t+=this.entity.identifier?"/m/".concat(this.entity.identifier):"/app/live/meetings/".concat(this.entity.uuid);var i=this.entity.identifier?"".concat($t("meeting.meeting_code"),': <strong class="ml-2"> ').concat(this.entity.identifier,"</strong>"):null;Object(h.d)({title:$t("meeting.user_inviting_msg",{attribute:this.user.name}),alertTitle:i,alertHtml:"".concat($t("misc.share_alert.text"),"<br>")+"<small class='text-muted'>".concat(t,"</small><br>"),url:t},(function(){e.$gaEvent("engagement","shareURL","Copied"),e.$toasted.success($t("meeting.url_has_been_copied"),e.$toastConfig)}))}},isStartDateTimeInFuture:function(){return this.entity&&this.entity.startDateTime&&moment(this.entity.startDateTime,this.vars.serverDateTimeFormat).isAfter(b.i({moment:!0}))},startCountDown:function(){var e=this;window.countdownInterval&&clearInterval(window.countdownInterval),window.countdownInterval=window.setInterval((function(){e.isStartDateTimeInFuture()?e.showFlipClock=!0:(e.showFlipClock&&!document.hasFocus()&&Object(h.a)(),e.showFlipClock=!1)}),1e3)},takeSnapshotOfStream:function(e,t){var i=this;if(this.pageConfigs.enableSnapshot&&this.pageConfigs.anyoneCanTakeSnapshot){this.$gaEvent("engagement","takeSnapshot");var n=this.takeSnapshot(this.$refs.videos[t],!e.disableMirror),r="".concat(e.extra.username," stream by ").concat(this.username);this.Custom({url:"/".concat(this.initUrl,"/").concat(this.uuid,"/snapshots"),method:"post",data:{image:n,name:r}}).then((function(e){i.$toasted.info($t("meeting.snapshot_taken"),R(R({},i.$toastConfig.info),{},{duration:1e4,icon:{name:"fa-download"},action:{text:"View / Download",href:e.fullUrl,target:"_blank"}}))})).catch((function(e){i.isLoading=!1,formUtil.handleErrors(e)})),this.informAboutSnapshot(e),Object(h.c)()}},takeSnapshot:function(e,t){var i=document.createElement("canvas");i.width=2*(e.videoWidth||e.clientWidth),i.height=2*(e.videoHeight||e.clientHeight);var n=i.getContext("2d");return this.configs.meeting&&this.configs.meeting.mirroredVideo&&t&&(n.translate(i.width,0),n.scale(-1,1)),n.drawImage(e,0,0,i.width,i.height),i.toDataURL("image/png")},informAboutSnapshot:function(e){this.pageConfigs.enableSnapshotAlert&&this.emitSocketEvents("snapshotTaken",{byUser:this.user,ofUser:e.extra,item:e})},toggleHandUp:function(){var e=this;this.$gaEvent("engagement","toggleHandUp"),window.lowerHandTimer&&clearTimeout(window.lowerHandTimer);var t=this.$refs.videos.find((function(t){return t.id===e.localVideo.id})),i=this.videoList.findIndex((function(t){return t.id===e.localVideo.id}));if(t&&t.srcObject){var n=t.srcObject;this.isHandUp=!this.isHandUp,this.videoList[i].isHandUp=this.isHandUp,this.emitSocketEvents("remoteHandToggled",{isHandUp:this.isHandUp,streamid:n.streamid}),this.isHandUp&&(window.lowerHandTimer=setTimeout((function(){e.toggleHandUp()}),3e4)),this.rtcmConnection.extra.isHandUp=this.isHandUp,this.updateExtraData()}else this.localVideo=null},toggleAudio:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pageConfigs.enableAudio=!i&&!this.pageConfigs.enableAudio,this.rtcmConnection&&(this.rtcmConnection.extra.audioMuted=!this.pageConfigs.enableAudio,this.updateExtraData()),this.$refs.videos&&this.$refs.videos.length){var n=this.$refs.videos.find((function(e){return e.id===t.localVideo.id})),r=this.videoList.findIndex((function(e){return e.id===t.localVideo.id}));if(n&&n.srcObject){var o=n.srcObject,a=o.getAudioTracks();a.forEach((function(e){t.pageConfigs.enableAudio?(e.enabled=!0,t.videoList[r].audioMuted=!1):(e.enabled=!1,t.videoList[r].audioMuted=!0)})),this.emitSocketEvents("remoteMutedUnmuted",{audioEnabled:this.pageConfigs.enableAudio,streamid:o.streamid})}else this.localVideo=null}else this.setupGreenRoom()},toggleVideo:function(){var e=this;if(this.pageConfigs.enableVideo=!this.pageConfigs.enableVideo,this.rtcmConnection&&(this.rtcmConnection.extra.videoMuted=!this.pageConfigs.enableVideo,this.updateExtraData()),this.$refs.videos&&this.$refs.videos.length){var t=this.$refs.videos.find((function(t){return t.id===e.localVideo.id})),i=this.videoList.findIndex((function(t){return t.id===e.localVideo.id}));if(t&&t.srcObject){var n=t.srcObject;n.getVideoTracks().forEach((function(t){e.pageConfigs.enableVideo?(t.enabled=!0,e.videoList[i].videoMuted=!1):(t.enabled=!1,e.videoList[i].videoMuted=!0)})),this.emitSocketEvents("remoteMutedUnmuted",{videoEnabled:this.pageConfigs.enableVideo,streamid:n.streamid})}else this.localVideo=null}else this.setupGreenRoom()},toggleRemoteAudio:function(e,t){e.muted?(this.videoList[t].muted=!1,this.$refs.videos[t].muted=!1):(this.videoList[t].muted=!0,this.$refs.videos[t].muted=!0)},toggleRemoteAudioSource:function(e,t){this.emitSocketEvents("muteUnmuteRemote",e)},toggleEleFullScreen:function(e,t){var i=this,n=this.$refs.videoListEle;this.fullScreenItemId=e.id,this.$fullscreen.toggle(n,{wrap:!1,callback:function(e){i.fullScreenInOn=e}})},toggleFullScreen:function(e){m.a.isEnabled&&(e?m.a.request():m.a.exit())},toggleFooterAutoHide:function(){this.pageConfigs.footerAutoHide=!this.pageConfigs.footerAutoHide,this.$gaEvent("engagement","toggleFooterAutoHide")},toggleLayout:function(e){this.pageConfigs.layout=e||this.pageConfigs.layout,this.pageConfigs.disableScroll="grid"===this.pageConfigs.layout||(this.entity.config&&this.entity.config.hasOwnProperty("disableScroll")?this.entity.config.disableScroll:this.pageConfigs.disableScroll),this.$gaEvent("engagement","toggleLayout",e)},toggleFileSharing:function(){this.showFileSharing=!this.showFileSharing,this.$gaEvent("engagement","toggleFileSharing")},toggleAgenda:function(){this.showAgenda=!this.showAgenda,this.$gaEvent("engagement","toggleAgenda")},toggleWhiteboard:function(){this.$gaEvent("engagement","toggleWhiteboard"),this.showWhiteboard?(this.pageConfigs.layout=this.pageConfigs.lastLayout,this.showWhiteboard=!1):(this.canvasDesigner||this.initWhiteboard(),this.pageConfigs.lastLayout=this.pageConfigs.layout,this.pageConfigs.layout="presentation",this.showWhiteboard=!0)},changeFocus:function(e){this.videoList.forEach((function(t){t.maximized=t.id===e.id}))},disableMirror:function(e,t){this.videoList[t].disableMirror=!this.videoList[t].disableMirror},kickRemoteUser:function(e,t){var i=this;formUtil.confirmAction().then((function(t){if(t.value){var n=i.$refs.videos.find((function(t){return t.id===e.id}));if(n&&n.srcObject){var r=n.srcObject;i.rtcmConnection.removeStream(r.streamid),i.emitSocketEvents("banAttendee",e),i.Custom({url:"/".concat(i.initUrl,"/").concat(i.uuid,"/invitees/").concat(e.extra.uuid,"/block"),method:"post"}).then((function(e){i.$toasted.success(e.message,i.$toastConfig)})).catch((function(e){formUtil.handleErrors(e)}))}}else t.dismiss,y.a.DismissReason.cancel}))},switchCamera:function(){this.mediaConfigurations.facingMode="user"===this.mediaConfigurations.facingMode?"environment":"user",this.applyMediaConstraints()},stopStream:function(e){var t=this.$refs.videos.find((function(t){return t.id===e.id}));if(t&&t.srcObject){var i=t.srcObject;this.stopStream(i)}},afterJoiningChannel:function(e){this.membersLive=e},newMemberJoining:function(e){this.membersLive.push(e)},memberLeaving:function(e){this.membersLive=this.membersLive.filter((function(t){return t.uuid!==e.uuid}))},updateEntityBackup:function(e){this.entityDatesBackup.status=e.status,this.entityDatesBackup.startDateTime=e.startDateTime,this.entityDatesBackup.plannedStartDateTime=e.plannedStartDateTime,this.entityDatesBackup.startedAt=e.startedAt,this.entityDatesBackup.estimatedEndTime=e.estimatedEndTime,this.entityDatesBackup.endedAt=e.endedAt},meetingStatusChanged:function(e){var t=this,i=function(e){return b.e(e,t.vars.serverDateTimeFormat)};if(e.uuid===this.entity.uuid){if(this.entity.status===e.status&&!e.delayed&&!e.updated)return;if(e.updated&&this.stopAutoEndMeeting(),this.updateEntityBackup(e),this.entity.status=e.status,this.entity.startDateTime=i(e.startDateTime),this.entity.plannedStartDateTime&&(this.entity.plannedStartDateTime=i(e.plannedStartDateTime)),this.entity.startedAt&&(this.entity.startedAt=i(e.startedAt)),this.entity.estimatedEndTime&&(this.entity.estimatedEndTime=i(e.estimatedEndTime)),this.entity.status===e.status&&!e.delayed)return;var n=e.status;"scheduled"===n&&e.delayed&&(n="delayed");this.$toasted.success($t({live:"meeting.is_live_now",delayed:"meeting.meeting_delayed",cancelled:"meeting.meeting_cancelled",ended:"meeting.meeting_ended"}[n]),this.$toastConfig)}},gotNewMessage:function(){this.pageConfigs.enableChat&&this.configs.chat&&this.configs.chat.enabled&&(this.pageConfigs.showChat&&!this.fullScreenInOn||(this.newMessages=!0,Object(h.a)()))},meetingRoomCreated:function(e){var t=this,i=e.hasOwnProperty("data")&&e.data?e.data:e;this.entity.roomId=i.roomId,this.initMediaAndRtcmConnection(),this.rtcmConnection.checkPresence(this.entity.roomId,(function(e,i){t.roomIdAlive=!!e,!0===e&&!0===t.meetingRoomNotFound&&(t.meetingRoomNotFound=!1,t.getOnline())}))},banAttendee:function(e){var t=e.hasOwnProperty("data")&&e.data?e.data:e;this.enableLogs&&console.log(t);var i=this.$refs.videos.find((function(e){return e.id===t.id}));if(i&&i.srcObject){var n=i.srcObject;this.rtcmConnection.removeStream(n.streamid)}e.uuid===this.userUuid&&(this.closeConnectionAndStream(),this.getInitialData()),this.$toasted.info($t("meeting.ban_notification"),this.$toastConfig.info)},streamRemoved:function(e){var t=e.hasOwnProperty("data")&&e.data?e.data:e;this.rtcmConnection&&t.id&&this.rtcmConnection.removeStream(t.id),this.rtcmOnStreamEnded(t)},meetingEnded:function(e){e.hasOwnProperty("data")&&e.data&&e.data;this.closeConnectionAndStream(),this.getInitialData()},joinChannel:function(){window.Echo&&(this.entity.isPam?window.meetingChannel=window.Echo.channel("MeetingGuest.".concat(this.uuid)):(window.meetingChannel=window.Echo.join("Meeting.".concat(this.uuid)),window.meetingChannel.here(this.afterJoiningChannel).joining(this.newMemberJoining).leaving(this.memberLeaving)),window.meetingChannel.listen("MeetingStatusChanged",this.meetingStatusChanged).listen("NewMessage",this.gotNewMessage).listen("MeetingRoomCreated",this.meetingRoomCreated).listen("PublicMeetingRoomCreated",this.meetingRoomCreated))},emitSocketEvents:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.rtcmConnection&&this.rtcmConnection.socket&&e){this.enableLogs&&console.log("Emitting on Socket: ",e);try{this.rtcmConnection.socket.emit("Whisper",{event:e,data:t})}catch(e){}}},rtcmOnOpen:function(e){var t=this;this.canvasDesigner&&this.canvasDesigner.pointsLength<=0&&setTimeout((function(){t.rtcmConnection.send("sync-canvas-points")}),1e3),this.canvasDesigner&&this.rtcmConnection.isInitiator&&setTimeout((function(){this.canvasDesigner.renderStream()}),1e3)},rtcmOnClose:function(e){},rtcmOnMessage:function(e){},rtcmOnUserStatusChanged:function(e){var t=this,i=this.rtcmConnection.userid;this.enableLogs&&(console.log("On rtcmOnUserStatusChanged - event : ",e),console.log("On rtcmOnUserStatusChanged - localUserId : ",i));var n=this.videoList.filter((function(t){return t.id===e.userid||t.streamUserId===e.userid||e.extra&&t.uuid===e.extra.uuid}));e&&"online"===e.status?n&&n.length?n.forEach((function(i){if(i.username!==e.extra.username){var n=t.videoList.findIndex((function(e){return e.uuid===i.uuid}));t.videoList[n].username=e.extra.username,t.videoList[n].name=e.extra.name,t.videoList[n].extra&&(t.videoList[n].extra.username=e.extra.username,t.videoList[n].extra.name=e.extra.name)}})):e.extra&&e.extra.hasOwnProperty("username")&&e.extra.username&&function(e){var n=e.userid,r=e.userid===i?"local":"remote";if(t.rtcmConnection.isInitiator||t.entity.canModerate||"local"===r||"live_class"!==t.entity.type.uuid&&"webinar"!==t.entity.type.uuid){var o=t.videoList.find((function(t){return t.id===e.streamid}));if(t.videoList.length>1&&t.recheckLiveParticipants(null),void 0===o){var a=R(R({id:n,streamUserId:e.userid,muted:!0},e.extra),{},{extra:e.extra,maximized:!1,local:"local"===r,screen:!1,status:!0,hasAudio:!1,hasVideo:!1,hasStream:!1,speaking:!1});t.videoList.push(a)}t.isLoading=!1}}(e):n&&n.length&&n.forEach((function(e){t.rtcmConnection.removeStream(e.id),t.recheckLiveParticipants(R(R({},e),{},{streamid:e.id})),t.autoSetVideoMaximized()}))},rtcmOnLeave:function(e){this.enableLogs&&console.log("On rtcmOnLeave - event : ",e)},rtcmOnSpeaking:function(e){var t=this,i=this.videoList.findIndex((function(t){return t.id===e.streamid}));window.onSilenceTimeoutObj["index"+i]&&clearTimeout(window.onSilenceTimeoutObj["index"+i]),this.videoList[i]&&(this.videoList[i].speaking=!0),window.onSilenceTimeoutObj["index"+i]=setTimeout((function(){t.videoList[i]&&(t.videoList[i].speaking=!1)}),5e3)},rtcmOnSilence:function(e){var t=this,i=this.videoList.findIndex((function(t){return t.id===e.streamid}));window.onSilenceTimeoutObj["index"+i]&&clearTimeout(window.onSilenceTimeoutObj["index"+i]),window.onSilenceTimeoutObj["index"+i]=setTimeout((function(){t.videoList[i]&&(t.videoList[i].speaking=!1)}),2e3)},rtcmOnVolumeChange:function(e){},rtcmOnStream:function(e){var t=this;if(this.enableLogs&&console.log("On Stream: ",e),this.rtcmConnection.isInitiator||this.entity.canModerate||"local"===e.type||"live_class"!==this.entity.type.uuid&&"webinar"!==this.entity.type.uuid||e.extra.isInitiator){var i=e.streamid,n=this.videoList.findIndex((function(t){return t.id===e.streamid||t.id===e.userid})),r=e.stream.idInstance?JSON.parse(e.stream.idInstance):e.stream,o=!(r.isAudio||r.audio||r.isVideo||r.video||r.isScreen||r.screen)&&e.extra.hasWhiteboard;if(r.isScreen&&"local"===e.type)this.localScreenStreamid=e.streamid,e.stream.getTracks().forEach((function(e){e.addEventListener("ended",t.stopSharingScreen)}));else o&&"local"===e.type&&(this.localWhiteboardStreamid=e.streamid);this.videoList.length>1&&this.recheckLiveParticipants(null);var a=R(R({id:i,streamUserId:e.userid,muted:"local"===e.type},e.extra),{},{extra:e.extra,maximized:"local"===e.type&&!r.isScreen&&!o,local:"local"===e.type,screen:e.extra.screenStreamId&&i===e.extra.screenStreamId||this.localScreenStreamid===i||r.isScreen,whiteboard:e.extra.whiteboardStreamId&&i===e.extra.whiteboardStreamId||o,status:!0,hasAudio:r.isAudio||r.audio,hasVideo:r.isVideo||r.video||r.isScreen||o||r.screen,hasStream:!0,speaking:!1,disableMirror:!1});if((a.screen||a.whiteboard)&&(a.videoMuted=!1),-1===n?"local"===e.type&&this.localScreenStreamid!==a.id&&this.localWhiteboardStreamid!==a.id?this.localVideo&&this.needStreamAddOrReplace?a.id=i=this.localVideo.id:(this.localVideo=a,this.videoList.push(a)):this.videoList.push(a):-1===n||this.videoList[n].hasStream||("local"===e.type&&this.localScreenStreamid!==a.id&&this.localWhiteboardStreamid!==a.id?this.localVideo&&this.needStreamAddOrReplace?a.id=i=this.localVideo.id:(this.localVideo=a,this.videoList[n]=Object.assign({},this.videoList[n],a)):this.videoList[n]=Object.assign({},this.videoList[n],a)),this.autoSetVideoMaximized(),this.pageConfigs.enableRecording){var s=this.rtcmConnection.recorder;if(s){var c=s.getInternalRecorder();this.recording&&c&&c.addStreams(e.stream)}}setTimeout((function(){t.enableLogs&&(console.log("$refs : ",t.$refs),console.log("$refs.videos : ",t.$refs.videos));for(var n=0,a=t.$refs.videos.length;n<a;n++)if(t.$refs.videos[n].id===i||t.$refs.videos[n].id===e.userid){t.$refs.videos[n].srcObject=e.stream;break}"local"===e.type&&t.applyOnStartConfigs(),setTimeout((function(){!t.pageConfigs.speechDetection||o||r.isScreen||t.initHark({stream:e.stream,streamedObject:e,connection:t.rtcmConnection})}),1e3)}),500),this.isLoading=!1}},rtcmOnStreamEnded:function(e){this.recheckLiveParticipants(e),this.autoSetVideoMaximized()},rtcmOnError:function(e){this.isLoading=!1},rtcmOnMediaError:function(e){var t=this;this.isLoading=!1,window.currentUserMediaRequest&&(window.currentUserMediaRequest.mutex=!1),this.enableLogs&&console.log("onMediaError : ",e),this.mediaDeviceIssue=!0,Object(h.e)(e).alert.then((function(i){"NotFoundError"===e.name||"NotReadableError"===e.name||"OverconstrainedError"===e.name?(t.applyMediaConstraints(!0),t.$toasted.info($t("meeting.media_devices.setup_reset_try_again"),t.$toastConfig.info)):"NotAllowedError"!==e.name&&"PermissionDeniedError"!==e.name||(t.permissionRejected=!0),i.value||(t.isLoading=!1,i.dismiss,y.a.DismissReason.cancel)}))},rtcmOnMute:function(e){this.enableLogs&&console.log("On rtcmOnMute: ",e);var t=this.videoList.findIndex((function(t){return t.id===e.streamid})),i=this.$refs.videos.find((function(t){return t.id===e.streamid}));"video"===e.muteType?this.videoList[t].videoMuted=!0:"audio"===e.muteType?this.videoList[t].muted=!0:(this.videoList[t].videoMuted=!0,this.videoList[t].muted=!0,i.srcObject=null)},rtcmOnUnmute:function(e){this.enableLogs&&console.log(e);var t=this.videoList.findIndex((function(t){return t.id===e.streamid})),i=this.$refs.videos.find((function(t){return t.id===e.streamid}));"video"===e.unmuteType?this.videoList[t].videoMuted=!1:"audio"===e.unmuteType?this.videoList[t].muted=!1:(this.videoList[t].videoMuted=!1,this.videoList[t].muted=!1,i.srcObject=e)},rtcmOnRemoteMuteUnmuted:function(e){var t=e.hasOwnProperty("data")&&e.data?e.data:e;this.enableLogs&&console.log(t);var i=this.videoList.findIndex((function(e){return e.id===t.streamid}));-1!==i&&this.videoList[i]&&(t.hasOwnProperty("audioEnabled")?t.audioEnabled?this.videoList[i].audioMuted=!1:this.videoList[i].audioMuted=!0:t.hasOwnProperty("videoEnabled")&&(t.videoEnabled?this.videoList[i].videoMuted=!1:this.videoList[i].videoMuted=!0))},rtcmOnSnapshotTaken:function(e){var t=e.hasOwnProperty("data")&&e.data?e.data:e;this.enableLogs&&console.log("rtcmOnSnapshotTaken",t),this.pageConfigs.enableSnapshotAlert&&t&&t.byUser&&t.ofUser&&(this.pageConfigs.snapshotAlertToUserOnly?this.userUuid===t.ofUser.uuid&&(this.$toasted.info($t("meeting.snapshot_taken_notification_your",{by_user:t.byUser.name}),this.$toastConfig.info),Object(h.c)()):(this.userUuid===t.ofUser.uuid?this.$toasted.info($t("meeting.snapshot_taken_notification_your",{by_user:t.byUser.name}),this.$toastConfig.info):this.$toasted.info($t("meeting.snapshot_taken_notification_user",{by_user:t.byUser.name,of_user:t.ofUser.name}),this.$toastConfig.info),Object(h.c)()))},rtcmOnMeetingUpdated:function(e){var t=this,i={};if(e.data&&(i=e.data),this.enableLogs&&console.log("rtcmOnMeetingUpdated",i),i.dateUpdated){var n=function(e){return b.e(e,t.vars.serverDateTimeFormat)};console.log("rtcmOnMeetingUpdated",this.entity),this.updateEntityBackup(i),this.entity.status=i.status,this.entity.startDateTime=n(i.startDateTime),i.plannedStartDateTime&&(this.entity.plannedStartDateTime=n(i.plannedStartDateTime)),i.startedAt&&(this.entity.startedAt=n(i.startedAt)),i.estimatedEndTime&&(this.entity.estimatedEndTime=n(i.estimatedEndTime)),i.endedAt&&(this.entity.endedAt=n(i.endedAt)),console.log("rtcmOnMeetingUpdated",this.entity)}i.endTimeSnoozed&&this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(this.stopAutoEndMeeting(),y.e.close(),this.autoEndingToast=null),i.autoEndCancelled&&this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(this.stopAutoEndMeeting(),this.pageConfigs.autoEndMeeting=!1,y.e.close(),this.autoEndingToast=null)},rtcmOnRemoteHandToggled:function(e){var t=e.hasOwnProperty("data")&&e.data?e.data:e;if(this.enableLogs&&console.log(t),t&&t.streamid&&this.rtcmConnection.streamEvents[t.streamid]){var i=this.videoList.findIndex((function(e){return e.id===t.streamid}));t.hasOwnProperty("isHandUp")&&(t.isHandUp?(this.videoList[i].isHandUp=!0,this.$toasted.info($t("meeting.handup_notification",{attribute:this.videoList[i].name}),this.$toastConfig.info)):this.videoList[i].isHandUp=!1)}},rtcmOnMuteUnmuteRemote:function(e){var t=e.hasOwnProperty("data")&&e.data?e.data:e;this.enableLogs&&console.log(t);var i=this.$refs.videos.find((function(e){return e.id===t.id}));i&&i.srcObject&&this.toggleAudio()},rtcmOnUserIdAlreadyTaken:function(e,t){this.rtcmConnection.userid=t},initMediaAndRtcmConnection:function(){this.rtcmConnection||(this.rtcmConnection=new c.a,this.rtcmConnection.socketURL=window.atob(this.socketURL),this.configs.signalServers&&this.configs.signalServers.url&&(this.rtcmConnection.socketURL=this.configs.signalServers.url),this.rtcmConnection.autoCreateMediaElement=!1,this.configs.meeting&&(this.configs.meeting.debugMode,this.rtcmConnection.enableLogs=!0,this.configs.meeting.forceTurn&&(this.rtcmConnection.candidates={turn:!0,stun:!1,host:!1})),this.rtcmConnection.onopen=this.rtcmOnOpen,this.rtcmConnection.onclose=this.rtcmOnClose,this.rtcmConnection.onleave=this.rtcmOnLeave,this.rtcmConnection.onmessage=this.rtcmOnMessage,this.rtcmConnection.onUserStatusChanged=this.rtcmOnUserStatusChanged,this.rtcmConnection.onstream=this.rtcmOnStream,this.rtcmConnection.onstreamended=this.rtcmOnStreamEnded,this.rtcmConnection.onmute=this.rtcmOnMute,this.rtcmConnection.onunmute=this.rtcmOnUnmute,this.rtcmConnection.onMediaError=this.rtcmOnMediaError,this.rtcmConnection.onerror=this.rtcmOnError,this.rtcmConnection.onUserIdAlreadyTaken=this.rtcmOnUserIdAlreadyTaken,this.pageConfigs.speechDetection&&(this.rtcmConnection.onspeaking=this.rtcmOnSpeaking,this.rtcmConnection.onsilence=this.rtcmOnSilence,this.rtcmConnection.onvolumechange=this.rtcmOnVolumeChange,window.onSilenceTimeoutObj={}),this.rtcmConnection.setCustomSocketEvent("Whisper"),this.fileSharingConnection=this.rtcmConnection),this.getMediaConstraints();this.rtcmConnection.BandwidthHandler;this.rtcmConnection.bandwidth={audio:"auto"!==this.mediaConfigurations.bandwidth.audio&&this.mediaConfigurations.bandwidth.audio,video:"auto"!==this.mediaConfigurations.bandwidth.video&&this.mediaConfigurations.bandwidth.video,screen:"auto"!==this.mediaConfigurations.bandwidth.screen&&this.mediaConfigurations.bandwidth.screen},this.rtcmConnection.iceServers=[{urls:["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302"]}],this.pageConfigs.maxParticipantCount&&(this.rtcmConnection.maxParticipantsAllowed=this.pageConfigs.maxParticipantCount),this.configs.iceServers.length&&(this.rtcmConnection.iceServers=S(this.configs.iceServers)),this.rtcmConnection.session=R({},this.meetingRulesHost.session),this.rtcmConnection.sdpConstraints.mandatory=R({},this.meetingRulesHost.mandatory),this.rtcmConnection.mediaConstraints={video:!!this.meetingRulesHost.mediaConstraints.video&&this.videoConstraints,audio:!!this.meetingRulesHost.mediaConstraints.audio&&this.audioConstraints,screen:this.meetingRulesHost.mediaConstraints.screen}},initSocketListener:function(){if(this.rtcmConnection&&this.rtcmConnection.socket){var e={removedStream:this.streamRemoved,banAttendee:this.banAttendee,muteUnmuteRemote:this.rtcmOnMuteUnmuteRemote,remoteMutedUnmuted:this.rtcmOnRemoteMuteUnmuted,remoteHandToggled:this.rtcmOnRemoteHandToggled,meetingEnded:this.meetingEnded,snapshotTaken:this.rtcmOnSnapshotTaken,meetingUpdated:this.rtcmOnMeetingUpdated};this.rtcmConnection.socket.on("Whisper",(function(t){t&&e.hasOwnProperty(t.event)&&e[t.event](t.data)}))}},initCanvasDesigner:function(){this.canvasDesigner=new CanvasDesigner,this.canvasDesigner.widgetHtmlURL="/js/canvas-designer/widget.html",this.canvasDesigner.widgetJsURL="/js/canvas-designer/widget.min.js"},initWhiteboard:function(){var e=this;this.videoList.length<1||!this.$refs.whiteboard||!CanvasDesigner||(this.canvasDesigner||this.initCanvasDesigner(),this.canvasDesigner.addSyncListener((function(t){e.rtcmConnection.send(t)})),this.canvasDesigner.setSelected("pencil"),this.canvasDesigner.setTools({pencil:!0,text:!0,image:!0,pdf:!0,eraser:!0,line:!0,arrow:!0,dragSingle:!0,dragMultiple:!0,arc:!0,rectangle:!0,quadratic:!0,bezier:!1,marker:!0,zoom:!1,lineWidth:!0,colorsPicker:!0,extraOptions:!0,code:!1,undo:!0}),this.canvasDesigner.iframe||this.canvasDesigner.appendTo(this.$refs.whiteboard,(function(){e.rtcmConnection.extra.hasWhiteboard=!0,e.updateExtraData(),e.canvasDesigner.captureStream((function(t){e.rtcmConnection.addStream(t),e.rtcmConnection.onstream({streamid:t.id,stream:t,userid:e.rtcmConnection.userid,type:"local",extra:e.rtcmConnection.extra})}))})))},updateExtraData:function(){this.rtcmConnection&&this.rtcmConnection.socket&&this.rtcmConnection.updateExtraData()},destroyWhiteboard:function(){var e=this;if(this.canvasDesigner){this.canvasDesigner.destroy(),this.canvasDesigner=null;var t=this.$refs.videos.find((function(t){return t.id===e.localWhiteboardStreamid}));t&&t.srcObject?(this.rtcmConnection&&this.localWhiteboardStreamid&&(this.rtcmConnection.removeStream(this.localWhiteboardStreamid),this.rtcmOnStreamEnded({id:this.localWhiteboardStreamid}),this.videoList.length>1&&this.recheckLiveParticipants({streamid:this.localWhiteboardStreamid}),this.autoSetVideoMaximized()),this.emitSocketEvents("removedStream",t.srcObject),this.localWhiteboardStreamid=null):this.localWhiteboardStreamid=null}this.rtcmConnection.extra.hasWhiteboard=!1,this.updateExtraData()},hideAndDestroyWhiteboard:function(){var e=this;formUtil.confirmAction().then((function(t){t.value?(e.pageConfigs.layout=e.pageConfigs.lastLayout,e.showWhiteboard=!1,e.destroyWhiteboard()):(t.dismiss,y.a.DismissReason.cancel)}))},getMediaConstraints:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needStreamAddOrReplace=!1,t)return this.audioConstraints={sampleSize:16,channelCount:2,echoCancellation:!1},void(this.videoConstraints={width:{min:426,ideal:1280,max:4096},height:{min:240,ideal:720,max:2160}});if(this.pageConfigs.enableAudio?this.mediaConfigurations.selectedAudioInput&&this.mediaConfigurations.selectedAudioInput.uuid&&"auto"!==this.mediaConfigurations.selectedAudioInput.uuid?(this.audioConstraints={deviceId:{ideal:this.mediaConfigurations.selectedAudioInput.uuid}},this.audioConstraints.hasOwnProperty("deviceId")&&this.mediaConfigurations.activeAudioInput!==this.audioConstraints.deviceId.ideal&&(this.needStreamAddOrReplace=!0)):this.audioConstraints=!0:this.audioConstraints=!1,this.pageConfigs.enableVideo){this.mediaConfigurations.selectedVideoInput&&this.mediaConfigurations.selectedVideoInput.uuid&&"auto"!==this.mediaConfigurations.selectedVideoInput.uuid?(this.videoConstraints={deviceId:{ideal:this.mediaConfigurations.selectedVideoInput.uuid}},this.videoConstraints.hasOwnProperty("deviceId")&&this.mediaConfigurations.activeVideoInput!==this.videoConstraints.deviceId.ideal&&(this.needStreamAddOrReplace=!0)):delete this.videoConstraints.deviceId,"auto"!==this.mediaConfigurations.facingMode?(this.videoConstraints.facingMode=this.mediaConfigurations.facingMode,this.mediaConfigurations.activeFacingMode!==this.videoConstraints.facingMode&&(this.needStreamAddOrReplace=!0)):this.videoConstraints.hasOwnProperty("facingMode")&&(this.mediaConfigurations.activeFacingMode!==this.videoConstraints.facingMode&&(this.needStreamAddOrReplace=!0),delete this.videoConstraints.facingMode),"auto"!==this.mediaConfigurations.frameRate?this.videoConstraints.frameRate=this.mediaConfigurations.frameRate:this.videoConstraints.hasOwnProperty("frameRate")&&delete this.videoConstraints.frameRate;var i=this.mediaDevices.resolutions.find((function(t){return t.label===e.mediaConfigurations.selectedResolution}));i&&"Auto"!==i.label?(this.videoConstraints.width=i.constraints.width,this.videoConstraints.height=i.constraints.height):(this.videoConstraints.hasOwnProperty("width")&&delete this.videoConstraints.width,this.videoConstraints.hasOwnProperty("height")&&delete this.videoConstraints.height)}else this.videoConstraints=!1},applyMediaConstraints:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.rtcmConnection&&this.localVideo&&(this.getMediaConstraints(e),this.rtcmConnection.mediaConstraints={video:!!this.meetingRulesHost.mediaConstraints.video&&this.videoConstraints,audio:!!this.meetingRulesHost.mediaConstraints.audio&&this.audioConstraints,screen:this.meetingRulesHost.mediaConstraints.screen},this.rtcmConnection.bandwidth={audio:"auto"!==this.mediaConfigurations.bandwidth.audio&&this.mediaConfigurations.bandwidth.audio,video:"auto"!==this.mediaConfigurations.bandwidth.video&&this.mediaConfigurations.bandwidth.video,screen:"auto"!==this.mediaConfigurations.bandwidth.screen&&this.mediaConfigurations.bandwidth.screen},this.mediaConfigurations.activeAudioInput=this.audioConstraints&&this.audioConstraints.hasOwnProperty("deviceId")?this.audioConstraints.deviceId.ideal:null,this.mediaConfigurations.activeVideoInput=this.videoConstraints&&this.videoConstraints.hasOwnProperty("deviceId")?this.videoConstraints.deviceId.ideal:null,this.mediaConfigurations.activeFacingMode=this.mediaConfigurations.facingMode,this.needStreamAddOrReplace?this.closeConnectionAndStream(!0):this.rtcmConnection.applyConstraints(this.rtcmConnection.mediaConstraints))},closeConnectionAndStream:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1?arguments[1]:void 0;if(this.stopAutoEndMeeting(),this.autoEndingToast&&_.isEmpty(this.autoEndingToast)&&(y.e.close(),this.autoEndingToast=null),this.rtcmConnection)try{if(this.destroyWhiteboard(),this.rtcmConnection.attachStreams.forEach((function(e){e.stop()})),this.$refs.greenRoomVideo&&this.$refs.greenRoomVideo.srcObject){var n=this.$refs.greenRoomVideo.srcObject;n.stop(),this.localGreenRoomStream=null}else if(this.localGreenRoomStream){var r=this.localGreenRoomStream;r.stop(),this.localGreenRoomStream=null}this.localVideo&&this.emitSocketEvents("removedStream",this.localVideo),this.rtcmConnection.getAllParticipants().forEach((function(t){e.rtcmConnection.disconnectWith(t)})),this.rtcmConnection.leave(),this.rtcmConnection.closeSocket(),window.setTimeout((function(){e.localVideo=null,e.localScreenStreamid=null,e.localWhiteboardStreamid=null,e.localGreenRoomStream=null,e.rtcmConnection&&(e.rtcmConnection.recorder=null),e.rtcmConnection=null,t&&e.getOnline(),i&&_.isFunction(i)&&i()}),500),this.stopKeepAlivePolling(),this.stopAutoEndMeeting()}catch(e){}this.videoList=[]},initHark:function(e){if(window.hark&&this.pageConfigs.speechDetection){var t=e.streamedObject,i=e.stream,n=e.connection,r=l()(i,{});r.on("speaking",(function(){n.onspeaking(t)})),r.on("stopped_speaking",(function(){n.onsilence(t)})),window.harkInitiated=!0}},recheckLiveParticipants:function(e){var t=this,i=[],n=this.rtcmConnection?this.rtcmConnection.getAllParticipants():[];this.videoList.forEach((function(t,r){var o=n.findIndex((function(e){return e===t.streamUserId}));(!e||e&&t.id!==e.streamid)&&(t.local||!t.local&&-1!==o)||(t.status=!1),i.push(t)})),this.videoList=i,setTimeout((function(){t.videoList=t.videoList.filter((function(e){return e.status})),t.autoSetVideoMaximized()}),3e3)},autoSetVideoMaximized:function(){var e=this,t=function(t){e.videoList[t].maximized=!0,e.videoList=e.videoList.map((function(e,i){return e.maximized=!1,i===t&&(e.maximized=!0),e}))};if(this.videoList.length>1)if(-1===this.videoList.findIndex((function(e){return!e.local&&e.maximized&&e.status}))){var i=this.videoList.findIndex((function(e){return!e.local&&e.hasStream}));t(-1!==i?i:0)}else{var n=this.videoList.findIndex((function(e){return!e.local&&e.whiteboard&&e.status}));-1!==n&&this.videoList[n].whiteboard&&t(n)}else this.videoList.length&&t(0)},validateMediaDeviceRequest:function(e){var t={video:!!e.video,audio:!!e.audio,screen:!!e.screen};return this.pageConfigs.allowJoiningWithoutDevices&&(!t.audio||this.mediaDevices.audioInput&&this.mediaDevices.audioInput.length||(t.audio=!1),!t.video||this.mediaDevices.videoInput&&this.mediaDevices.videoInput.length||(t.video=!1)),t},joinRoom:function(e){var t=this;this.rtcmConnection.session=R({},this.meetingRulesGuest.session),this.videoList=[],this.getMediaConstraints();var i=this.entity.canModerate?this.meetingRulesHost:this.meetingRulesGuest,n=this.validateMediaDeviceRequest(i.mediaConstraints);this.rtcmConnection.mediaConstraints={video:!!n.video&&this.videoConstraints,audio:!!n.audio&&this.audioConstraints,screen:n.screen},!this.pageConfigs.allowJoiningWithoutDevices||n.audio||n.video||n.screen||(this.rtcmConnection.dontCaptureUserMedia=!0),this.rtcmConnection.sdpConstraints.mandatory=R({},i.mandatory),this.rtcmConnection.autoCloseEntireSession=i.autoCloseEntireSession,this.rtcmConnection.enableScalableBroadcast=i.enableScalableBroadcast,this.rtcmConnection.enableScalableBroadcast&&(this.rtcmConnection.maxRelayLimitPerUser=i.maxRelayLimitPerUser),this.rtcmConnection.extra.isInitiator=this.entity.canModerate,this.rtcmConnection.join(e,(function(e,i,n){t.isLoading=!1,!1===e||n?(t.closeConnectionAndStream(),"Room full"===n?t.$toasted.error($t("meeting.room_full"),t.$toastConfig.error):t.$toasted.error($t("meeting.unable_to_join"),t.$toastConfig.error)):(t.meetingRoomNotFound=!1,t.updatePageConfigs(t.entity.canModerate),t.initSocketListener(),t.$toasted.success($t("meeting.meeting_joined"),t.$toastConfig))}))},applyOnStartConfigs:function(){var e=this;!this.rtcmConnection.extra.isInitiator&&this.pageConfigs.muteParticipantsOnStart&&window.setTimeout((function(){e.toggleAudio(null,!0)}),1e3)},shareScreen:function(){var e=this;try{this.rtcmConnection.addStream({screen:!0,streamCallback:function(t){e.rtcmConnection.extra.screenStreamId=t.id,e.updateExtraData()}})}catch(e){}},stopSharingScreen:function(){var e=this;this.isLoading=!0,this.rtcmConnection.extra.screenStreamId=null,this.updateExtraData();var t=this.$refs.videos.find((function(t){return t.id===e.localScreenStreamid}));t&&t.srcObject?(t.srcObject.getTracks().forEach((function(t){t.removeEventListener("ended",e.stopSharingScreen),t.enabled=!1,t.stop()})),this.rtcmConnection.removeStream(this.localScreenStreamid),this.emitSocketEvents("removedStream",t.srcObject),this.localScreenStreamid=null,this.isLoading=!1):(this.localScreenStreamid=null,this.isLoading=!1)},getOnline:function(){var e=this;this.isLoading=!0,this.showAgenda=!1;this.entity.status;this.$gaEvent("engagement","meeting_getOnline"),this.initMediaAndRtcmConnection(),this.Custom({url:"/".concat(this.initUrl,"/").concat(this.uuid,"/join"),method:"post"}).then((function(t){e.meetingRoomId=t.meeting.roomId,t.meeting=e.updateMeetingTimezone(t.meeting),e.entity=t.meeting,e.rtcmConnection.extra={username:e.user.username,name:e.user.name,uuid:e.user.uuid,avatar:e.profile.avatar,cover:e.profile.cover,audioMuted:!e.pageConfigs.enableAudio,videoMuted:!e.pageConfigs.enableVideo,isHandUp:e.isHandUp,isInitiator:!1},e.enableLogs&&(console.log("rtcmConnection",e.rtcmConnection),console.log("mediaConfigurations",e.mediaConfigurations),console.log("mediaDevices",e.mediaDevices),console.log("pageConfigs",e.pageConfigs),console.log("videoConstraints",e.videoConstraints),console.log("audioConstraints",e.audioConstraints),console.log("meetingRulesHost",e.meetingRulesHost),console.log("meetingRulesGuest",e.meetingRulesGuest),console.log("rtcmConnection-ExtraData",e.rtcmConnection.extra)),e.rtcmConnection.checkPresence(e.meetingRoomId,(function(t,i){!0===t?(e.meetingRoomNotFound=!1,e.joinRoom(e.meetingRoomId)):(e.isLoading=!1,e.meetingRoomNotFound=!0,e.$toasted.error($t("meeting.room_not_found"),e.$toastConfig.error)),e.startMeetingTimer()}))})).catch((function(t){e.isLoading=!1,formUtil.handleErrors(t)}))},getOffline:function(){var e=this;this.$gaEvent("engagement","meeting_getOffline");this.isLoading=!0,this.meetingAction("leave",null,{alert:"confirm",sameCallbackIfError:!0,callback:function(t){e.showAgenda=!0,e.showWhiteboard=!1,"presentation"===e.pageConfigs.layout&&(e.pageConfigs.layout=e.pageConfigs.lastLayout),e.closeConnectionAndStream(!1,(function(){e.stopMeetingTimer(),e.setupGreenRoom(),e.initMediaAndRtcmConnection()}))}})},meetingAction:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{alert:"confirm"},r={alert:"confirm"};n=Object.assign({},r,n);var o=function(r){t.isLoading=!0,i=r||i,t.Custom({url:"/".concat(t.initUrl,"/").concat(t.uuid,"/").concat(e),method:"post",data:i}).then((function(e){e.meeting=t.updateMeetingTimezone(e.meeting),t.entity=e.meeting,t.$toasted.success(e.message,t.$toastConfig),n.callback&&n.callback(e),t.isLoading=!1})).catch((function(e){n.callback&&n.sameCallbackIfError&&n.callback(e),t.isLoading=!1,formUtil.handleErrors(e)}))};e?"confirm"===n.alert||!0===n.alert?formUtil.confirmAction().then((function(e){e.value?o():(t.isLoading=!1,e.dismiss,y.a.DismissReason.cancel)})):"input"===n.alert?swtAlert.fire({title:n.title,input:"text",inputPlaceholder:n.inputPlaceholder,showCancelButton:!0,confirmButtonText:"Proceed!",cancelButtonText:"Go Back!"}).then((function(e){if(e.value){var i={};i[n.fieldName]=e.value,o(i)}else t.isLoading=!1,e.dismiss,y.a.DismissReason.cancel})):o():this.isLoading=!1},updateMeetingRules:function(){"video_conference"===this.entity.type.uuid?(this.meetingRulesHost={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!0,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},autoCloseEntireSession:!1,enableScalableBroadcast:!1},this.meetingRulesGuest={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!0,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},autoCloseEntireSession:!1,enableScalableBroadcast:!1}):"audio_conference"===this.entity.type.uuid?(this.meetingRulesHost={session:{audio:!0,video:!1,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1},autoCloseEntireSession:!1,enableScalableBroadcast:!1},this.meetingRulesGuest={session:{audio:!0,video:!1,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1},autoCloseEntireSession:!1,enableScalableBroadcast:!1}):"webinar"===this.entity.type.uuid?(this.meetingRulesHost={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!0},mediaConstraints:{audio:!0,video:!0,screen:!1},mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},autoCloseEntireSession:!0,enableScalableBroadcast:!0,maxRelayLimitPerUser:1},this.meetingRulesGuest={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!0},mediaConstraints:{audio:!1,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},autoCloseEntireSession:!0,enableScalableBroadcast:!0,maxRelayLimitPerUser:1}):"live_class"===this.entity.type.uuid?(this.meetingRulesHost={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!0,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},autoCloseEntireSession:!0,enableScalableBroadcast:!1},this.meetingRulesGuest={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!0,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},autoCloseEntireSession:!0,enableScalableBroadcast:!1}):"podcast"===this.entity.type.uuid&&(this.meetingRulesHost={session:{audio:!0,video:!1,screen:!1,data:!1,oneway:!0},mediaConstraints:{audio:!0,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},autoCloseEntireSession:!0,enableScalableBroadcast:!0,maxRelayLimitPerUser:1},this.meetingRulesGuest={session:{audio:!0,video:!1,screen:!1,data:!1,oneway:!0},mediaConstraints:{audio:!1,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1},autoCloseEntireSession:!0,enableScalableBroadcast:!0,maxRelayLimitPerUser:1})},updateMeetingTimezone:function(e){var t=this,i=function(e){return b.e(e,t.vars.serverDateTimeFormat)};return this.updateEntityBackup(e),e.startDateTime=i(e.startDateTime),e.plannedStartDateTime&&(e.plannedStartDateTime=i(e.plannedStartDateTime)),e.startedAt&&(e.startedAt=i(e.startedAt)),e.estimatedEndTime&&(e.estimatedEndTime=i(e.estimatedEndTime)),e},beforeUnload:function(e){this.localVideo&&this.emitSocketEvents("removedStream",this.localVideo)},logEvent:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"log";this.enableLogs&&("log"===i?console.log(e,t):"error"===i?console.error(e,t):"debug"===i&&console.trace(e,t))},toggleDevicesModal:function(){this.mediaConfigFormData=_.cloneDeep(this.mediaConfigurations),this.showDevicesModal=!0},onDevicesModalOK:function(e){var t=this;e.preventDefault(),Object(g.areEqual)(this.mediaConfigFormData,this.mediaConfigurations)||(this.mediaConfigurations=_.cloneDeep(this.mediaConfigFormData),this.applyMediaConstraints()),this.$nextTick((function(){t.$bvModal.hide("devicesModal")}))},onDevicesModalCancel:function(e){var t=this;e.preventDefault(),this.$nextTick((function(){t.$bvModal.hide("devicesModal")}))},updatePageConfigs:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.configs.meeting.recordingFormatAudio?this.configs.meeting.recordingFormatAudio:"audio/webm",n=this.configs.meeting.recordingFormatVideo?this.configs.meeting.recordingFormatVideo:"video/webm",r={},o=this.mediaConfigurations.recording.type,a=this.mediaConfigurations.recording.mimeType;"video_conference"===this.entity.type.uuid?(r={enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!0,showEnableVideoBtn:!0,enableWhiteboard:!0},o="video",a=n):"audio_conference"===this.entity.type.uuid?(r={enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!0,showEnableVideoBtn:!1,enableScreenSharing:!1,enableWhiteboard:!1},o="audio",a=i):"webinar"===this.entity.type.uuid?(r=t?{enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!0,showEnableVideoBtn:!0,enableHandGesture:!1,enableWhiteboard:!0}:{enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!1,showEnableVideoBtn:!1,enableScreenSharing:!1,enableFileSharing:!1,enableRecording:!1,enableHandGesture:!1,enableWhiteboard:!1},o="video",a=n):"live_class"===this.entity.type.uuid?(r=t?{enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!0,showEnableVideoBtn:!0,enableWhiteboard:!0}:{enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!1,showEnableVideoBtn:!1,enableScreenSharing:!1,enableFileSharing:!1,enableRecording:!1,enableWhiteboard:!1},o="video",a=n):"podcast"===this.entity.type.uuid&&(r=t?{enableAudio:!0,enableVideo:!1,showEnableAudioBtn:!0,showEnableVideoBtn:!1,enableScreenSharing:!1,enableHandGesture:!1,enableWhiteboard:!1}:{enableAudio:!0,enableVideo:!1,showEnableAudioBtn:!1,showEnableVideoBtn:!1,enableScreenSharing:!1,enableFileSharing:!1,enableRecording:!1,enableHandGesture:!1,enableWhiteboard:!1},o="audio",a=i),r.objForEach((function(t,i){return e.pageConfigs[i]=t})),this.mediaConfigurations.recording.type=o,this.mediaConfigurations.recording.mimeType=a,this.mediaConfigurations.recording.timeSlice=this.pageConfigs.recordingTimeSlice||5e3,this.rtcmConnection.extra.audioMuted=!this.pageConfigs.enableAudio,this.rtcmConnection.extra.videoMuted=!this.pageConfigs.enableVideo,this.rtcmConnection.extra.isHandUp=this.isHandUp,this.updateExtraData(),this.pageConfigs.enableWhiteboard&&(Object(f.g)("/js/canvas-designer/webrtc-handler.js"),Object(f.g)("/js/canvas-designer/canvas-designer-widget.js")),this.configs.meeting.debugMode=!0},destroyPage:function(){window.countdownInterval&&clearInterval(window.countdownInterval),this.SetUiConfig({pageHeaderShow:!0,pageFooterShow:!0}),this.closeConnectionAndStream(),window.Echo&&(window.meetingChannel&&(window.meetingChannel.stopListening("MeetingStatusChanged"),window.meetingChannel.stopListening("NewMessage")),window.Echo.leave("Meeting.".concat(this.uuid))),m.a.isEnabled&&(m.a.off("change"),m.a.off("error"))},getInitialData:function(){var e=this;return this.isLoading=!0,window.Echo?this.Custom({url:"/".concat(this.initUrl,"/").concat(this.uuid,"/pam"),method:"get",params:{isPam:!0}}).then((function(t){return t.isInstantMeeting&&(e.pageConfigs.hasAgenda=!1),t.config.objForEach((function(t,i){return e.pageConfigs[i]=t})),e.pageConfigs.disableScroll="grid"===e.pageConfigs.layout||(t.config&&t.config.hasOwnProperty("disableScroll")?t.config.disableScroll:e.pageConfigs.disableScroll),t=e.updateMeetingTimezone(t),e.entity=t,e.updateMeetingRules(),e.pageConfigs.preferRearCameraFirst&&(e.mediaConfigurations.facingMode="environment"),t.roomId&&"live"===t.status&&setTimeout((function(){e.initMediaAndRtcmConnection(),e.rtcmConnection.checkPresence(t.roomId,(function(t,i){e.roomIdAlive=!!t,!0===t&&(e.meetingRoomNotFound=!1)}))}),1e3),e.joinChannel(),e.setupGreenRoom(),t.isInstantMeeting&&!t.isBlocked&&"live"===t.status&&(e.rtcmConnection&&e.rtcmConnection.isInitiator||t.canModerate||"live_class"!==t.type.uuid&&"webinar"!==t.type.uuid)?e.pageConfigs.forceUpdateUsername?e.updateUsername(!1,e.getOnline):e.getOnline():e.isLoading=!1,t})).catch((function(t){return e.isLoading=!1,formUtil.handleErrors(t),e.$router.push({name:e.fallBackRoute}),t})):(this.$toasted.error($t("config.pusher.credential_required"),this.$toastConfig.error),void this.$router.push({name:this.fallBackRoute}))}},E(n,"stopStream",(function(e){e&&_.isFunction(e.stop)&&e.stop(),e&&_.isFunction(e.getTracks)&&e.getTracks().forEach((function(e){return e.stop()}))})),E(n,"toggleVideoTracks",(function(e,t){e&&e.getVideoTracks().forEach((function(e){e.enabled=t}))})),E(n,"toggleAudioTracks",(function(e,t){e&&e.getAudioTracks().forEach((function(e){e.enabled=t}))})),E(n,"setupGreenRoom",(function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=function(t){if(e.$refs.greenRoomAudio&&e.pageConfigs.enableAudio){var i=new AudioContext,n=i.createAnalyser(),r=i.createMediaStreamSource(t),o=i.createScriptProcessor(2048,1,1);n.smoothingTimeConstant=.8,n.fftSize=1024,r.connect(n),n.connect(o),o.connect(i.destination),Object(C.a)(e.$refs.greenRoomAudio,{width:"sibling",boxGapFraction:.2}),o.onaudioprocess=function(){var t=new Uint8Array(n.frequencyBinCount);n.getByteFrequencyData(t);for(var i=0,r=t.length,o=0;o<r;o++)i+=t[o];var a=i/r,s=Math.round(a);e.micVolumeActivity=s<0?0:s}}};if(this.$refs.videos&&this.$refs.videos.length)return this.localGreenRoomStream&&this.stopStream(this.localGreenRoomStream),void(this.localGreenRoomStream=null);!this.pageConfigs.enableVideo||!this.pageConfigs.enableAudio||this.$refs.greenRoomVideo&&this.$refs.greenRoomVideo.srcObject||(t=!0),!this.localGreenRoomStream||t?(this.localGreenRoomStream&&this.stopStream(this.localGreenRoomStream),this.localGreenRoomStream=null,this.getMediaConstraints(),(this.videoConstraints&&this.mediaConfigurations.selectedVideoInput||this.audioConstraints&&this.mediaConfigurations.selectedAudioInput)&&navigator.mediaDevices.getUserMedia({video:this.videoConstraints,audio:this.audioConstraints||!0}).then((function(t){e.toggleVideoTracks(t,e.pageConfigs.enableVideo),e.toggleAudioTracks(t,e.pageConfigs.enableAudio),e.localGreenRoomStream=t,e.$refs.greenRoomVideo&&e.pageConfigs.enableVideo&&(e.$refs.greenRoomVideo.srcObject=t),setTimeout((function(){i(e.localGreenRoomStream)}),1e3)})).catch(this.rtcmOnMediaError)):this.pageConfigs.enableVideo||this.pageConfigs.enableAudio?(this.toggleVideoTracks(this.localGreenRoomStream,this.pageConfigs.enableVideo),this.toggleAudioTracks(this.localGreenRoomStream,this.pageConfigs.enableAudio),!this.pageConfigs.enableVideo&&this.$refs.greenRoomVideo&&(this.$refs.greenRoomVideo.srcObject=null),i(this.localGreenRoomStream)):(this.localGreenRoomStream&&this.stopStream(this.localGreenRoomStream),this.localGreenRoomStream=null,this.$refs.greenRoomVideo.srcObject=null)})),E(n,"setupMediaDevices",(function(){var e=this,t=new c.a;!1===t.DetectRTC.isWebRTCSupported&&this.$toasted.error($t("meeting.invalid_browser_error"),this.$toastConfig.error),this.isLoading=!0,this.mediaDeviceIssue=this.permissionRejected=!1;var i=function(i){t.DetectRTC.load((function(){e.enableLogs&&console.log(t.DetectRTC),!0===t.DetectRTC.hasMicrophone?e.mediaDevices.audioInput=t.DetectRTC.audioInputDevices.map((function(t){return{uuid:t.deviceId||t.id,name:t.label||"microphone ".concat(e.mediaDevices.audioInput.length+1)}})):e.mediaDeviceIssue=!0,!0===t.DetectRTC.hasWebcam?e.mediaDevices.videoInput=t.DetectRTC.videoInputDevices.map((function(t){return{uuid:t.deviceId||t.id,name:t.label||"camera ".concat(e.mediaDevices.videoInput.length+1)}})):e.mediaDeviceIssue=!0,!0===t.DetectRTC.hasSpeakers?e.mediaDevices.audioOutput=t.DetectRTC.audioOutputDevices.map((function(t){return{uuid:t.deviceId||t.id,name:t.label||"speaker ".concat(e.mediaDevices.audioOutput.length+1)}})):e.$toasted.error($t("meeting.audio_output_device_error"),e.$toastConfig.error),e.mediaConfigurations.selectedAudioInput=e.mediaDevices.audioInput?e.mediaDevices.audioInput[0]:null,e.mediaConfigurations.selectedVideoInput=e.mediaDevices.videoInput?e.mediaDevices.videoInput[0]:null,e.mediaConfigFormData=_.cloneDeep(e.mediaConfigurations),i&&i(),e.getInitialData()}))};!t.DetectRTC.MediaDevices.length||t.DetectRTC.MediaDevices[0]&&t.DetectRTC.MediaDevices[0].isCustomLabel?navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((function(e){i((function(){e.getTracks().forEach((function(e){e.stop()}))}))})).catch((function(t){e.rtcmOnMediaError(t),e.getInitialData()})):i()})),E(n,"doInit",(function(){this.Init({url:this.initUrl}),window.isDuplicate()&&(this.duplicateTab=!0),this.setupMediaDevices()})),E(n,"initNetworkListener",(function(){var e=this;window.addEventListener("offline",(function(t){e.rtcmConnection&&e.videoList&&e.videoList.length&&(e.videoList=e.videoList.slice(0,1),e.autoSetVideoMaximized())})),window.addEventListener("online",(function(t){e.closeConnectionAndStream(!0)}))})),E(n,"updateUsername",(function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=arguments.length>1?arguments[1]:void 0;swtAlert.fire({title:$t("misc.ask_name.title"),showCancelButton:t,confirmButtonText:$t("misc.ask_name.confirm_btn"),cancelButtonText:$t("misc.ask_name.cancel_btn_2"),input:"text"}).then((function(t){if(t.value){var n=Object(f.e)("guestUserData",!0)||{};(n=R(R({},e.profile),n)).username=Object(g.toSnakeCase)(t.value),n.name=t.value,e.profile=R({},n),Object(f.j)("guestUserData",n),e.rtcmConnection.extra.username=e.profile.username,e.rtcmConnection.extra.name=e.profile.name,e.updateExtraData(),i&&_.isFunction(i)&&i()}else t.dismiss,y.a.DismissReason.cancel}))})),E(n,"setDefaultGuestUserData",(function(){var e=Object(f.e)("guestUserData",!0);if(!e||!e.uuid){var t=uuid().substring(0,8);e={uuid:uuid(),username:t,name:t}}this.profile=R({},e),Object(f.j)("guestUserData",e)})),n)),mounted:function(){var e=this;document.body.classList.add("meeting-page"),this.$route.params.uuid&&(this.uuid=this.$route.params.uuid),m.a.isEnabled&&(m.a.on("change",(function(){e.SetUiConfig({fullScreen:m.a.isFullscreen})})),m.a.on("error",(function(e){console.error("Failed to enable fullscreen",e)})),this.SetUiConfig({fullScreen:!1})),this.GetConfig({params:{pam:!0,meeting:this.uuid}}).then((function(t){t&&t.pusher&&t.signalServers&&t.iceServers?(e.isLoading=!1,window.Echo||Object(p.a)(),e.doInit()):(e.$toasted.error($t("meeting.pam_meeting_error"),e.$toastConfig.error),e.$router.push({name:"login",query:{ref:e.$route.fullPath}}))})).catch((function(t){e.isLoading=!1,formUtil.handleErrors(t)})),window.addEventListener("beforeunload",this.beforeUnload),this.checkIfOffline(),this.initNetworkListener()},created:function(){this.mediaConfigFormData=_.cloneDeep(this.mediaConfigurations),this.SetUiConfig({pageHeaderShow:!1,pageFooterShow:!1}),this.setDefaultGuestUserData(),navigator.connection&&"cellular"===navigator.connection.type&&navigator.connection.downlinkMax<=.115&&alert("2G is not supported. Please use a better internet service.")},beforeRouteEnter:function(e,t,i){e.params.uuid?i((function(e){e.prevRoute=t})):i({name:"joinMeetingAsGuest"})},beforeDestroy:function(){window.isMeetingPageDestroyed||(this.isLoading=!0,this.destroyPage(),this.entity&&"live"===this.entity.status&&this.Custom({url:"/".concat(this.initUrl,"/").concat(this.uuid,"/leave"),method:"post"}),window.isMeetingPageDestroyed=!0)},beforeRouteLeave:function(e,t,i){var n=this,r=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(n.isLoading=!0,n.destroyPage(),window.removeEventListener("beforeunload",n.beforeUnload),n.entity&&"live"===n.entity.status?n.Custom({url:"/".concat(n.initUrl,"/").concat(n.uuid,"/leave"),method:"post"}).then((function(e){window.isMeetingPageDestroyed=!0,i()})).catch((function(e){window.isMeetingPageDestroyed=!0,i()})):(window.isMeetingPageDestroyed=!0,i()))};this.hasVideos?formUtil.unsavedCheckAlert({},{unsaved:!0},r,{title:$t("meeting.is_live")}):r()},destroyed:function(){document.body.classList.remove("meeting-page")}};i("i8R7"),i("BcCH");function D(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function x(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?D(Object(i),!0).forEach((function(t){O(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):D(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function O(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var M={data:function(){return{subscriptions:{},isWindowFocused:!0,socketURL:"aHR0cHM6Ly9zaWduYWwua29kZW1pbnQuaW46OTAwMS8="}},computed:x({},Object(r.c)("config",["configs","uiConfigs","vars"])),methods:x(x({},Object(r.b)("common",["Custom"])),{},{leaveBeforeUnload:function(){},windowBlurred:function(){this.isWindowFocused=!1},windowFocused:function(){this.isWindowFocused=!0},updateNotificationSubscription:function(e){var t=e.getKey("p256dh"),i=e.getKey("auth"),n=(PushManager.supportedContentEncodings||["aesgcm"])[0],r={endpoint:e.endpoint,publicKey:t?btoa(String.fromCharCode.apply(null,new Uint8Array(t))):null,authToken:i?btoa(String.fromCharCode.apply(null,new Uint8Array(i))):null,contentEncoding:n};this.Custom({url:"users/subscriptions",method:"post",data:r}).then((function(e){}))},socketSetup:function(){this.socketURLB=window.atob(this.socketURL);try{var e=a()(this.socketURLB);e.on("connect",(function(){e.emit("socketAuth",{token:201005})})),e.on("socketAuthError",(function(){Object(v.a)(!0)})),window.setTimeout((function(){e&&e.disconnect()}),5e3)}catch(e){console.log(e)}}}),mounted:function(){var e=this;window.Echo||Object(p.a)(),this.configs&&this.configs.disableSocketVerification||window.setTimeout((function(){e.socketSetup()}),1e3)},created:function(){window.addEventListener("beforeunload",this.leaveBeforeUnload),window.addEventListener("blur",this.windowBlurred),window.addEventListener("focus",this.windowFocused)},beforeDestroy:function(){},destroyed:function(){window.removeEventListener("beforeunload",this.leaveBeforeUnload),window.removeEventListener("blur",this.windowBlurred),window.removeEventListener("focus",this.windowFocused)}},I=i("bdEB"),L=i("adPT"),A=i("K2Rr"),j=i.n(A),$={mixins:[M,P],components:{AppLogo:I.a,AnimatedNumber:L.a,FlipCountdown:j.a},watch:{locked:function(e,t){if(e){var i=this.$route.fullPath;this.$router.push({name:"authLock",query:{ref:i}})}}},methods:{},mounted:function(){}},U=i("KHd+"),F=Object(U.a)($,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("base-container",{class:["meeting-page",{"auto-hide-footer":e.pageConfigs.footerAutoHide&&e.hasVideos},{pulse:e.recording},{"mirrored-video":e.configs.meeting&&e.configs.meeting.mirroredVideo}],attrs:{"with-loader":"","is-loading":e.isLoading,"loader-color":e.vars.loaderColor,"overlay-color":e.uiConfigs.pageColorSchemeType,"loader-size":"screen","data-page-background-color":e.uiConfigs.pageBackgroundColor,"data-card-background-color":e.uiConfigs.pageContainerBackgroundColor}},[e.duplicateTab?i("card",{staticClass:"duplicate-tab d-flex justify-content-center align-items-center min-height-90vh",attrs:{shadow:""}},[i("h2",[e._v(e._s(e.$t("meeting.duplicate_tab")))])]):[i("div",{class:["meeting-footer",{"has-videos":e.hasVideos}],attrs:{"data-footer-background-color":e.uiConfigs.leftSidebarColor}},[i("div",{staticClass:"logo-wrapper"},[i("app-logo",{attrs:{place:"sidebar",size:"sm",tag:"span"}})],1),e._v(" "),e.entity&&e.entity.status?i("div",{staticClass:"meeting-actions meeting-actions-center"},[e.pageConfigs.showEnableAudioBtn?[e.pageConfigs.enableAudio?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action",attrs:{type:"button",title:e.$t("meeting.mute_audio")},on:{click:e.toggleAudio}},[i("i",{staticClass:"fas fa-microphone"})]):i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action disabled-text",attrs:{type:"button",title:e.$t("meeting.unmute_audio")},on:{click:e.toggleAudio}},[i("i",{staticClass:"fas fa-microphone-slash"})])]:e._e(),e._v(" "),e.pageConfigs.showEnableVideoBtn?[e.pageConfigs.enableVideo?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action",attrs:{type:"button",title:e.$t("meeting.mute_video")},on:{click:e.toggleVideo}},[i("i",{staticClass:"fas fa-video"})]):i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action disabled-text",attrs:{type:"button",title:e.$t("meeting.unmute_video")},on:{click:e.toggleVideo}},[i("i",{staticClass:"fas fa-video-slash"})])]:e._e(),e._v(" "),e.pageConfigs.showDeviceConfig?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action d-sm-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.media_devices.setup")},on:{click:e.toggleDevicesModal}},[i("i",{staticClass:"fas fa-cogs"})]):e._e(),e._v(" "),e.videoList.length?[i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text",attrs:{type:"button",title:e.$t("meeting.leave_meeting")},on:{click:e.getOffline}},[i("i",{staticClass:"fas fa-phone-slash"})]),e._v(" "),e.pageConfigs.enableScreenSharing&&e.pageConfigs.pamEnableScreenSharingForGuest?[e.localScreenStreamid?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action disabled-text d-none d-lg-inline-block",attrs:{type:"button",title:e.$t("meeting.stop_sharing_screen")},on:{click:e.stopSharingScreen}},[i("i",{staticClass:"fas fa-minus-square"})]):i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action d-none d-lg-inline-block",attrs:{type:"button",title:e.$t("meeting.share_screen")},on:{click:e.shareScreen}},[i("i",{staticClass:"fas fa-desktop"})])]:e._e(),e._v(" "),e.pageConfigs.enableWhiteboard&&e.pageConfigs.pamEnableWhiteboardForGuest?[e.showWhiteboard?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.hide_whiteboard")},on:{click:e.toggleWhiteboard}},[i("i",{staticClass:"fas fa-chalkboard-teacher"})]):e._e(),e._v(" "),e.showWhiteboard?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.clear_hide_whiteboard")},on:{click:e.hideAndDestroyWhiteboard}},[i("i",{staticClass:"fas fa-chalkboard-teacher mr-0"}),i("i",{staticClass:"fas fa-times font-size-xs ml-1 font-size-xs text-danger"})]):i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.show_whiteboard")},on:{click:e.toggleWhiteboard}},[i("i",{staticClass:"fas fa-chalkboard-teacher"})])]:e._e(),e._v(" "),e.pageConfigs.enableHandGesture?[e.isHandUp?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action success-text",attrs:{type:"button",title:e.$t("meeting.lower_hand")},on:{click:e.toggleHandUp}},[i("i",{staticClass:"far fa-hand-paper"})]):i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action",attrs:{type:"button",title:e.$t("meeting.raise_hand")},on:{click:e.toggleHandUp}},[i("i",{staticClass:"fas fa-hand-paper"})])]:e._e()]:e._e()],2):e._e(),e._v(" "),i("div",{staticClass:"meeting-actions meeting-actions-right"},[e.entity?[!e.entity.status||!e.videoList.length||e.pageConfigs.enableWhiteboard&&e.showWhiteboard?e._e():i("base-dropdown",{staticClass:"more-actions d-none d-md-inline-block",attrs:{tag:"div",direction:"up","menu-classes":"show-dropdown-up",position:"right"}},[i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action grid-toggle-btn d-none d-md-inline-block",attrs:{slot:"title",type:"button",title:e.$t("meeting.change_layout")},slot:"title"},[i("i",{staticClass:"fas fa-th-large"})]),e._v(" "),i("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("grid")}}},[e._v(e._s(e.$t("meeting.grid_layout"))+" "),i("i",{staticClass:"fas fa-check min-width-auto text-light",class:{"text-dark":"grid"===e.pageConfigs.layout}})]),e._v(" "),i("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("gallery")}}},[e._v(e._s(e.$t("meeting.gallery_layout"))+" "),i("i",{staticClass:"fas fa-check min-width-auto text-light",class:{"text-dark":"gallery"===e.pageConfigs.layout}})]),e._v(" "),e.pageConfigs.hasAgenda||e.pageConfigs.enableWhiteboard&&e.showWhiteboard?i("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("presentation")}}},[e._v(e._s(e.$t("meeting.presentation_layout"))+" "),i("i",{staticClass:"fas fa-check min-width-auto text-light",class:{"text-dark":"presentation"===e.pageConfigs.layout}})]):e._e(),e._v(" "),i("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("fullpage")}}},[e._v(e._s(e.$t("meeting.fullpage_layout"))+" "),"fullpage"===e.pageConfigs.layout?i("i",{staticClass:"fas fa-check min-width-auto text-light",class:{"text-dark":"fullpage"===e.pageConfigs.layout}}):e._e()])]),e._v(" "),e.pageConfigs.enableChat&&e.configs.chat&&e.configs.chat.enabled&&e.subscriptions&&e.subscriptions.userPrivate&&!e.entity.isBlocked?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],class:["btn action chats-toggle-btn",{pulse:e.totalUnreadMessages&&e.totalUnreadMessages>0&&!e.isChatBoxShown}],attrs:{type:"button",title:e.$t(e.isChatBoxShown?"global.hide":"global.show",{attribute:e.$t("chat.chats")})},on:{click:e.toggleChatBox}},[i("i",{class:[e.isChatBoxShown?"fas fa-comment-slash":"far fa-comment"]}),e._v(" "),e.totalUnreadMessages&&e.totalUnreadMessages>0?i("span",{staticClass:"text-success unread-count"},[e._v(e._s(e.totalUnreadMessages))]):e._e()]):e._e()]:e._e(),e._v(" "),i("base-dropdown",{staticClass:"more-actions",attrs:{tag:"div",direction:"up","menu-classes":"show-dropdown-up",position:"right"}},[i("button",{staticClass:"btn action more-actions-btn",attrs:{slot:"title",type:"button"},slot:"title"},[i("i",{staticClass:"fas fa-ellipsis-v"})]),e._v(" "),e.entity&&e.entity.status&&e.videoList.length?i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.getOffline}},[i("i",{staticClass:"fas fa-phone-slash"}),e._v(" "+e._s(e.$t("meeting.leave_meeting")))]):i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(t){return e.$router.back()}}},[i("i",{staticClass:"fas fa-chevron-left"}),e._v(" "+e._s(e.$t("general.back")))]),e._v(" "),e.entity&&e.entity.status&&e.entity.canModerate&&"live"===e.entity.status?i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.endMeeting}},[i("i",{staticClass:"fas fa-calendar-times"}),e._v(" "+e._s(e.$t("meeting.end_meeting")))]):e._e(),e._v(" "),i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.updateUsername}},[i("i",{staticClass:"fas fa-user"}),e._v(" "+e._s(e.$t("meeting.update_username")))]),e._v(" "),i("div",{staticClass:"dropdown-divider my-1",attrs:{role:"separator"}}),e._v(" "),e.pageConfigs.hasAgenda?i("button",{staticClass:"dropdown-item agenda-toggle-btn",attrs:{type:"button"},on:{click:e.toggleAgenda}},[i("i",{staticClass:"fas fa-quote-left"}),e._v(" "+e._s(e.$t(e.showAgenda?"global.hide":"global.show",{attribute:e.$t("general.agenda")})))]):e._e(),e._v(" "),i("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:e.toggleFooterAutoHide}},[i("i",{staticClass:"fas fa-hourglass-start"}),e._v(" "+e._s(e.$t(e.pageConfigs.footerAutoHide?"meeting.toggle_autohide_off":"meeting.toggle_autohide_on")))]),e._v(" "),e.uiConfigs.fullScreen?i("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:function(t){return e.toggleFullScreen(!1)}}},[i("i",{staticClass:"fas fa-compress"}),e._v(" "+e._s(e.$t("config.ui.toggle_fullscreen")))]):i("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:function(t){return e.toggleFullScreen(!0)}}},[i("i",{staticClass:"fas fa-expand"}),e._v(" "+e._s(e.$t("config.ui.toggle_fullscreen")))]),e._v(" "),i("div",{staticClass:"dropdown-divider d-md-none my-1",attrs:{role:"separator"}}),e._v(" "),i("button",{staticClass:"dropdown-item d-md-none",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("grid")}}},[i("i",{staticClass:"fas fa-check text-light",class:{"text-dark":"grid"===e.pageConfigs.layout}}),e._v(" "+e._s(e.$t("meeting.grid_layout")))]),e._v(" "),i("button",{staticClass:"dropdown-item d-md-none",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("fullpage")}}},[i("i",{staticClass:"fas fa-check text-light",class:{"text-dark":"fullpage"===e.pageConfigs.layout}}),e._v(" "+e._s(e.$t("meeting.fullpage_layout")))]),e._v(" "),i("div",{staticClass:"dropdown-divider my-1",attrs:{role:"separator"}}),e._v(" "),e.pageConfigs.showDeviceConfig?i("button",{staticClass:"dropdown-item show-devices-btn",attrs:{type:"button"},on:{click:e.toggleDevicesModal}},[i("i",{staticClass:"fas fa-cogs"}),e._v(" "+e._s(e.$t("meeting.media_devices.setup")))]):e._e(),e._v(" "),e.pageConfigs.enableLinkSharing&&e.pageConfigs.pamEnableLinkSharingForGuest?i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.shareURL}},[i("i",{staticClass:"fas fa-share-alt"}),e._v(" "+e._s(e.$t("general.share_url")))]):e._e()])],2)]),e._v(" "),i("div",{class:["agenda-streams-container",{"has-agenda":e.pageConfigs.hasAgenda||e.hasVideos&&e.pageConfigs.enableWhiteboard},{"agenda-visible":e.showAgenda||e.hasVideos&&e.showWhiteboard},{"has-cover-image":e.entity&&e.entity.cover&&e.hasVideos}],style:e.coverPageStyles},[e.entity&&!e.entity.isBlocked?[e.pageConfigs.hasAgenda?[i("card",{staticClass:"agenda-container",attrs:{shadow:"","body-classes":"agenda-wrapper"}},[i("div",{staticClass:"meeting-agenda-container"},[i("vue-scroll",{ref:"vue-scroll-agenda",attrs:{id:"vue-scroll-agenda"}},[e.entity?[e._m(0),e._v(" "),i("div",{staticClass:"text-muted mt-3"},[e._m(1),e._v(" "),e._m(2)]),e._v(" "),i("view-paragraph",{staticClass:"mt-3",attrs:{label:e.$t("meeting.props.agenda"),value:e.entity.agenda}}),e._v(" "),e.entity.description?i("view-paragraph",{staticClass:"mt-3",attrs:{label:e.$t("meeting.props.description"),value:e.entity.description,html:""}}):e._e(),e._v(" "),e.entity.attachments?i("view-uploads",{class:["mt-3",e.uiConfigs.colorSchemeType],attrs:{label:e.$t("upload.attachments"),"name-label":e.$t("upload.attachment"),value:e.entity.attachments,"download-button-classes":"text-gray","url-prefix":"/meetings/"+e.uuid+"/downloads"}}):e._e()]:e._e()],2)],1)])]:e._e(),e._v(" "),e.hasVideos&&e.pageConfigs.enableWhiteboard?[i("card",{staticClass:"whiteboard-container",attrs:{shadow:"","body-classes":"whiteboard-wrapper"}},[i("div",{staticClass:"meeting-whiteboard-container"},[i("vue-scroll",{ref:"vue-scroll-whiteboard",attrs:{id:"vue-scroll-whiteboard"}},[i("div",{ref:"whiteboard",staticClass:"whiteboard",attrs:{id:"whiteboard"}})])],1)])]:e._e()]:e._e(),e._v(" "),i("div",{class:["streams-container",e.hasVideos?"stream-"+e.pageConfigs.layout+"-layout":""]},[i("div",{ref:"videoListEle",class:["video-list",e.hasVideosClasses]},[e.hasVideos?[e._l(e.videoList,(function(t,n){return[i("div",{key:""+t.uuid+t.id,class:["video-item video-card",{maximized:t.maximized},{local:t.local},{screen:t.screen},{whiteboard:t.whiteboard},{"fullscreen-item":t.id===e.fullScreenItemId},{"hand-up":t.isHandUp},{"user-speaking":t.speaking},{"audio-muted":t.audioMuted},{"video-muted":t.videoMuted||!t.hasVideo},{"no-stream":!t.status},{"disable-mirror":t.disableMirror},{"has-full-user-avatar":e.pageConfigs.enableUserAvatar&&e.pageConfigs.enableFullUserAvatar&&t.extra&&(t.extra.cover||t.extra.avatar)&&(t.videoMuted||!t.hasVideo)}],on:{dblclick:function(i){return e.changeFocus(t)}}},[i("div",{staticClass:"video-wrapper"},[i("video",{ref:"videos",refInFor:!0,class:[{"no-poster":t.status&&!t.videoMuted}],attrs:{autoplay:"",playsinline:"",id:t.id,poster:t.status?null:"/images/video/no-stream.jpg"},domProps:{muted:t.muted}}),e._v(" "),e.pageConfigs.enableUserAvatar&&e.pageConfigs.enableFullUserAvatar&&t.extra&&(t.extra.cover||t.extra.avatar)&&(t.videoMuted||!t.hasVideo)?i("div",{staticClass:"full-user-avatar",style:"background-image: url("+(t.extra.cover||t.extra.avatar)+")"}):e._e(),e._v(" "),i("div",{staticClass:"caption"},[e.pageConfigs.enableUserAvatar&&!t.local?[i("user-avatar",{staticClass:"mr-1",attrs:{user:t.extra?t.extra:{name:t.name},size:40,"has-shadow":""}})]:e._e(),e._v(" "),i("h6",[i("span",{class:["text-xs mr-1",{"text-success":t.status},{"text-danger":!t.status}]},[i("i",{staticClass:"fas fa-circle"})]),e._v(" "),t.local?[e._v("\n                                                "+e._s(t.screen?e.$t("meeting.your_screen"):t.whiteboard?e.$t("meeting.your_whiteboard"):e.$t("meeting.you"))+"\n                                            ")]:[e._v("\n                                                "+e._s(t.screen?""+t.name+e.$t("meeting.screen"):t.whiteboard?""+t.name+e.$t("meeting.whiteboard"):t.name)+"\n                                            ")],e._v(" "),t.status?e._e():i("span",{staticClass:"bracketed text-danger"},[e._v(e._s(e.$t("meeting.left")))])],2)],2),e._v(" "),i("div",{staticClass:"highlight-border"})]),e._v(" "),t.local?t.local&&!t.whiteboard&&!t.screen&&t.isHandUp?i("div",{staticClass:"custom-controls-wrapper"},[i("div",{staticClass:"custom-controls"},[i("div",{staticClass:"status-icon"},[i("i",{staticClass:"fas fa-hand-paper enabled-text"})])])]):e._e():i("div",{staticClass:"custom-controls-wrapper"},[i("div",{staticClass:"custom-controls"},[t.extra.isHost?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.host")}},[i("i",{staticClass:"fas fa-user-tie text-info"})]):t.extra.canModerate?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.moderator")}},[i("i",{staticClass:"fas fa-user-cog text-info"})]):e._e(),e._v(" "),t.whiteboard||t.screen||!t.isHandUp?e._e():i("div",{staticClass:"status-icon"},[i("i",{staticClass:"fas fa-hand-paper enabled-text"})]),e._v(" "),t.audioMuted?i("div",{staticClass:"status-icon"},[i("i",{staticClass:"fas fa-microphone-slash disabled-text"})]):e._e(),e._v(" "),"fullpage"!==e.pageConfigs.layout||t.maximized?i("base-dropdown",{staticClass:"custom-control-dropdown",attrs:{tag:"div",position:"right"}},[i("button",{staticClass:"btn action custom-control-dropdown-btn btn-sm",attrs:{slot:"title",type:"button"},slot:"title"},[i("i",{staticClass:"fas fa-ellipsis-v"})]),e._v(" "),i("button",{staticClass:"dropdown-item btn-sm",attrs:{type:"button"},on:{click:function(i){return e.disableMirror(t,n)}}},[i("i",{staticClass:"fas fa-exchange-alt enabled-text"}),e._v(" "+e._s(e.$t("meeting.mirror_flip"))+"\n                                            ")]),e._v(" "),"fullpage"!==e.pageConfigs.layout||t.maximized?e._e():i("button",{staticClass:"dropdown-item btn-sm",attrs:{type:"button"},on:{click:function(i){return e.changeFocus(t)}}},[i("i",{staticClass:"fas fa-expand enabled-text"}),e._v(" "+e._s(e.$t("meeting.maximize"))+"\n                                            ")]),e._v(" "),i("button",{staticClass:"dropdown-item btn-sm",attrs:{type:"button"},on:{click:function(i){return e.toggleRemoteAudio(t,n)}}},[t.muted?[i("i",{staticClass:"fas fa-volume-up enabled-text"}),e._v(" "+e._s(e.$t("meeting.unmute_for_me"))+"\n                                                ")]:[i("i",{staticClass:"fas fa-volume-off disabled-text"}),e._v(" "+e._s(e.$t("meeting.mute_for_me"))+"\n                                                ")]],2),e._v(" "),e.pageConfigs.enableSnapshot&&(e.pageConfigs.anyoneCanTakeSnapshot||e.entity.canModerate)?i("button",{staticClass:"dropdown-item btn-sm",attrs:{type:"button"},on:{click:function(i){return e.takeSnapshotOfStream(t,n)}}},[i("i",{staticClass:"fas fa-image enabled-text"}),e._v(" "+e._s(e.$t("meeting.take_snapshot"))+"\n                                            ")]):e._e()]):[i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.mute_for_me")},on:{click:function(i){return e.toggleRemoteAudio(t,n)}}},[i("i",{class:["fas",{"fa-volume-up enabled-text":t.muted},{"fa-volume-off disabled-text":!t.muted}]})]),e._v(" "),i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.maximize")},on:{click:function(i){return e.changeFocus(t)}}},[i("i",{staticClass:"fas fa-expand enabled-text"})]),e._v(" "),e.pageConfigs.enableSnapshot&&(e.pageConfigs.anyoneCanTakeSnapshot||e.entity.canModerate)?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.take_snapshot")},on:{click:function(i){return e.takeSnapshotOfStream(t,n)}}},[i("i",{staticClass:"fas fa-image enabled-text"})]):e._e(),e._v(" "),e.entity.canModerate?[i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.kick_ban_participant")},on:{click:function(i){return e.kickRemoteUser(t,n)}}},[i("i",{staticClass:"fas fa-ban enabled-text"})]),e._v(" "),i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.mute_for_everyone")},on:{click:function(i){return e.toggleRemoteAudioSource(t,n)}}},[i("i",{class:["fas",{"fa-microphone enabled-text":t.audioMuted},{"fa-microphone-slash disabled-text":!t.audioMuted}]})])]:e._e()]],2)])])]}))]:i("card",{staticClass:"video-item wait-box maximized",attrs:{shadow:""}},[e.entity&&!e.entity.isBlocked?["scheduled"===e.entity.status||"live"===e.entity.status?[i("div",{staticClass:"green-room text-center mt-3"},[i("video",{ref:"greenRoomVideo",attrs:{autoplay:"",playsinline:"",muted:"",id:"greenRoomVideo"},domProps:{muted:!0}}),e._v(" "),i("br"),e._v(" "),i("canvas",{ref:"greenRoomAudio",staticStyle:{margin:"0 auto"},attrs:{id:"greenRoomAudio",width:"250",height:"15","data-val":e.micVolumeActivity}},[e._v("No canvas")])])]:e._e(),e._v(" "),"scheduled"===e.entity.status?[e.startDateTimeIsFuture?i("flip-countdown",{staticClass:"my-3",attrs:{deadline:e.entity.startDateTime}}):[i("h5",{staticClass:"text-muted text-center my-3"},[e._v("\n                                        "+e._s(e.$t("meeting.starting_any_time_now"))+"\n                                    ")])],e._v(" "),i("div",{staticClass:"text-center my-3"},[i("span",{staticClass:"text-muted"},[e._v(e._s(e.$t("meeting.scheduled_for")))]),i("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"text-muted-lg m-l-5",attrs:{title:e._f("momentDateTime")(e.entity.startDateTime)}},[e._v(e._s(e._f("momentCalendar")(e.entity.startDateTime,{sameElse:e.vars.defaultDateTimeFormat})))])]),e._v(" "),e.liveMembersCount>0?i("div",{staticClass:"text-muted text-center my-3"},[i("span",{staticClass:"text-xs text-success mr-1"},[i("i",{staticClass:"fas fa-circle"})]),e._v(" "),i("animated-number",{attrs:{number:e.liveMembersCount,delay:100}}),e._v(" "),e.liveMembersCount>1?i("span",[e._v(e._s(e.$t("meeting.members_online")))]):i("span",[e._v(e._s(e.$t("meeting.member_online")))])],1):e._e()]:"live"===e.entity.status?[e.roomIdAlive?[i("h5",{staticClass:"text-muted text-center my-3"},[e._v("\n                                        "+e._s(e.$t("meeting.is_live_now"))+"\n                                    ")]),e._v(" "),i("div",{staticClass:"d-flex justify-content-center my-3"},[i("base-button",{attrs:{type:"button",design:"primary",size:"lg"},on:{click:e.getOnline}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("meeting.get_live")})))])],1)]:[i("h5",{staticClass:"text-muted text-center my-3"},[e._v("\n                                        "+e._s(e.$t("meeting.starting_any_time_now"))+"\n                                    ")])],e._v(" "),e.liveMembersCount>0?i("div",{staticClass:"text-muted text-center my-3"},[i("span",{staticClass:"text-xs text-success mr-1"},[i("i",{staticClass:"fas fa-circle"})]),e._v(" "),i("animated-number",{attrs:{number:e.liveMembersCount,delay:100}}),e._v(" "),e.liveMembersCount>1?i("span",[e._v(e._s(e.$t("meeting.members_online")))]):i("span",[e._v(e._s(e.$t("meeting.member_online")))])],1):e._e()]:"cancelled"===e.entity.status?[i("h4",{staticClass:"text-muted text-center my-3"},[e._v("\n                                    "+e._s(e.$t("meeting.meeting_cancelled"))+"\n                                ")]),e._v(" "),i("div",{staticClass:"d-flex justify-content-center"},[i("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(t){return e.$router.back()}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]:"ended"===e.entity.status?[i("h4",{staticClass:"text-muted text-center my-3"},[e._v("\n                                    "+e._s(e.$t("meeting.meeting_ended"))+"\n                                ")]),e._v(" "),i("div",{staticClass:"d-flex justify-content-center"},[i("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(t){return e.$router.back()}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]:e._e()]:[e.entity?i("h3",{staticClass:"text-center text-danger my-3"},[e._v("\n                                "+e._s(e.$t("meeting.not_allowed"))+"\n                            ")]):e._e()]],2)],2)])],2),e._v(" "),i("b-modal",{attrs:{size:"md",centered:"",lazy:"",busy:e.isLoading,id:"devicesModal","no-close-on-backdrop":"","no-close-on-esc":""},on:{ok:e.onDevicesModalOK,cancel:e.onDevicesModalCancel},model:{value:e.showDevicesModal,callback:function(t){e.showDevicesModal=t},expression:"showDevicesModal"}},[i("template",{slot:"modal-header"},[i("h5",{staticClass:"modal-title"},[e._v(e._s(e.$t("meeting.media_devices.video_and_audio_devices")))])]),e._v(" "),i("div",[i("base-select",{attrs:{options:e.mediaDevices.audioInput,label:e.$t("meeting.media_devices.audio_input"),"allow-empty":!1,"preselect-first":""},model:{value:e.mediaConfigFormData.selectedAudioInput,callback:function(t){e.$set(e.mediaConfigFormData,"selectedAudioInput",t)},expression:"mediaConfigFormData.selectedAudioInput"}}),e._v(" "),i("base-select",{attrs:{options:e.mediaDevices.videoInput,label:e.$t("meeting.media_devices.video_input"),"allow-empty":!1,"preselect-first":""},model:{value:e.mediaConfigFormData.selectedVideoInput,callback:function(t){e.$set(e.mediaConfigFormData,"selectedVideoInput",t)},expression:"mediaConfigFormData.selectedVideoInput"}}),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-12 col-md-4"},[i("base-select",{attrs:{options:e.mediaDevices.resolutions,label:e.$t("meeting.media_devices.video_resolution"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"label","show-by":"label"},model:{value:e.mediaConfigFormData.selectedResolution,callback:function(t){e.$set(e.mediaConfigFormData,"selectedResolution",t)},expression:"mediaConfigFormData.selectedResolution"}})],1),e._v(" "),i("div",{staticClass:"col-12 col-md-4"},[i("base-select",{attrs:{options:e.mediaDevices.frameRates,label:e.$t("meeting.media_devices.frame_rate"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"uuid","show-by":"label"},model:{value:e.mediaConfigFormData.frameRate,callback:function(t){e.$set(e.mediaConfigFormData,"frameRate",t)},expression:"mediaConfigFormData.frameRate"}})],1),e._v(" "),i("div",{staticClass:"col-12 col-md-4"},[i("base-select",{attrs:{options:e.mediaDevices.facingModes,label:e.$t("meeting.media_devices.facing_mode"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"uuid","show-by":"label"},model:{value:e.mediaConfigFormData.facingMode,callback:function(t){e.$set(e.mediaConfigFormData,"facingMode",t)},expression:"mediaConfigFormData.facingMode"}})],1),e._v(" "),i("div",{staticClass:"col-12"},[i("h6",{staticClass:"mt-2 pb-1"},[e._v(e._s(e.$t("meeting.media_devices.bandwidth")))])]),e._v(" "),i("div",{staticClass:"col-12 col-sm-4"},[i("base-select",{attrs:{options:e.audioBandwidthOpts,label:e.$t("meeting.media_devices.audio"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"uuid","show-by":"label"},model:{value:e.mediaConfigFormData.bandwidth.audio,callback:function(t){e.$set(e.mediaConfigFormData.bandwidth,"audio",t)},expression:"mediaConfigFormData.bandwidth.audio"}})],1),e._v(" "),i("div",{staticClass:"col-12 col-sm-4"},[i("base-select",{attrs:{options:e.videoBandwidthOpts,label:e.$t("meeting.media_devices.video"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"uuid","show-by":"label"},model:{value:e.mediaConfigFormData.bandwidth.video,callback:function(t){e.$set(e.mediaConfigFormData.bandwidth,"video",t)},expression:"mediaConfigFormData.bandwidth.video"}})],1),e._v(" "),i("div",{staticClass:"col-12 col-sm-4"},[i("base-select",{attrs:{options:e.screenBandwidthOpts,label:e.$t("meeting.media_devices.screen"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"uuid","show-by":"label"},model:{value:e.mediaConfigFormData.bandwidth.screen,callback:function(t){e.$set(e.mediaConfigFormData.bandwidth,"screen",t)},expression:"mediaConfigFormData.bandwidth.screen"}})],1)])],1)],2)]],2)}),[function(){var e=this.$createElement;return(this._self._c||e)("h4",{staticClass:"meeting-title"},[this._v(this._s(this.entity.title))])},function(){var e=this.$createElement;return(this._self._c||e)("span",[this._v(this._s(this.$t("meeting.props.type"))+": "+this._s(this.entity.type.name)+",")])},function(){var e=this.$createElement;return(this._self._c||e)("span",[this._v(this._s(this.$t("meeting.meeting_category.category"))+": "+this._s(this.entity.category.name))])}],!1,null,null,null);t.default=F.exports},adPT:function(e,t,i){"use strict";var n={name:"animated-number",props:{number:{type:Number,default:0},delay:{type:Number,default:20}},data:function(){return{displayNumber:0,interval:!1,initialInterval:!1}},methods:{changeNumberFn:function(){if(this.displayNumber!=this.number){var e=(this.number-this.displayNumber)/10;e=e>=0?Math.ceil(e):Math.floor(e),this.displayNumber=this.displayNumber+e}}},watch:{number:function(){clearInterval(this.interval),this.number!=this.displayNumber&&(this.interval=window.setInterval(this.changeNumberFn,this.delay))}},mounted:function(){this.displayNumber=0,clearInterval(this.initialInterval),this.number!=this.displayNumber&&(this.initialInterval=window.setInterval(this.changeNumberFn,this.delay))}},r=i("KHd+"),o=Object(r.a)(n,(function(){var e=this.$createElement;return(this._self._c||e)("span",[this._v(this._s(this.displayNumber))])}),[],!1,null,null,null);t.a=o.exports},akQX:function(e,t,i){"use strict";i.d(t,"e",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return s})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return d}));var n=i("V0LQ");navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert($t("misc.get_user_media_not_supported")),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(navigator.enumerateDevices=function(e){navigator.mediaDevices.enumerateDevices().then(e)});location.protocol;"undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack||navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices;var r=function(e){var t={icon:"error",html:"",footer:$t("misc.solve_and_refresh")};if(e)return"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?(t.title=$t("misc.media.permission_denied"),t.html=$t("misc.media.permission_denied_text")):"NotFoundError"===e.name?(t.title=$t("misc.media.not_found"),t.html=$t("misc.media.not_found_text")):"NotReadableError"===e.name||"OverconstrainedError"===e.name?(t.title=$t("misc.media.unreadable"),t.html=$t("misc.media.unreadable_text")):"SecurityError"!==e.name&&"TypeError"!==e.name||(t.title=$t("misc.media.security"),t.html=$t("misc.media.security_text")),t.html+='<div><pre><code style="white-space: break-spaces;">'+e+"</code><pre></div>",{msg:t,alert:swtAlert.fire(t)}},o=function(e){if((e=Object.assign({},{type:null,loop:!1,duration:1e3},e)).type){var t=new Audio;return t.preload="auto",t.autoplay=!0,t.loop=e.loop,t.src="/sound/".concat(e.type,".mp3"),t.play().then((function(){setTimeout((function(){t&&t.pause()}),e.duration)})).catch((function(e){console.error(e)})),t}},a=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||e)return o({type:"calling",loop:!0,duration:3e4})},s=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||e)return o({type:"message",duration:3e3})},c=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||e)return o({type:"screenshot",duration:3e3})},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=document.querySelector("link[rel=canonical]")?document.querySelector("link[rel=canonical]").href:document.location.href,o=e.url?e.url:r;if(i&&navigator.share)navigator.share({title:e.title?e.title:document.title,url:o}).then((function(){})).catch(console.error);else{var a={showCancelButton:!0,confirmButtonText:$t("misc.share_alert.confirm_btn"),cancelButtonText:$t("misc.share_alert.cancel_btn")};e.alertTitle&&(a.title=e.alertTitle),e.alertHtml?a.html=e.alertHtml:a.text=$t("misc.share_alert.text"),swtAlert.fire(a).then((function(e){e.value&&(Object(n.c)(o),setTimeout((function(){t()}),500))}))}}},bdEB:function(e,t,i){"use strict";var n=i("L2JU");function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var s={props:{tag:{type:String,default:"a"},place:{type:String,default:"normal"},size:{type:String,default:"normal"},appLogo:{type:Boolean,default:!1},inline:{type:Boolean,default:!1},link:{type:String,default:""},assets:{type:Object}},data:function(){return{appLogoText:window.kmenv.name}},computed:o(o({},Object(n.c)("config",["configs","uiConfigs"])),{},{computedUrl:function(){return"a"===this.tag&&(""!==this.link?this.link:"/")},orgLogo:function(){if(this.appLogo||!this.configs.assets&&!this.assets)return"navbar"===this.place||"sidebar"===this.place||"dark"===this.place?"/images/logo-light.png":"/images/logo.png";var e=this.assets&&this.assets.logo?this.assets.logo:this.configs.assets.logo?this.configs.assets.logo:"/images/logo.png";return(this.assets&&this.assets.logoLight||this.configs.assets.logoLight)&&("navbar"===this.place&&this.uiConfigs.topNavbarLogoLight||"sidebar"===this.place&&this.uiConfigs.leftSidebarLogoLight||"dark"===this.place)&&(e=this.assets&&this.assets.logoLight?this.assets.logoLight:this.configs.assets.logoLight),e},appTitle:function(){return this.configs.basic?this.configs.basic.appName:window.kmenv.name}})},c=i("KHd+"),d=Object(c.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(e.tag,{tag:"component",class:["logo",e.place+"-logo",e.size+"-logo",e.orgLogo?"org-logo":"app-logo",e.inline?"inline-logo":""],attrs:{href:e.computedUrl}},[e.orgLogo?i("img",{staticClass:"logo-icon",attrs:{src:e.orgLogo,alt:e.appTitle}}):[i("span",{staticClass:"logo-text",attrs:{title:e.appTitle}},[e._v(e._s(e.appLogoText))])]],2)}),[],!1,null,null,null);t.a=d.exports},mpN2:function(e,t,i){var n,r,o,a;function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a=function(){return function e(t,i,n){function r(a,s){if(!i[a]){if(!t[a]){if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[a]={exports:{}};t[a][0].call(d.exports,(function(e){return r(t[a][1][e]||e)}),d,d.exports,e,t,i,n)}return i[a].exports}for(var o=!1,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,t,i){"use strict";var n=(0,e("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?void 0:window});t.exports=n},{"./adapter_factory.js":2}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.adapterFactory=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.window,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},d=n.log,l=n.detectBrowser(t),u={browserDetails:l,commonShim:c,extractVersion:n.extractVersion,disableLog:n.disableLog,disableWarnings:n.disableWarnings};switch(l.browser){case"chrome":if(!r||!r.shimPeerConnection||!i.shimChrome)return d("Chrome shim is not included in this adapter release."),u;if(null===l.version)return d("Chrome shim can not determine version, not shimming."),u;d("adapter.js shimming chrome."),u.browserShim=r,r.shimGetUserMedia(t),r.shimMediaStream(t),r.shimPeerConnection(t),r.shimOnTrack(t),r.shimAddTrackRemoveTrack(t),r.shimGetSendersWithDtmf(t),r.shimGetStats(t),r.shimSenderReceiverGetStats(t),r.fixNegotiationNeeded(t),c.shimRTCIceCandidate(t),c.shimConnectionState(t),c.shimMaxMessageSize(t),c.shimSendThrowTypeError(t),c.removeAllowExtmapMixed(t);break;case"firefox":if(!a||!a.shimPeerConnection||!i.shimFirefox)return d("Firefox shim is not included in this adapter release."),u;d("adapter.js shimming firefox."),u.browserShim=a,a.shimGetUserMedia(t),a.shimPeerConnection(t),a.shimOnTrack(t),a.shimRemoveStream(t),a.shimSenderGetStats(t),a.shimReceiverGetStats(t),a.shimRTCDataChannel(t),a.shimAddTransceiver(t),a.shimGetParameters(t),a.shimCreateOffer(t),a.shimCreateAnswer(t),c.shimRTCIceCandidate(t),c.shimConnectionState(t),c.shimMaxMessageSize(t),c.shimSendThrowTypeError(t);break;case"edge":if(!o||!o.shimPeerConnection||!i.shimEdge)return d("MS edge shim is not included in this adapter release."),u;d("adapter.js shimming edge."),u.browserShim=o,o.shimGetUserMedia(t),o.shimGetDisplayMedia(t),o.shimPeerConnection(t),o.shimReplaceTrack(t),c.shimMaxMessageSize(t),c.shimSendThrowTypeError(t);break;case"safari":if(!s||!i.shimSafari)return d("Safari shim is not included in this adapter release."),u;d("adapter.js shimming safari."),u.browserShim=s,s.shimRTCIceServerUrls(t),s.shimCreateOfferLegacy(t),s.shimCallbacksAPI(t),s.shimLocalStreamsAPI(t),s.shimRemoteStreamsAPI(t),s.shimTrackEventTransceiver(t),s.shimGetUserMedia(t),s.shimAudioContext(t),c.shimRTCIceCandidate(t),c.shimMaxMessageSize(t),c.shimSendThrowTypeError(t),c.removeAllowExtmapMixed(t);break;default:d("Unsupported browser!")}return u};var n=d(e("./utils")),r=d(e("./chrome/chrome_shim")),o=d(e("./edge/edge_shim")),a=d(e("./firefox/firefox_shim")),s=d(e("./safari/safari_shim")),c=d(e("./common_shim"));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=i.shimGetUserMedia=void 0;var n="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)},r=e("./getusermedia");Object.defineProperty(i,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(i,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),i.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},i.shimOnTrack=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var i=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(n){var r=void 0;r=e.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find((function(e){return e.track&&e.track.id===n.track.id})):{track:n.track};var o=new Event("track");o.track=n.track,o.receiver=r,o.transceiver={receiver:r},o.streams=[t.stream],i.dispatchEvent(o)})),t.stream.getTracks().forEach((function(n){var r=void 0;r=e.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find((function(e){return e.track&&e.track.id===n.id})):{track:n};var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=[t.stream],i.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else a.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))},i.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var r=i.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var i=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){i._senders.push(t(i,e))}))};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach((function(e){var i=t._senders.find((function(t){return t.track===e}));i&&t._senders.splice(t._senders.indexOf(i),1)}))}}else if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},i.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,i=Array.prototype.slice.call(arguments),n=i[0],r=i[1],o=i[2];if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var i={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){i[t]=e.stat(t)})),t[i.id]=i})),t},s=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var c=function(e){r(s(a(e)))};return t.apply(this,[c,n])}return new Promise((function(i,n){t.apply(e,[function(e){i(s(a(e)))},n])})).then(r,o)}}},i.shimSenderReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,i=t.apply(this,[]);return i.forEach((function(t){return t._pc=e})),i});var i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return a.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=r.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),a.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return a.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],i=void 0,n=void 0,r=void 0;return this.getSenders().forEach((function(e){e.track===t&&(i?r=!0:i=e)})),this.getReceivers().forEach((function(e){return e.track===t&&(n?r=!0:n=e),e.track===t})),r||i&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}},i.shimAddTrackRemoveTrackWithNative=d,i.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=a.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return d(e);var i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=i.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var i=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(i.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}n.apply(this,[t])};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,i){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var o=this.getSenders().find((function(e){return e.track===t}));if(o)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var a=this._streams[i.id];if(a)a.addTrack(t),Promise.resolve().then((function(){n.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new e.MediaStream([t]);this._streams[i.id]=s,this._reverseStreams[s.id]=i,this.addStream(s)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var i=e.RTCPeerConnection.prototype[t],n=c({},t,(function(){var e=this,t=arguments,n=arguments.length&&"function"==typeof arguments[0];return n?i.apply(this,[function(i){var n=l(e,i);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):i.apply(this,arguments).then((function(t){return l(e,t)}))}));e.RTCPeerConnection.prototype[t]=n[t]}));var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=u(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:l(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var i=void 0;Object.keys(this._streams).forEach((function(n){t._streams[n].getTracks().find((function(t){return e.track===t}))&&(i=t._streams[n])})),i&&(1===i.getTracks().length?this.removeStream(this._reverseStreams[i.id]):i.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function l(e,t){var i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],r=e._streams[n.id];i=i.replace(new RegExp(r.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:i})}function u(e,t){var i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],r=e._streams[n.id];i=i.replace(new RegExp(n.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:i})}},i.shimPeerConnection=function(e){var t=a.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){var i=0===e.RTCPeerConnection.prototype.addIceCandidate.length;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var i=e.RTCPeerConnection.prototype[t],n=c({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]}));var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return i||arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},i.fixNegotiationNeeded=function(e){var t=a.detectBrowser(e);a.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){var i=e.target;if(!(t.version<72||i.getConfiguration&&"plan-b"===i.getConfiguration().sdpSemantics)||"stable"===i.signalingState)return e}))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("../utils.js"));function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){if(!i)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[i.id]?-1===this._shimmedLocalStreams[i.id].indexOf(n)&&this._shimmedLocalStreams[i.id].push(n):this._shimmedLocalStreams[i.id]=[i,n],n};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var n=this.getSenders();i.apply(this,arguments);var r=this.getSenders().filter((function(e){return-1===n.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(r)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(i){var n=t._shimmedLocalStreams[i].indexOf(e);-1!==n&&t._shimmedLocalStreams[i].splice(n,1),1===t._shimmedLocalStreams[i].length&&delete t._shimmedLocalStreams[i]})),r.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(i){return t(i).then((function(t){var n=i.video&&i.video.width,r=i.video&&i.video.height,o=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(i.video.mandatory.maxWidth=n),r&&(i.video.mandatory.maxHeight=r),e.navigator.mediaDevices.getUserMedia(i)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],5:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)};i.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var i=r.detectBrowser(e),a=function(e){if("object"!==(void 0===e?"undefined":n(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(i){if("require"!==i&&"advanced"!==i&&"mediaSource"!==i){var r="object"===n(e[i])?e[i]:{ideal:e[i]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[o("min",i)]=r.ideal,t.optional.push(a),(a={})[o("max",i)]=r.ideal,t.optional.push(a)):(a[o("",i)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",i)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,i)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,r){if(i.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===n(e.audio)){var s=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])};s((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=a(e.audio)}if(e&&"object"===n(e.video)){var c=e.video.facingMode;c=c&&("object"===(void 0===c?"undefined":n(c))?c:{ideal:c});var d=i.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||d)){delete e.video.facingMode;var l=void 0;if("environment"===c.exact||"environment"===c.ideal?l=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(l=["front"]),l)return t.mediaDevices.enumerateDevices().then((function(t){var i=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return l.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!i&&t.length&&l.includes("back")&&(i=t[t.length-1]),i&&(e.video.deviceId=c.exact?{exact:i.deviceId}:{ideal:i.deviceId}),e.video=a(e.video),o("chrome: "+JSON.stringify(e)),r(e)}))}e.video=a(e.video)}return o("chrome: "+JSON.stringify(e)),r(e)},c=function(e){return i.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,i,n){s(e,(function(e){t.webkitGetUserMedia(e,i,(function(e){n&&n(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var d=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,(function(e){return d(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("../utils.js")),o=r.log},{"../utils.js":15}],6:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)};i.shimRTCIceCandidate=function(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var i=new t(e),r=a.default.parseCandidate(e.candidate),o=Object.assign(i,r);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,c.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},i.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=c.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var i=function(e){if(!e||!e.sdp)return!1;var t=a.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=a.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},n=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var i=parseInt(t[1],10);return i!=i?-1:i},r=function(e){var i=65536;return"firefox"===t.browser&&(i=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),i},o=function(e,i){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var r=a.default.matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?n=parseInt(r[0].substr(19),10):"firefox"===t.browser&&-1!==i&&(n=2147483637),n},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),a=e.sdpSemantics;"plan-b"===a&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(i(arguments[0])){var c=n(arguments[0]),d=r(c),l=o(arguments[0],c),u=void 0;u=0===d&&0===l?Number.POSITIVE_INFINITY:0===d||0===l?Math.max(d,l):Math.min(d,l);var m={};Object.defineProperty(m,"maxMessageSize",{get:function(){return u}}),this._sctp=m}return s.apply(this,arguments)}}},i.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return i(e,this),e},c.wrapPeerConnectionEvent(e,"datachannel",(function(e){return i(e.channel,e.target),e}))}function i(e,t){var i=e.send;e.send=function(){var n=arguments[0],r=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return i.apply(e,arguments)}}},i.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var i=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var i=new Event("connectionstatechange",e);t.dispatchEvent(i)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}}))}},i.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=c.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),i.apply(this,arguments)}}}};var r,o=e("sdp"),a=(r=o)&&r.__esModule?r:{default:r},c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=i.shimGetUserMedia=void 0;var n=e("./getusermedia");Object.defineProperty(i,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var r=e("./getdisplaymedia");Object.defineProperty(i,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r.shimGetDisplayMedia}}),i.shimPeerConnection=function(e){var t=a.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var i=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){i.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=(0,d.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,s.filterIceServers)(e.iceServers,t.version),a.log("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype},i.shimReplaceTrack=function(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var o,a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("../utils")),s=e("./filtericeservers"),c=e("rtcpeerconnection-shim"),d=(o=c)&&o.__esModule?o:{default:o}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.filterIceServers=function(e,t){var i=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&n.deprecated("RTCIceServer.url","RTCIceServer.urls");var r="string"==typeof t;return r&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!i?(i=!0,!0):t&&!i})),delete e.url,e.urls=r?t[0]:t,!!t.length}}))};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],10:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetUserMedia=function(e){var t=e&&e.navigator,i=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return i(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],11:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=i.shimGetUserMedia=void 0;var n="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)},r=e("./getusermedia");Object.defineProperty(i,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(i,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),i.shimOnTrack=function(e){"object"===(void 0===e?"undefined":n(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},i.shimPeerConnection=function(e){var t=a.detectBrowser(e);if("object"===(void 0===e?"undefined":n(e))&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var i,n,r,o=e.RTCPeerConnection.prototype[t],a=(r=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)},(n=t)in(i={})?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i);e.RTCPeerConnection.prototype[t]=a[t]})),t.version<68){var i=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),i=e[0],n=e[1],a=e[2];return o.apply(this,[i||null]).then((function(e){if(t.version<53&&!n)try{e.forEach((function(e){e.type=r[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,i){e.set(i,Object.assign({},t,{type:r[t.type]||t.type}))}))}return e})).then(n,a)}}},i.shimSenderGetStats=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,i=t.apply(this,[]);return i.forEach((function(t){return t._pc=e})),i});var i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},i.shimReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,i=t.apply(this,[]);return i.forEach((function(t){return t._pc=e})),i}),a.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},i.shimRemoveStream=function(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;a.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(i){i.track&&e.getTracks().includes(i.track)&&t.removeTrack(i)}))})},i.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},i.shimAddTransceiver=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],i=e&&"sendEncodings"in e;i&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var n=t.apply(this,arguments);if(i){var r=n.sender,o=r.getParameters();(!("encodings"in o)||1===o.encodings.length&&0===Object.keys(o.encodings[0]).length)&&(o.encodings=e.sendEncodings,r.sendEncodings=e.sendEncodings,this.setParametersPromises.push(r.setParameters(o).then((function(){delete r.sendEncodings})).catch((function(){delete r.sendEncodings}))))}return n})}},i.shimGetParameters=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}},i.shimCreateOffer=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,i=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,i)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}},i.shimCreateAnswer=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,i=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,i)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(i){if(!i||!i.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===i.video?i.video={mediaSource:t}:i.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(i)})}},{}],13:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)};i.shimGetUserMedia=function(e){var t=r.detectBrowser(e),i=e&&e.navigator,o=e&&e.MediaStreamTrack;if(i.getUserMedia=function(e,t,n){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){var a=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])},s=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":n(e))&&"object"===n(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},o&&o.prototype.getSettings){var c=o.prototype.getSettings;o.prototype.getSettings=function(){var e=c.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var d=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":n(e))&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),d.apply(this,[e])}}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)};i.shimLocalStreamsAPI=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var i=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(n){return t.call(i,n,e)})),e.getVideoTracks().forEach((function(n){return t.call(i,n,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var i=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r&&r.forEach((function(e){i._localStreams?i._localStreams.includes(e)||i._localStreams.push(e):i._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var i=this._localStreams.indexOf(e);if(-1!==i){this._localStreams.splice(i,1);var n=e.getTracks();this.getSenders().forEach((function(e){n.includes(e.track)&&t.removeTrack(e)}))}})}},i.shimRemoteStreamsAPI=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var i=new Event("addstream");i.stream=e,t.dispatchEvent(i)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var i=new Event("addstream");i.stream=t,e.dispatchEvent(i)}}))}),t.apply(e,arguments)}}},i.shimCallbacksAPI=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,i=t.createOffer,r=t.createAnswer,o=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){var i=arguments.length>=2?arguments[2]:arguments[0],n=r.apply(this,[i]);return t?(n.then(e,t),Promise.resolve()):n};var c=function(e,t,i){var n=o.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n};t.setLocalDescription=c,c=function(e,t,i){var n=a.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.setRemoteDescription=c,c=function(e,t,i){var n=s.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.addIceCandidate=c}},i.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var i=t.mediaDevices,n=i.getUserMedia.bind(i);t.mediaDevices.getUserMedia=function(e){return n(o(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,i,n){t.mediaDevices.getUserMedia(e).then(i,n)}.bind(t))},i.shimConstraints=o,i.shimRTCIceServerUrls=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,i){if(e&&e.iceServers){for(var n=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,n.push(a)):n.push(e.iceServers[o])}e.iceServers=n}return new t(e,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}},i.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":n(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},i.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var i=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveAudio||i||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var n=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}},i.shimAudioContext=function(e){"object"!==(void 0===e?"undefined":n(e))||e.AudioContext||(e.AudioContext=e.webkitAudioContext)};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("../utils"));function o(e){return e&&void 0!==e.video?Object.assign({},e,{video:r.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)};i.extractVersion=a,i.wrapPeerConnectionEvent=function(e,t,i){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,r=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return r.apply(this,arguments);var o=function(e){var t=i(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,o),r.apply(this,[e,o])};var o=n.removeEventListener;n.removeEventListener=function(e,i){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(i))return o.apply(this,arguments);var n=this._eventMap[t].get(i);return this._eventMap[t].delete(i),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},i.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":n(e))+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},i.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":n(e))+". Please use a boolean."):(o=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},i.log=function(){if("object"===("undefined"==typeof window?"undefined":n(window))){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},i.deprecated=function(e,t){o&&console.warn(e+" is deprecated, please use "+t+" instead.")},i.detectBrowser=function(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var i=e.navigator;if(i.mozGetUserMedia)t.browser="firefox",t.version=a(i.userAgent,/Firefox\/(\d+)\./,1);else if(i.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=a(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(i.mediaDevices&&i.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=a(i.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!i.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=a(i.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t},i.compactObject=function e(t){return c(t)?Object.keys(t).reduce((function(i,n){var r=c(t[n]),o=r?e(t[n]):t[n],a=r&&!Object.keys(o).length;return void 0===o||a?i:Object.assign(i,function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}({},n,o))}),{}):t},i.walkStats=d,i.filterStats=function(e,t,i){var n=i?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(i){i.type===n&&i.trackId===t.id&&d(e,i,r)}))})),r};var r=!0,o=!0;function a(e,t,i){var n=e.match(t);return n&&n.length>=i&&parseInt(n[i],10)}function c(e){return"[object Object]"===Object.prototype.toString.call(e)}function d(e,t,i){t&&!i.has(t.id)&&(i.set(t.id,t),Object.keys(t).forEach((function(n){n.endsWith("Id")?d(e,e.get(t[n]),i):n.endsWith("Ids")&&t[n].forEach((function(t){d(e,e.get(t),i)}))})))}},{}],16:[function(e,t,i){"use strict";var n=e("sdp");function r(e,t,i,r,o){var a=n.writeRtpDescription(e.kind,t);if(a+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(r?r.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),a}function o(e,t){var i={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var i=0;i<t.length;i++)if(t[i].payloadType===e||t[i].preferredPayloadType===e)return t[i]},r=function(e,t,i,r){var o=n(e.parameters.apt,i),a=n(t.parameters.apt,r);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(n){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(n.name.toLowerCase()===a.name.toLowerCase()&&n.clockRate===a.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&a.parameters.apt&&!r(n,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(n.numChannels,a.numChannels),i.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var n=0;n<t.headerExtensions.length;n++){var r=t.headerExtensions[n];if(e.uri===r.uri){i.headerExtensions.push(r);break}}})),i}function a(e,t,i){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(i)}function s(e,t){var i=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return i||e.addRemoteCandidate(t),!i}function c(e,t){var i=new Error(t);return i.name=e,i.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],i}t.exports=function(e,t){function i(t,i){i.addTrack(t),i.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,i,n,r){var o=new Event("track");o.track=i,o.receiver=n,o.transceiver={receiver:n},o.streams=r,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var l=function(i){var r=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){r[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",i=JSON.parse(JSON.stringify(i||{})),this.usingBundle="max-bundle"===i.bundlePolicy,"negotiate"===i.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(i.rtcpMuxPolicy||(i.rtcpMuxPolicy="require"),i.iceTransportPolicy){case"all":case"relay":break;default:i.iceTransportPolicy="all"}switch(i.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:i.bundlePolicy="balanced"}if(i.iceServers=function(e,t){var i=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var r="string"==typeof n;return r&&(n=[n]),n=n.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||i?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(i=!0,!0)})),delete e.url,e.urls=r?n[0]:n,!!n.length}}))}(i.iceServers||[],t),this._iceGatherers=[],i.iceCandidatePoolSize)for(var a=i.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:i.iceServers,gatherPolicy:i.iceTransportPolicy}));else i.iceCandidatePoolSize=0;this._config=i,this.transceivers=[],this._sdpSessionId=n.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var i=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&i)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var r=this._createIceAndDtlsTransports();n.iceTransport=r.iceTransport,n.dtlsTransport=r.dtlsTransport}return t||this.transceivers.push(n),n},l.prototype.addTrack=function(t,i){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var r=0;r<this.transceivers.length;r++)this.transceivers[r].track||this.transceivers[r].kind!==t.kind||(n=this.transceivers[r]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(i)&&this.localStreams.push(i),n.track=t,n.stream=i,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},l.prototype.addStream=function(e){var i=this;if(t>=15025)e.getTracks().forEach((function(t){i.addTrack(t,e)}));else{var n=e.clone();e.getTracks().forEach((function(e,t){var i=n.getTracks()[t];e.addEventListener("enabled",(function(e){i.enabled=e.enabled}))})),n.getTracks().forEach((function(e){i.addTrack(e,n)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var i=this.transceivers.find((function(e){return e.rtpSender===t}));if(!i)throw c("InvalidAccessError","Sender was not created by this connection.");var n=i.stream;i.rtpSender.stop(),i.rtpSender=null,i.track=null,i.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(n)&&this.localStreams.indexOf(n)>-1&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var i=t.getSenders().find((function(t){return t.track===e}));i&&t.removeTrack(i)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,i){var n=this;if(i&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var r=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(r,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var i=!e.candidate||0===Object.keys(e.candidate).length;r.state=i?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},r.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),r},l.prototype._gather=function(t,i){var r=this,o=this.transceivers[i].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[i].bufferedCandidateEvents;this.transceivers[i].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[i].bufferCandidates),o.onlocalcandidate=function(e){if(!(r.usingBundle&&i>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:i};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var d=n.writeCandidate(s);a.candidate=Object.assign(a.candidate,n.parseCandidate(d)),a.candidate.candidate=d,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=n.getMediaSections(r._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",r._localDescription.sdp=n.getDescription(r._localDescription.sdp)+l.join("");var u=r.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==r.iceGatheringState&&(r.iceGatheringState="gathering",r._emitGatheringStateChange()),c||r._dispatchEvent("icecandidate",a),u&&(r._dispatchEvent("icecandidate",new Event("icecandidate")),r.iceGatheringState="complete",r._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,i=new e.RTCIceTransport(null);i.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(i);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:i,dtlsTransport:n}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var i=this.transceivers[e].iceTransport;i&&(delete i.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,i,r){var a=o(e.localCapabilities,e.remoteCapabilities);i&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:n.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),r&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var t,i,r=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,r.signalingState)||r._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+r.signalingState));if("offer"===e.type)t=n.splitSections(e.sdp),i=t.shift(),t.forEach((function(e,t){var i=n.parseRtpParameters(e);r.transceivers[t].localCapabilities=i})),r.transceivers.forEach((function(e,t){r._gather(e.mid,t)}));else if("answer"===e.type){t=n.splitSections(r._remoteDescription.sdp),i=t.shift();var s=n.matchPrefix(i,"a=ice-lite").length>0;t.forEach((function(e,t){var a=r.transceivers[t],c=a.iceGatherer,d=a.iceTransport,l=a.dtlsTransport,u=a.localCapabilities,m=a.remoteCapabilities;if(!(n.isRejected(e)&&0===n.matchPrefix(e,"a=bundle-only").length||a.rejected)){var p=n.getIceParameters(e,i),h=n.getDtlsParameters(e,i);s&&(h.role="server"),r.usingBundle&&0!==t||(r._gather(a.mid,t),"new"===d.state&&d.start(c,p,s?"controlling":"controlled"),"new"===l.state&&l.start(h));var f=o(u,m);r._transceive(a,f.codecs.length>0,!1)}}))}return r._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?r._updateSignalingState("have-local-offer"):r._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(r){var l=this;if(-1===["offer","answer"].indexOf(r.type))return Promise.reject(c("TypeError",'Unsupported type "'+r.type+'"'));if(!a("setRemoteDescription",r.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+r.type+" in state "+l.signalingState));var u={};l.remoteStreams.forEach((function(e){u[e.id]=e}));var m=[],p=n.splitSections(r.sdp),h=p.shift(),f=n.matchPrefix(h,"a=ice-lite").length>0,v=n.matchPrefix(h,"a=group:BUNDLE ").length>0;l.usingBundle=v;var g=n.matchPrefix(h,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(a,c){var d=n.splitLines(a),p=n.getKind(a),g=n.isRejected(a)&&0===n.matchPrefix(a,"a=bundle-only").length,b=d[0].substr(2).split(" ")[2],C=n.getDirection(a,h),y=n.parseMsid(a),S=n.getMid(a)||n.generateIdentifier();if(g||"application"===p&&("DTLS/SCTP"===b||"UDP/DTLS/SCTP"===b))l.transceivers[c]={mid:S,kind:p,protocol:b,rejected:!0};else{var w,T,_,R,E,k,P,D,x;!g&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(p,!0));var O,M,I=n.parseRtpParameters(a);g||(O=n.getIceParameters(a,h),(M=n.getDtlsParameters(a,h)).role="client"),P=n.parseRtpEncodingParameters(a);var L=n.parseRtcpParameters(a),A=n.matchPrefix(a,"a=end-of-candidates",h).length>0,j=n.matchPrefix(a,"a=candidate:").map((function(e){return n.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===r.type||"answer"===r.type)&&!g&&v&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==r.type||g)"answer"!==r.type||g||(T=(w=l.transceivers[c]).iceGatherer,_=w.iceTransport,R=w.dtlsTransport,E=w.rtpReceiver,k=w.sendEncodingParameters,D=w.localCapabilities,l.transceivers[c].recvEncodingParameters=P,l.transceivers[c].remoteCapabilities=I,l.transceivers[c].rtcpParameters=L,j.length&&"new"===_.state&&(!f&&!A||v&&0!==c?j.forEach((function(e){s(w.iceTransport,e)})):_.setRemoteCandidates(j)),v&&0!==c||("new"===_.state&&_.start(T,O,"controlling"),"new"===R.state&&R.start(M)),!o(w.localCapabilities,w.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&w.sendEncodingParameters[0].rtx&&delete w.sendEncodingParameters[0].rtx,l._transceive(w,"sendrecv"===C||"recvonly"===C,"sendrecv"===C||"sendonly"===C),!E||"sendrecv"!==C&&"sendonly"!==C?delete w.rtpReceiver:(x=E.track,y?(u[y.stream]||(u[y.stream]=new e.MediaStream),i(x,u[y.stream]),m.push([x,E,u[y.stream]])):(u.default||(u.default=new e.MediaStream),i(x,u.default),m.push([x,E,u.default]))));else{(w=l.transceivers[c]||l._createTransceiver(p)).mid=S,w.iceGatherer||(w.iceGatherer=l._createIceGatherer(c,v)),j.length&&"new"===w.iceTransport.state&&(!A||v&&0!==c?j.forEach((function(e){s(w.iceTransport,e)})):w.iceTransport.setRemoteCandidates(j)),D=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(D.codecs=D.codecs.filter((function(e){return"rtx"!==e.name}))),k=w.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var $,U=!1;"sendrecv"===C||"sendonly"===C?(U=!w.rtpReceiver,E=w.rtpReceiver||new e.RTCRtpReceiver(w.dtlsTransport,p),U&&(x=E.track,y&&"-"===y.stream||(y?(u[y.stream]||(u[y.stream]=new e.MediaStream,Object.defineProperty(u[y.stream],"id",{get:function(){return y.stream}})),Object.defineProperty(x,"id",{get:function(){return y.track}}),$=u[y.stream]):(u.default||(u.default=new e.MediaStream),$=u.default)),$&&(i(x,$),w.associatedRemoteMediaStreams.push($)),m.push([x,E,$]))):w.rtpReceiver&&w.rtpReceiver.track&&(w.associatedRemoteMediaStreams.forEach((function(t){var i=t.getTracks().find((function(e){return e.id===w.rtpReceiver.track.id}));i&&function(t,i){i.removeTrack(t),i.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(i,t)})),w.associatedRemoteMediaStreams=[]),w.localCapabilities=D,w.remoteCapabilities=I,w.rtpReceiver=E,w.rtcpParameters=L,w.sendEncodingParameters=k,w.recvEncodingParameters=P,l._transceive(l.transceivers[c],!1,U)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===r.type?"active":"passive"),l._remoteDescription={type:r.type,sdp:r.sdp},"offer"===r.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(u).forEach((function(t){var i=u[t];if(i.getTracks().length){if(-1===l.remoteStreams.indexOf(i)){l.remoteStreams.push(i);var n=new Event("addstream");n.stream=i,e.setTimeout((function(){l._dispatchEvent("addstream",n)}))}m.forEach((function(e){var t=e[0],n=e[1];i.id===e[2].id&&d(l,t,n,[i])}))}})),m.forEach((function(e){e[2]||d(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var i=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",i)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var i=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",i)}},l.prototype.createOffer=function(){var i=this;if(i._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=i.transceivers.filter((function(e){return"audio"===e.kind})).length,a=i.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(o=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(i.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));o>0||a>0;)o>0&&(i._createTransceiver("audio"),o--),a>0&&(i._createTransceiver("video"),a--);var d=n.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.transceivers.forEach((function(r,o){var a=r.track,s=r.kind,c=r.mid||n.generateIdentifier();r.mid=c,r.iceGatherer||(r.iceGatherer=i._createIceGatherer(o,i.usingBundle));var d=e.RTCRtpSender.getCapabilities(s);t<15019&&(d.codecs=d.codecs.filter((function(e){return"rtx"!==e.name}))),d.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),d.headerExtensions.forEach((function(e){(r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=r.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),r.wantReceive&&(r.rtpReceiver=new e.RTCRtpReceiver(r.dtlsTransport,s)),r.localCapabilities=d,r.sendEncodingParameters=l})),"max-compat"!==i._config.bundlePolicy&&(d+="a=group:BUNDLE "+i.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",i.transceivers.forEach((function(e,t){d+=r(e,e.localCapabilities,"offer",e.stream,i._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===i.iceGatheringState||0!==t&&i.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+="a="+n.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(l)},l.prototype.createAnswer=function(){var i=this;if(i._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==i.signalingState&&"have-local-pranswer"!==i.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+i.signalingState));var a=n.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.usingBundle&&(a+="a=group:BUNDLE "+i.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var s=n.getMediaSections(i._remoteDescription.sdp).length;i.transceivers.forEach((function(e,n){if(!(n+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var d=o(e.localCapabilities,e.remoteCapabilities);!d.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=r(e,d,"answer",e.stream,i._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var d=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(d)},l.prototype.addIceCandidate=function(e){var t,i=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(r,o){if(!i._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<i.transceivers.length;d++)if(i.transceivers[d].mid===e.sdpMid){a=d;break}var l=i.transceivers[a];if(!l)return o(c("OperationError","Can not add ICE candidate"));if(l.rejected)return r();var u=Object.keys(e.candidate).length>0?n.parseCandidate(e.candidate):{};if("tcp"===u.protocol&&(0===u.port||9===u.port))return r();if(u.component&&1!==u.component)return r();if((0===a||a>0&&l.iceTransport!==i.transceivers[0].iceTransport)&&!s(l.iceTransport,u))return o(c("OperationError","Can not add ICE candidate"));var m=e.candidate.trim();0===m.indexOf("a=")&&(m=m.substr(2)),(t=n.getMediaSections(i._remoteDescription.sdp))[a]+="a="+(u.type?m:"end-of-candidates")+"\r\n",i._remoteDescription.sdp=n.getDescription(i._remoteDescription.sdp)+t.join("")}else for(var p=0;p<i.transceivers.length&&(i.transceivers[p].rejected||(i.transceivers[p].iceTransport.addRemoteCandidate({}),(t=n.getMediaSections(i._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",i._remoteDescription.sdp=n.getDescription(i._remoteDescription.sdp)+t.join(""),!i.usingBundle));p++);r()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var i=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?i=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(i=e.rtpReceiver)})),!i)throw c("InvalidAccessError","Invalid selector.");return i.getStats()}var n=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&n.push(e[t].getStats())}))})),Promise.all(n).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var i=e[t];if(i&&i.prototype&&i.prototype.getStats){var n=i.prototype.getStats;i.prototype.getStats=function(){return n.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(i){var n;e[i].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(n=e[i]).type]||n.type,t.set(i,e[i])})),t}))}}}));var u=["createOffer","createAnswer"];return u.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(u=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},{sdp:17}],17:[function(e,t,i){"use strict";var n={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};n.localCName=n.generateIdentifier(),n.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},n.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},n.getDescription=function(e){var t=n.splitSections(e);return t&&t[0]},n.getMediaSections=function(e){var t=n.splitSections(e);return t.shift(),t},n.matchPrefix=function(e,t){return n.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},n.parseCandidate=function(e){for(var t,i={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":i.relatedAddress=t[n+1];break;case"rport":i.relatedPort=parseInt(t[n+1],10);break;case"tcptype":i.tcpType=t[n+1];break;case"ufrag":i.ufrag=t[n+1],i.usernameFragment=t[n+1];break;default:i[t[n]]=t[n+1]}return i},n.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},n.parseIceOptions=function(e){return e.substr(14).split(" ")},n.parseRtpMap=function(e){var t=e.substr(9).split(" "),i={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),i.name=t[0],i.clockRate=parseInt(t[1],10),i.channels=3===t.length?parseInt(t[2],10):1,i.numChannels=i.channels,i},n.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var i=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==i?"/"+i:"")+"\r\n"},n.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},n.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},n.parseFmtp=function(e){for(var t,i={},n=e.substr(e.indexOf(" ")+1).split(";"),r=0;r<n.length;r++)i[(t=n[r].trim().split("="))[0].trim()]=t[1];return i},n.writeFmtp=function(e){var t="",i=e.payloadType;if(void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+i+" "+n.join(";")+"\r\n"}return t},n.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},n.writeRtcpFb=function(e){var t="",i=e.payloadType;return void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+i+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},n.parseSsrcMedia=function(e){var t=e.indexOf(" "),i={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(i.attribute=e.substr(t+1,n-t-1),i.value=e.substr(n+1)):i.attribute=e.substr(t+1),i},n.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},n.getMid=function(e){var t=n.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},n.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},n.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:n.matchPrefix(e+t,"a=fingerprint:").map(n.parseFingerprint)}},n.writeDtlsParameters=function(e,t){var i="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){i+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),i},n.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},n.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===s(e.keyParams)?n.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},n.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},n.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},n.getCryptoParameters=function(e,t){return n.matchPrefix(e+t,"a=crypto:").map(n.parseCryptoLine)},n.getIceParameters=function(e,t){var i=n.matchPrefix(e+t,"a=ice-ufrag:")[0],r=n.matchPrefix(e+t,"a=ice-pwd:")[0];return i&&r?{usernameFragment:i.substr(12),password:r.substr(10)}:null},n.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},n.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=n.splitLines(e)[0].split(" "),r=3;r<i.length;r++){var o=i[r],a=n.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=n.parseRtpMap(a),c=n.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?n.parseFmtp(c[0]):{},s.rtcpFeedback=n.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(n.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return n.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(n.parseExtmap(e))})),t},n.writeRtpDescription=function(e,t){var i="";i+="m="+e+" ",i+=t.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){i+=n.writeRtpMap(e),i+=n.writeFmtp(e),i+=n.writeRtcpFb(e)}));var r=0;return t.codecs.forEach((function(e){e.maxptime>r&&(r=e.maxptime)})),r>0&&(i+="a=maxptime:"+r+"\r\n"),i+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){i+=n.writeExtmap(e)})),i},n.parseRtpEncodingParameters=function(e){var t,i=[],r=n.parseRtpParameters(e),o=-1!==r.fecMechanisms.indexOf("RED"),a=-1!==r.fecMechanisms.indexOf("ULPFEC"),s=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,d=n.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));d.length>0&&d[0].length>1&&d[0][0]===c&&(t=d[0][1]),r.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var n={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(n.rtx={ssrc:t}),i.push(n),o&&((n=JSON.parse(JSON.stringify(n))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},i.push(n))}})),0===i.length&&c&&i.push({ssrc:c});var l=n.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,i.forEach((function(e){e.maxBitrate=l}))),i},n.parseRtcpParameters=function(e){var t={},i=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];i&&(t.cname=i.value,t.ssrc=i.ssrc);var r=n.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=r.length>0,t.compound=0===r.length;var o=n.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},n.parseMsid=function(e){var t,i=n.matchPrefix(e,"a=msid:");if(1===i.length)return{stream:(t=i[0].substr(7).split(" "))[0],track:t[1]};var r=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return r.length>0?{stream:(t=r[0].value.split(" "))[0],track:t[1]}:void 0},n.parseSctpDescription=function(e){var t,i=n.parseMLine(e),r=n.matchPrefix(e,"a=max-message-size:");r.length>0&&(t=parseInt(r[0].substr(19),10)),isNaN(t)&&(t=65536);var o=n.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:i.fmt,maxMessageSize:t};if(n.matchPrefix(e,"a=sctpmap:").length>0){var a=n.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},n.writeSctpDescription=function(e,t){var i=[];return i="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&i.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),i.join("")},n.generateSessionId=function(){return Math.random().toString().substr(2,21)},n.writeSessionBoilerplate=function(e,t,i){var r=void 0!==t?t:2;return"v=0\r\no="+(i||"thisisadapterortc")+" "+(e||n.generateSessionId())+" "+r+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},n.writeMediaSection=function(e,t,i,r){var o=n.writeRtpDescription(e.kind,t);if(o+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+r.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),o},n.getDirection=function(e,t){for(var i=n.splitLines(e),r=0;r<i.length;r++)switch(i[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[r].substr(2)}return t?n.getDirection(t):"sendrecv"},n.getKind=function(e){return n.splitLines(e)[0].split(" ")[0].substr(2)},n.isRejected=function(e){return"0"===e.split(" ",2)[1]},n.parseMLine=function(e){var t=n.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},n.parseOLine=function(e){var t=n.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},n.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=n.splitLines(e),i=0;i<t.length;i++)if(t[i].length<2||"="!==t[i].charAt(1))return!1;return!0},"object"===s(t)&&(t.exports=n)},{}]},{},[1])(1)},"object"===s(t)&&void 0!==e?e.exports=a():(r=[],void 0===(o="function"==typeof(n=a)?n.apply(t,r):n)||(e.exports=o))}}]);
//# sourceMappingURL=live-as-guest.js.map?id=98d22e41a3f60c828e3e