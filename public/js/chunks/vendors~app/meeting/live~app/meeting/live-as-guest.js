(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{K2Rr:function(e,t,n){"undefined"!=typeof self&&self,e.exports=function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7);t.default={name:"flipCountdown",props:{deadline:{type:String},stop:{type:Boolean},showDays:{type:Boolean,required:!1,default:!0},showHours:{type:Boolean,required:!1,default:!0},showMinutes:{type:Boolean,required:!1,default:!0},showSeconds:{type:Boolean,required:!1,default:!0},labels:{type:Object,required:!1,default:function(){return{days:"Days",hours:"Hours",minutes:"Minutes",seconds:"Seconds"}}}},data:function(){var e=i();return{now:Math.trunc((new Date).getTime()/1e3),date:null,interval:null,diff:0,show:!1,timeData:[{current:0,previous:0,label:this.labels.days,elementId:"flip-card-days-"+e,show:this.showDays},{current:0,previous:0,label:this.labels.hours,elementId:"flip-card-hours-"+e,show:this.showHours},{current:0,previous:0,label:this.labels.minutes,elementId:"flip-card-minutes-"+e,show:this.showMinutes},{current:0,previous:0,label:this.labels.seconds,elementId:"flip-card-seconds-"+e,show:this.showSeconds}]}},created:function(){var e=this;if(!this.deadline)throw new Error("Missing props 'deadline'");var t=this.deadline;if(this.date=Math.trunc(Date.parse(t.replace(/-/g,"/"))/1e3),!this.date)throw new Error("Invalid props value, correct the 'deadline'");this.interval=setInterval((function(){e.now=Math.trunc((new Date).getTime()/1e3)}),1e3)},mounted:function(){0!==this.diff&&(this.show=!0)},computed:{seconds:function(){return Math.trunc(this.diff)%60},minutes:function(){return Math.trunc(this.diff/60)%60},hours:function(){return Math.trunc(this.diff/60/60)%24},days:function(){return Math.trunc(this.diff/60/60/24)}},watch:{deadline:function(e,t){var n=this.deadline;if(this.date=Math.trunc(Date.parse(n.replace(/-/g,"/"))/1e3),!this.date)throw new Error("Invalid props value, correct the 'deadline'")},now:function(e){this.diff=this.date-this.now,this.diff<=0||this.stop?(this.diff=0,this.updateTime(3,0)):this.updateAllCards()},diff:function(e){0===e&&(this.$emit("timeElapsed"),this.updateAllCards())}},filters:{twoDigits:function(e){return e.toString().length<=1?"0"+e.toString():e.toString()}},methods:{updateAllCards:function(){this.updateTime(0,this.days),this.updateTime(1,this.hours),this.updateTime(2,this.minutes),this.updateTime(3,this.seconds)},updateTime:function(e,t){if(!(e>=this.timeData.length||void 0===t)){window.requestAnimationFrame&&(this.frame=requestAnimationFrame(this.updateTime.bind(this)));var n=this.timeData[e],i=t<0?0:t,o=document.querySelector("#"+n.elementId);if(i!==n.current&&(n.previous=n.current,n.current=i,o&&(o.classList.remove("flip"),o.offsetWidth,o.classList.add("flip")),0===e)){var r=o.querySelectorAll("span b");if(r){var a=!0,s=!1,c=void 0;try{for(var d,u=r[Symbol.iterator]();!(a=(d=u.next()).done);a=!0){var f=d.value,l=f.classList[0];if(t/1e3>=1){if(!l.includes("-4digits")){var p=l+"-4digits";f.classList.add(p),f.classList.remove(l)}}else if(l.includes("-4digits")){var m=l.replace("-4digits","");f.classList.add(m),f.classList.remove(l)}}}catch(e){s=!0,c=e}finally{try{!a&&u.return&&u.return()}finally{if(s)throw c}}}}}}},beforeDestroy:function(){window.cancelAnimationFrame&&cancelAnimationFrame(this.frame)},destroyed:function(){clearInterval(null)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);var a=n(10),s=n(11),c=function(e){n(2)},d=Object(s.a)(o.a,a.a,a.b,!1,c,"data-v-78efe7f6",null);t.default=d.exports},function(e,t,n){var i=n(3);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals),(0,n(5).default)("6cb6a1b9",i,!0,{})},function(e,t,n){(e.exports=n(4)(!1)).push([e.i,"\n.flip-clock[data-v-78efe7f6] {\n  text-align: center;\n  perspective: 600px;\n  margin: 0 auto;\n}\n.flip-clock *[data-v-78efe7f6],\n.flip-clock *[data-v-78efe7f6]:before,\n.flip-clock *[data-v-78efe7f6]:after {\n  box-sizing: border-box;\n}\n.flip-clock__piece[data-v-78efe7f6] {\n  display: inline-block;\n  margin: 0 0.2vw;\n}\n@media (min-width: 1000px) {\n.flip-clock__piece[data-v-78efe7f6] {\n    margin: 0 5px;\n}\n}\n.flip-clock__slot[data-v-78efe7f6] {\n  font-size: 1rem;\n  line-height: 1.5;\n  display: block;\n}\n.flip-card[data-v-78efe7f6] {\n  display: block;\n  position: relative;\n  padding-bottom: 0.72em;\n  font-size: 2.25rem;\n  line-height: 0.95;\n}\n@media (min-width: 1000px) {\n.flip-clock__slot[data-v-78efe7f6] {\n    font-size: 1.2rem;\n}\n.flip-card[data-v-78efe7f6] {\n    font-size: 3rem;\n}\n}\n.flip-card__top[data-v-78efe7f6],\n.flip-card__bottom[data-v-78efe7f6],\n.flip-card__back-bottom[data-v-78efe7f6],\n.flip-card__back[data-v-78efe7f6]::before,\n.flip-card__back[data-v-78efe7f6]::after {\n  display: block;\n  color: #cca900;\n  background: #222;\n  padding: 0.23em 0.15em 0.4em;\n  border-radius: 0.15em 0.15em 0 0;\n  backface-visibility: hidden;\n  -webkit-backface-visibility: hidden;\n  transform-style: preserve-3d;\n  width: 2.1em;\n  height: 0.72em;\n}\n.flip-card__top-4digits[data-v-78efe7f6],\n.flip-card__bottom-4digits[data-v-78efe7f6],\n.flip-card__back-bottom-4digits[data-v-78efe7f6],\n.flip-card__back-4digits[data-v-78efe7f6]::before,\n.flip-card__back-4digits[data-v-78efe7f6]::after {\n  display: block;\n  color: #cca900;\n  background: #222;\n  padding: 0.23em 0.15em 0.4em;\n  border-radius: 0.15em 0.15em 0 0;\n  backface-visibility: hidden;\n  -webkit-backface-visibility: hidden;\n  transform-style: preserve-3d;\n  width: 2.65em;\n  height: 0.72em;\n}\n.flip-card__bottom[data-v-78efe7f6],\n.flip-card__back-bottom[data-v-78efe7f6],\n.flip-card__bottom-4digits[data-v-78efe7f6],\n.flip-card__back-bottom-4digits[data-v-78efe7f6] {\n  color: #ffdc00;\n  position: absolute;\n  top: 50%;\n  left: 0;\n  border-top: solid 1px #000;\n  background: #393939;\n  border-radius: 0 0 0.15em 0.15em;\n  pointer-events: none;\n  overflow: hidden;\n  z-index: 2;\n}\n.flip-card__back-bottom[data-v-78efe7f6],\n.flip-card__back-bottom-4digits[data-v-78efe7f6] {\n  z-index: 1;\n}\n.flip-card__bottom[data-v-78efe7f6]::after,\n.flip-card__back-bottom[data-v-78efe7f6]::after,\n.flip-card__bottom-4digits[data-v-78efe7f6]::after,\n.flip-card__back-bottom-4digits[data-v-78efe7f6]::after {\n  display: block;\n  margin-top: -0.72em;\n}\n.flip-card__back[data-v-78efe7f6]::before,\n.flip-card__bottom[data-v-78efe7f6]::after,\n.flip-card__back-bottom[data-v-78efe7f6]::after,\n.flip-card__back-4digits[data-v-78efe7f6]::before,\n.flip-card__bottom-4digits[data-v-78efe7f6]::after,\n.flip-card__back-bottom-4digits[data-v-78efe7f6]::after {\n  content: attr(data-value);\n}\n.flip-card__back[data-v-78efe7f6],\n.flip-card__back-4digits[data-v-78efe7f6] {\n  position: absolute;\n  top: 0;\n  height: 100%;\n  left: 0%;\n  pointer-events: none;\n}\n.flip-card__back[data-v-78efe7f6]::before,\n.flip-card__back-4digits[data-v-78efe7f6]::before {\n  position: relative;\n  overflow: hidden;\n  z-index: -1;\n}\n.flip .flip-card__back[data-v-78efe7f6]::before,\n.flip .flip-card__back-4digits[data-v-78efe7f6]::before {\n  z-index: 1;\n  animation: flipTop-data-v-78efe7f6 0.3s cubic-bezier(0.37, 0.01, 0.94, 0.35);\n  animation-fill-mode: both;\n  transform-origin: center bottom;\n}\n.flip .flip-card__bottom[data-v-78efe7f6],\n.flip .flip-card__bottom-4digits[data-v-78efe7f6] {\n  transform-origin: center top;\n  animation-fill-mode: both;\n  animation: flipBottom-data-v-78efe7f6 0.6s cubic-bezier(0.15, 0.45, 0.28, 1);\n}\n@keyframes flipTop-data-v-78efe7f6 {\n0% {\n    transform: rotateX(0deg);\n    z-index: 2;\n}\n0%,\n  99% {\n    opacity: 1;\n}\n100% {\n    transform: rotateX(-90deg);\n    opacity: 0;\n}\n}\n@keyframes flipBottom-data-v-78efe7f6 {\n0%,\n  50% {\n    z-index: -1;\n    transform: rotateX(90deg);\n    opacity: 0;\n}\n51% {\n    opacity: 1;\n}\n100% {\n    opacity: 1;\n    transform: rotateX(0deg);\n    z-index: 5;\n}\n}\n",""])},function(e,t,n){"use strict";function i(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var o=function(e){return"/*# ".concat("sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(e)))))," */")}(i);return[n].concat(i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot).concat(e," */")}))).concat([o]).join("\n")}return[n].join("\n")}e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=i(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},o=0;o<this.length;o++){var r=this[o][0];null!=r&&(i[r]=!0)}for(var a=0;a<e.length;a++){var s=e[a];null!=s[0]&&i[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="(".concat(s[2],") and (").concat(n,")")),t.push(s))}},t}},function(e,t,n){"use strict";function i(e){for(var t=0;t<e.length;t++){var n=e[t],i=u[n.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](n.parts[o]);for(;o<n.parts.length;o++)i.parts.push(r(n.parts[o]));i.parts.length>n.parts.length&&(i.parts.length=n.parts.length)}else{var a=[];for(o=0;o<n.parts.length;o++)a.push(r(n.parts[o]));u[n.id]={id:n.id,refs:1,parts:a}}}}function o(){var e=document.createElement("style");return e.type="text/css",f.appendChild(e),e}function r(e){var t,n,i=document.querySelector("style["+g+'~="'+e.id+'"]');if(i){if(m)return v;i.parentNode.removeChild(i)}if(w){var r=p++;i=l||(l=o()),t=a.bind(null,i,r,!1),n=a.bind(null,i,r,!0)}else i=o(),t=s.bind(null,i),n=function(){i.parentNode.removeChild(i)};return t(e),function(i){if(i){if(i.css===e.css&&i.media===e.media&&i.sourceMap===e.sourceMap)return;t(e=i)}else n()}}function a(e,t,n,i){var o=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=b(t,o);else{var r=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(r,a[t]):e.appendChild(r)}}function s(e,t){var n=t.css,i=t.media,o=t.sourceMap;if(i&&e.setAttribute("media",i),h.ssrId&&e.setAttribute(g,t.id),o&&(n+="\n/*# sourceURL="+o.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o){m=n,h=o||{};var r=Object(c.a)(e,t);return i(r),function(t){for(var n=[],o=0;o<r.length;o++){var a=r[o];(s=u[a.id]).refs--,n.push(s)}for(t?i(r=Object(c.a)(e,t)):r=[],o=0;o<n.length;o++){var s;if(0===(s=n[o]).refs){for(var d=0;d<s.parts.length;d++)s.parts[d]();delete u[s.id]}}}};var c=n(6),d="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!d)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var u={},f=d&&(document.head||document.getElementsByTagName("head")[0]),l=null,p=0,m=!1,v=function(){},h=null,g="data-vue-ssr-id",w="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase()),b=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){"use strict";t.a=function(e,t){for(var n=[],i={},o=0;o<t.length;o++){var r=t[o],a=r[0],s={id:e+":"+o,css:r[1],media:r[2],sourceMap:r[3]};i[a]?i[a].parts.push(s):n.push(i[a]={id:a,parts:[s]})}return n}},function(e,t,n){var i=n(8),o=n(9);e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[r+s]=a[s];return t||o(a)}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,o=n;return[o[e[i++]],o[e[i++]],o[e[i++]],o[e[i++]],"-",o[e[i++]],o[e[i++]],"-",o[e[i++]],o[e[i++]],"-",o[e[i++]],o[e[i++]],"-",o[e[i++]],o[e[i++]],o[e[i++]],o[e[i++]],o[e[i++]],o[e[i++]]].join("")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container flip-clock"},[e._l(e.timeData,(function(t){return[n("span",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"data.show"}],key:t.label,staticClass:"flip-clock__piece",attrs:{id:t.elementId}},[n("span",{staticClass:"flip-clock__card flip-card"},[n("b",{staticClass:"flip-card__top"},[e._v(e._s(e._f("twoDigits")(t.current)))]),e._v(" "),n("b",{staticClass:"flip-card__bottom",attrs:{"data-value":e._f("twoDigits")(t.current)}}),e._v(" "),n("b",{staticClass:"flip-card__back",attrs:{"data-value":e._f("twoDigits")(t.previous)}}),e._v(" "),n("b",{staticClass:"flip-card__back-bottom",attrs:{"data-value":e._f("twoDigits")(t.previous)}})]),e._v(" "),n("span",{staticClass:"flip-clock__slot"},[e._v(e._s(t.label))])])]}))],2)},o=[]},function(e,t,n){"use strict";t.a=function(e,t,n,i,o,r,a,s){var c=typeof(e=e||{}).default;"object"!==c&&"function"!==c||(e=e.default);var d,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),i&&(u.functional=!0),r&&(u._scopeId=r),a?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=d):o&&(d=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),d)if(u.functional){u._injectStyles=d;var f=u.render;u.render=function(e,t){return d.call(t),f(e,t)}}else{var l=u.beforeCreate;u.beforeCreate=l?[].concat(l,d):[d]}return{exports:e,options:u}}}])},l4sq:function(e,t,n){"use strict";(function(e){!function(){function t(){this.readAsArrayBuffer=function(e,t){var n=t.earlyCallback;delete t.earlyCallback,function(e,t){t=t||function(e){postMessage(e)};var n=e.file;n.uuid||(n.uuid=(100*Math.random()).toString().replace(/\./g,""));var i=e.chunkSize||15e3;e.extra&&e.extra.chunkSize&&(i=e.extra.chunkSize);var o,r=0,a=i,s=Math.floor(Math.min(1e8,a)/i)*i,c=Math.ceil(n.size/i);n.maxChunks=c;var d=0,u=[];t({currentPosition:d,uuid:n.uuid,maxChunks:c,size:n.size,name:n.name,type:n.type,lastModifiedDate:(n.lastModifiedDate||new Date).toString(),start:!0});var f,l=new FileReader;l.onloadend=function(e){e.target.readyState==FileReader.DONE&&function(e,r,a){o=Math.ceil(r.byteLength/i);for(var s=0;s<o;s++){var f=s*i;u[d]=r.slice(f,Math.min(f+i,r.byteLength)),t({uuid:n.uuid,buffer:u[d],currentPosition:d,maxChunks:c,size:n.size,name:n.name,lastModifiedDate:(n.lastModifiedDate||new Date).toString(),type:n.type}),d++}d==c&&!0,a()}(n.name,e.target.result,(function(){(++r+1)*s<n.size?(f=n.slice(r*s,(r+1)*s),l.readAsArrayBuffer(f)):r*s<n.size?(f=n.slice(r*s,n.size),l.readAsArrayBuffer(f)):(n.url=URL.createObjectURL(n),t({currentPosition:d,uuid:n.uuid,maxChunks:c,size:n.size,name:n.name,lastModifiedDate:(n.lastModifiedDate||new Date).toString(),url:URL.createObjectURL(n),type:n.type,end:!0}))}))},d+=1,f=n.slice(r*s,(r+1)*s),l.readAsArrayBuffer(f)}(t,(function(i){e.chunks[i.uuid]||(e.chunks[i.uuid]={currentPosition:-1}),t.extra=t.extra||{userid:0},i.userid=t.userid||t.extra.userid||0,i.extra=t.extra,e.chunks[i.uuid][i.currentPosition]=i,i.end&&n&&(n(i.uuid),n=null),i.maxChunks>200&&200==i.currentPosition&&n&&(n(i.uuid),n=null)}))}}function n(e){var t=this;t.chunks={},t.chunksWaiters={},t.receive=function n(i,o){if(i.uuid){if(i.start&&!t.chunks[i.uuid]&&(t.chunks[i.uuid]={},e.onBegin&&e.onBegin(i)),!i.end&&i.buffer&&(t.chunks[i.uuid][i.currentPosition]=i.buffer),i.end){var r=t.chunks[i.uuid],a=[];Object.keys(r).forEach((function(e,t){a.push(r[e])}));var s=new Blob(a,{type:i.type});(s=function(e,t){e||(e={});if(!t)return e;for(var n in t)try{e[n]=t[n]}catch(e){}return e}(s,i)).url=URL.createObjectURL(s),s.uuid=i.uuid,s.size||console.error("Something went wrong. Blob Size is 0."),e.onEnd&&e.onEnd(s),delete t.chunks[i.uuid],delete t.chunksWaiters[i.uuid]}i.buffer&&e.onProgress&&e.onProgress(i),i.end||(o(i),t.chunksWaiters[i.uuid]=function(){setTimeout((function e(){i.buffer&&t.chunks[i.uuid]&&(i.currentPosition==i.maxChunks||t.chunks[i.uuid][i.currentPosition]||(o(i),setTimeout(e,5e3)))}),5e3)},t.chunksWaiters[i.uuid]())}else e.convertToObject(i,(function(e){n(e)}))}}var i={ConvertToArrayBuffer:function(e,t){m.pack(e,(function(e){t(e.buffer)}))},ConvertToObject:function(e,t){m.unpack(e,t)}};var o=Uint8Array.BYTES_PER_ELEMENT,r=Uint16Array.BYTES_PER_ELEMENT,a=Uint32Array.BYTES_PER_ELEMENT,s={NULL:0,UNDEFINED:1,STRING:2,NUMBER:3,BOOLEAN:4,ARRAY:5,OBJECT:6,INT8ARRAY:7,INT16ARRAY:8,INT32ARRAY:9,UINT8ARRAY:10,UINT16ARRAY:11,UINT32ARRAY:12,FLOAT32ARRAY:13,FLOAT64ARRAY:14,ARRAYBUFFER:15,BLOB:16,FILE:16,BUFFER:17},c=[null,null,"Uint16","Float64","Uint8",null,null,"Int8","Int16","Int32","Uint8","Uint16","Uint32","Float32","Float64","Uint8","Uint8","Uint8"],d=function(e){var t=0,n=0,i=0,d=new ArrayBuffer(e[0].byte_length+e[0].header_size),u=new DataView(d);for(n=0;n<e.length;n++){e[n].header_size;var f=e[n].type,l=e[n].length,p=e[n].value,m=e[n].byte_length,v=c[f],h=null===v?0:window[v+"Array"].BYTES_PER_ELEMENT;switch(f===s.BUFFER?u.setUint8(t,s.BLOB,!1):u.setUint8(t,f,!1),t+=o,f!==s.ARRAY&&f!==s.OBJECT||(u.setUint16(t,l,!1),t+=r),u.setUint32(t,m,!1),t+=a,f){case s.NULL:case s.UNDEFINED:break;case s.STRING:for(i=0;i<l;i++,t+=h)u.setUint16(t,p.charCodeAt(i),!1);break;case s.NUMBER:case s.BOOLEAN:0,u["set"+v](t,p,!1),t+=h;break;case s.INT8ARRAY:case s.INT16ARRAY:case s.INT32ARRAY:case s.UINT8ARRAY:case s.UINT16ARRAY:case s.UINT32ARRAY:case s.FLOAT32ARRAY:case s.FLOAT64ARRAY:new Uint8Array(u.buffer,t,m).set(new Uint8Array(p.buffer)),t+=m;break;case s.ARRAYBUFFER:case s.BUFFER:new Uint8Array(u.buffer,t,m).set(new Uint8Array(p)),t+=m;break;case s.BLOB:case s.ARRAY:case s.OBJECT:break;default:throw"TypeError: Unexpected type found."}0}return u},u=function(t,n){var i,d,f,l,p,m=0;i=t.getUint8(n,!1),n+=o,i!==s.ARRAY&&i!==s.OBJECT||(d=t.getUint16(n,!1),n+=r),f=t.getUint32(n,!1),n+=a;var v=c[i],h=null===v?0:window[v+"Array"].BYTES_PER_ELEMENT;switch(i){case s.NULL:case s.UNDEFINED:0,l=null;break;case s.STRING:d=f/h;var g=[];for(m=0;m<d;m++){var w=t.getUint16(n,!1);n+=h,g.push(String.fromCharCode(w))}l=g.join("");break;case s.NUMBER:l=t.getFloat64(n,!1),n+=h;break;case s.BOOLEAN:l=1===t.getUint8(n,!1),n+=h;break;case s.INT8ARRAY:case s.INT16ARRAY:case s.INT32ARRAY:case s.UINT8ARRAY:case s.UINT16ARRAY:case s.UINT32ARRAY:case s.FLOAT32ARRAY:case s.FLOAT64ARRAY:case s.ARRAYBUFFER:p=t.buffer.slice(n,n+f),n+=f,l=i===s.ARRAYBUFFER?p:new window[v+"Array"](p);break;case s.BLOB:if(window.Blob){var b=u(t,n),y=u(t,b.cursor);n=y.cursor,l=new Blob([y.value],{type:b.value})}else p=t.buffer.slice(n,n+f),n+=f,l=new e(p);break;case s.ARRAY:for(l=[],m=0;m<d;m++)n=(p=u(t,n)).cursor,l.push(p.value);break;case s.OBJECT:for(l={},m=0;m<d;m++){var S=u(t,n),C=u(t,S.cursor);n=C.cursor,l[S.value]=C.value}break;default:throw"TypeError: Type not supported."}return{value:l,cursor:n}},f=function(e,t){for(var n=e.length,i=[],o=0,r=0,a=0;a<e.length;a++)!function(a){l(e[a],(function(e){if(i[a]=e,r+=e[0].header_size+e[0].byte_length,++o===n){for(var s=[],c=0;c<i.length;c++)s=s.concat(i[c]);t(s,r)}}))}(a)},l=function(t,n){var i,d,u=o+a,l=0,p=0,m=t;switch(d=function(t){var n=void 0;if(void 0===t)n=s.UNDEFINED;else if(null===t)n=s.NULL;else{var i=t.constructor.name,o=t.constructor.toString().match(/\w+/g)[1];if(void 0!==i&&void 0!==s[i.toUpperCase()])n=s[i.toUpperCase()];else if(void 0!==o&&void 0!==s[o.toUpperCase()])n=s[o.toUpperCase()];else switch(typeof t){case"string":n=s.STRING;break;case"number":n=s.NUMBER;break;case"boolean":n=s.BOOLEAN;break;case"object":t instanceof Array?n=s.ARRAY:t instanceof Int8Array?n=s.INT8ARRAY:t instanceof Int16Array?n=s.INT16ARRAY:t instanceof Int32Array?n=s.INT32ARRAY:t instanceof Uint8Array?n=s.UINT8ARRAY:t instanceof Uint16Array?n=s.UINT16ARRAY:t instanceof Uint32Array?n=s.UINT32ARRAY:t instanceof Float32Array?n=s.FLOAT32ARRAY:t instanceof Float64Array?n=s.FLOAT64ARRAY:t instanceof ArrayBuffer?n=s.ARRAYBUFFER:t instanceof Blob?n=s.BLOB:t instanceof e?n=s.BUFFER:t instanceof Object&&(n=s.OBJECT)}}return n}(t),i=null==c[d]?0:window[c[d]+"Array"].BYTES_PER_ELEMENT,d){case s.UNDEFINED:case s.NULL:break;case s.NUMBER:case s.BOOLEAN:l=i;break;case s.STRING:l+=(p=t.length)*i;break;case s.INT8ARRAY:case s.INT16ARRAY:case s.INT32ARRAY:case s.UINT8ARRAY:case s.UINT16ARRAY:case s.UINT32ARRAY:case s.FLOAT32ARRAY:case s.FLOAT64ARRAY:l+=(p=t.length)*i;break;case s.ARRAY:return void f(t,(function(e,i){n([{type:d,length:t.length,header_size:u+r,byte_length:i,value:null}].concat(e))}));case s.OBJECT:var v=[];for(var h in t)t.hasOwnProperty(h)&&(v.push(h),v.push(t[h]),p++);return void f(v,(function(e,t){n([{type:d,length:p,header_size:u+r,byte_length:t,value:null}].concat(e))}));case s.ARRAYBUFFER:l+=t.byteLength;break;case s.BLOB:var g=t.type,w=new FileReader;return w.onload=function(e){f([g,e.target.result],(function(e,t){n([{type:d,length:p,header_size:u,byte_length:t,value:null}].concat(e))}))},w.onerror=function(e){throw"FileReader Error: "+e},void w.readAsArrayBuffer(t);case s.BUFFER:l+=t.length;break;default:throw'TypeError: Type "'+t.constructor.name+'" not supported.'}n([{type:d,length:p,header_size:u,byte_length:l,value:m}].concat([]))},p=function(e,t){var n=e instanceof DataView?e:new DataView(e);return u(n,0).value};var m={pack:function(e,t){try{0,l(e,(function(e){t(d(e))}))}catch(e){throw e}},unpack:function(e,t){try{0;var n=p(e);0,t(n)}catch(e){throw e}}};window.FileConverter=i,window.FileSelector=function(){var e=this,t=function(){};function n(n,i,o){n=n||function(){};var r=document.createElement("input");r.type="file",i&&(r.multiple=!0),o&&(r.webkitdirectory=!0),r.accept=e.accept,r.onclick=function(){r.clickStarted=!0},document.body.onfocus=function(){setTimeout((function(){r.clickStarted&&(r.clickStarted=!1,r.value||t())}),500)},r.onchange=function(){if(i){if(!r.files.length)return void console.error("No file selected.");var e=[];return Array.from(r.files).forEach((function(t){t.url=t.webkitRelativePath,e.push(t)})),void n(e)}r.files[0]?(n(r.files[0]),r.parentNode.removeChild(r)):console.error("No file selected.")},r.style.display="none",(document.body||document.documentElement).appendChild(r),function(e){if("function"==typeof e.click)return void e.click();if("function"==typeof e.change)return void e.change();if(void 0!==document.createEvent("Event")){if("function"==typeof(t=document.createEvent("Event")).initEvent&&"function"==typeof e.dispatchEvent)return t.initEvent("click",!0,!0),void e.dispatchEvent(t)}var t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});e.dispatchEvent(t)}(r)}e.selectSingleFile=function(e,i){i&&(t=i),n(e)},e.selectMultipleFiles=function(e,i){i&&(t=i),n(e,!0)},e.selectDirectory=function(e,i){i&&(t=i),n(e,!0,!0)},e.accept="*.*"},window.FileBufferReader=function(){var e=this,o=new t;e.chunks={},e.users={},e.readAsArrayBuffer=function(t,n,i){var r={file:t,earlyCallback:function(e){n(a(e,{currentPosition:-1}))},extra:i||{userid:0}};t.extra&&Object.keys(t.extra).length&&Object.keys(t.extra).forEach((function(e){r.extra[e]=t.extra[e]})),o.readAsArrayBuffer(e,r)},e.getNextChunk=function(t,n,i){var o;void 0!==t.currentPosition&&(o=t.currentPosition,t=t.uuid);var r=e.chunks[t];if(r){void 0!==i?(e.users[i+""]||(e.users[i+""]={fileUUID:t,userid:i,currentPosition:-1}),void 0!==o&&(e.users[i+""].currentPosition=o),e.users[i+""].currentPosition++,o=e.users[i+""].currentPosition):(void 0!==o&&(e.chunks[t].currentPosition=o),e.chunks[t].currentPosition++,o=e.chunks[t].currentPosition);var s=r[o];if(!s)return delete e.chunks[t],void e.convertToArrayBuffer({chunkMissing:!0,currentPosition:o,uuid:t},n);s=a(s),void 0!==i&&(s.remoteUserId=i+""),s.start&&e.onBegin(s),s.end&&e.onEnd(s),e.onProgress(s),e.convertToArrayBuffer(s,(function(e){s.currentPosition!=s.maxChunks?n(e,!1):n(e,!0)}))}};var r=new n(e);function a(e,t){if(null==e||"object"!=typeof e)return e;if(e.constructor!=Object&&e.constructor!=Array)return e;if(e.constructor==Date||e.constructor==RegExp||e.constructor==Function||e.constructor==String||e.constructor==Number||e.constructor==Boolean)return new e.constructor(e);for(var n in t=t||new e.constructor,e)t[n]=void 0===t[n]?a(e[n],null):t[n];return t}e.addChunk=function(t,n){t&&r.receive(t,(function(t){e.convertToArrayBuffer({readyForNextChunk:!0,currentPosition:t.currentPosition,uuid:t.uuid},n)}))},e.chunkMissing=function(e){delete r.chunks[e.uuid],delete r.chunksWaiters[e.uuid]},e.onBegin=function(){},e.onEnd=function(){},e.onProgress=function(){},e.convertToObject=i.ConvertToObject,e.convertToArrayBuffer=i.ConvertToArrayBuffer,e.setMultipleUsers=function(){}}}()}).call(this,n("tjlA").Buffer)},x18S:function(e,t,n){var i;i=function(){return function(e,t,n){function i(n,r){if(!t[n]){if(!e[n]){if(o)return o(n,!0);throw new Error("Cannot find module '"+n+"'")}var a=t[n]={exports:{}};e[n][0].call(a.exports,(function(t){var o=e[n][1][t];return i(o||t)}),a,a.exports)}return t[n].exports}for(var o=!1,r=0;r<n.length;r++)i(n[r]);return i}({1:[function(e,t,n){var i,o=e("wildemitter");"undefined"!=typeof window&&(i=window.AudioContext||window.webkitAudioContext);var r=null;t.exports=function(e,t){var n=new o;if(!i)return n;var a,s,c,d=(t=t||{}).smoothing||.1,u=t.interval||50,f=t.threshold,l=t.play,p=t.history||10,m=!0;r=t.audioContext||r||new i,(c=r.createAnalyser()).fftSize=512,c.smoothingTimeConstant=d,s=new Float32Array(c.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(a=r.createMediaElementSource(e),void 0===l&&(l=!0),f=f||-50):(a=r.createMediaStreamSource(e),f=f||-50),a.connect(c),l&&c.connect(r.destination),n.speaking=!1,n.suspend=function(){return r.suspend()},n.resume=function(){return r.resume()},Object.defineProperty(n,"state",{get:function(){return r.state}}),r.onstatechange=function(){n.emit("state_change",r.state)},n.setThreshold=function(e){f=e},n.setInterval=function(e){u=e},n.stop=function(){m=!1,n.emit("volume_change",-100,f),n.speaking&&(n.speaking=!1,n.emit("stopped_speaking")),c.disconnect(),a.disconnect()},n.speakingHistory=[];for(var v=0;v<p;v++)n.speakingHistory.push(0);var h=function(){setTimeout((function(){if(m){var e=function(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var i=4,o=t.length;i<o;i++)t[i]>n&&t[i]<0&&(n=t[i]);return n}(c,s);n.emit("volume_change",e,f);var t=0;if(e>f&&!n.speaking){for(var i=n.speakingHistory.length-3;i<n.speakingHistory.length;i++)t+=n.speakingHistory[i];t>=2&&(n.speaking=!0,n.emit("speaking"))}else if(e<f&&n.speaking){for(i=0;i<n.speakingHistory.length;i++)t+=n.speakingHistory[i];0==t&&(n.speaking=!1,n.emit("stopped_speaking"))}n.speakingHistory.shift(),n.speakingHistory.push(0+(e>f)),h()}}),u)};return h(),n}},{wildemitter:2}],2:[function(e,t,n){function i(){}t.exports=i,i.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var i=3===arguments.length,o=i?arguments[1]:void 0,r=i?arguments[2]:arguments[1];return r._groupName=o,(this.callbacks[e]=this.callbacks[e]||[]).push(r),this},t.once=function(e,t,n){var i=this,o=3===arguments.length,r=o?arguments[1]:void 0,a=o?arguments[2]:arguments[1];function s(){i.off(e,s),a.apply(this,arguments)}return this.on(e,r,s),this},t.releaseGroup=function(e){var t,n,i,o;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(n=0,i=(o=this.callbacks[t]).length;n<i;n++)o[n]._groupName===e&&(o.splice(n,1),n--,i--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,i=this.callbacks[e];return i?1===arguments.length?(delete this.callbacks[e],this):(n=i.indexOf(t),i.splice(n,1),0===i.length&&delete this.callbacks[e],this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,i,o=[].slice.call(arguments,1),r=this.callbacks[e],a=this.getWildcardCallbacks(e);if(r)for(t=0,n=(i=r.slice()).length;t<n&&i[t];++t)i[t].apply(this,o);if(a)for(n=a.length,t=0,n=(i=a.slice()).length;t<n&&i[t];++t)i[t].apply(this,[e].concat(o));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,i=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(i=i.concat(this.callbacks[t]));return i}},i.mixin(i)},{}]},{},[1])(1)},"function"==typeof bootstrap?bootstrap("hark",i):e.exports=i()},zWga:function(e,t,n){"use strict";(function(n,i){var o,r=function(r,a){var s;function c(e,t){function n(e){return!e.audio&&!e.video&&!e.screen&&e.data}var i="";i+="?userid="+e.userid,i+="&sessionid="+e.sessionid,i+="&msgEvent="+e.socketMessageEvent,i+="&socketCustomEvent="+e.socketCustomEvent,i+="&autoCloseEntireSession="+!!e.autoCloseEntireSession,!0===e.session.broadcast&&(i+="&oneToMany=true"),i+="&maxParticipantsAllowed="+e.maxParticipantsAllowed,e.enableScalableBroadcast&&(i+="&enableScalableBroadcast=true",i+="&maxRelayLimitPerUser="+(e.maxRelayLimitPerUser||2)),i+="&extra="+JSON.stringify(e.extra||{}),e.socketCustomParameters&&(i+=e.socketCustomParameters);try{io.sockets={}}catch(e){}if(e.socketURL||(e.socketURL="/"),"/"!=e.socketURL.substr(e.socketURL.length-1,1))throw'"socketURL" MUST end with a slash.';e.enableLogs&&("/"==e.socketURL?console.info("socket.io url is: ",location.origin+"/"):console.info("socket.io url is: ",e.socketURL));try{e.socket=io(e.socketURL+i)}catch(t){e.socket=io.connect(e.socketURL+i,e.socketOptions)}var o=e.multiPeersHandler;function r(t,n){e.peersBackup[t]||(e.peersBackup[t]={userid:t,extra:{}}),e.peersBackup[t].extra=n}e.socket.on("extra-data-updated",(function(t,n){e.peers[t]&&(e.peers[t].extra=n,e.onExtraDataUpdated({userid:t,extra:n}),r(t,n))})),e.socket.on(e.socketMessageEvent,(function t(i){if(i.remoteUserId==e.userid)if(e.peers[i.sender]&&e.peers[i.sender].extra!=i.message.extra&&(e.peers[i.sender].extra=i.extra,e.onExtraDataUpdated({userid:i.sender,extra:i.extra}),r(i.sender,i.extra)),i.message.streamSyncNeeded&&e.peers[i.sender]){var a=e.streamEvents[i.message.streamid];if(!a||!a.stream)return;var s=i.message.action;if("ended"===s||"inactive"===s||"stream-removed"===s)return e.peersBackup[a.userid]&&(a.extra=e.peersBackup[a.userid].extra),void e.onstreamended(a);var c="both"!=i.message.type?i.message.type:null;"function"==typeof a.stream[s]&&a.stream[s](c)}else if("dropPeerConnection"!==i.message){if(i.message.allParticipants)return-1===i.message.allParticipants.indexOf(i.sender)&&i.message.allParticipants.push(i.sender),void i.message.allParticipants.forEach((function(t){o[e.peers[t]?"renegotiatePeer":"createNewPeer"](t,{localPeerSdpConstraints:{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:n(e.session)})}));if(i.message.newParticipant){if(i.message.newParticipant==e.userid)return;if(e.peers[i.message.newParticipant])return;o.createNewPeer(i.message.newParticipant,i.message.userPreferences||{localPeerSdpConstraints:{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:n(e.session)})}else if(i.message.readyForOffer&&(e.attachStreams.length&&(e.waitingForLocalMedia=!1),e.waitingForLocalMedia))setTimeout((function(){t(i)}),1);else if(i.message.newParticipationRequest&&i.sender!==e.userid){e.peers[i.sender]&&e.deletePeer(i.sender);var d={extra:i.extra||{},localPeerSdpConstraints:i.message.remotePeerSdpConstraints||{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:i.message.localPeerSdpConstraints||{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:void 0!==i.message.isOneWay?i.message.isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:void 0!==i.message.isDataOnly?i.message.isDataOnly:n(e.session),dontGetRemoteStream:void 0!==i.message.isOneWay?i.message.isOneWay:!!e.session.oneway||"one-way"===e.direction,dontAttachLocalStream:!!i.message.dontGetRemoteStream,connectionDescription:i,successCallback:function(){}};e.onNewParticipant(i.sender,d)}else{if(i.message.changedUUID&&e.peers[i.message.oldUUID]&&(e.peers[i.message.newUUID]=e.peers[i.message.oldUUID],delete e.peers[i.message.oldUUID]),i.message.userLeft)return o.onUserLeft(i.sender),void(i.message.autoCloseEntireSession&&e.leave());o.addNegotiatedMessage(i.message,i.sender)}}else e.deletePeer(i.sender)}));var a=!1;e.socket.resetProps=function(){a=!1},e.socket.on("connect",(function(){a||(a=!0,e.enableLogs&&console.info("socket.io connection is opened."),setTimeout((function(){e.socket.emit("extra-data-updated",e.extra)}),1e3),t&&t(e.socket))})),e.socket.on("disconnect",(function(t){e.onSocketDisconnect(t)})),e.socket.on("error",(function(t){e.onSocketError(t)})),e.socket.on("user-disconnected",(function(t){t!==e.userid&&(e.onUserStatusChanged({userid:t,status:"offline",extra:e.peers[t]&&e.peers[t].extra||{}}),e.deletePeer(t))})),e.socket.on("user-connected",(function(t){t!==e.userid&&e.onUserStatusChanged({userid:t,status:"online",extra:e.peers[t]&&e.peers[t].extra||{}})})),e.socket.on("closed-entire-session",(function(t,n){e.leave(),e.onEntireSessionClosed({sessionid:t,userid:t,extra:n})})),e.socket.on("userid-already-taken",(function(t,n){e.onUserIdAlreadyTaken(t,n)})),e.socket.on("logs",(function(t){e.enableLogs&&console.debug("server-logs",t)})),e.socket.on("number-of-broadcast-viewers-updated",(function(t){e.onNumberOfBroadcastViewersUpdated(t)})),e.socket.on("set-isInitiator-true",(function(t){t==e.sessionid&&(e.isInitiator=!0)}))}function d(e){var t=this,n=["getAllParticipants","getLength","selectFirst","streams","send","forEach"];function i(){e.fbr=new FileBufferReader,e.fbr.onProgress=function(t){e.onFileProgress(t)},e.fbr.onBegin=function(t){e.onFileStart(t)},e.fbr.onEnd=function(t){e.onFileEnd(t)}}e.peers={getLength:function(){var e=0;for(var t in this)-1==n.indexOf(t)&&e++;return e},selectFirst:function(){var e;for(var t in this)-1==n.indexOf(t)&&(e=this[t]);return e},getAllParticipants:function(e){var t=[];for(var i in this)-1==n.indexOf(i)&&i!=e&&t.push(i);return t},forEach:function(t){this.getAllParticipants().forEach((function(n){t(e.peers[n])}))},send:function(n,i){var o=this;if(!g(n.size)&&!g(n.type)){if(e.enableFileSharing)return void t.shareFile(n,i);"string"!=typeof n&&(n=JSON.stringify(n))}if("text"===n.type||n instanceof ArrayBuffer||n instanceof DataView){if("text"===n.type&&(n=JSON.stringify(n)),i){var r=e.peers[i];if(r)return r.channels.length?void r.channels.forEach((function(e){e.send(n)})):(e.peers[i].createDataChannel(),e.renegotiate(i),void setTimeout((function(){o.send(n,i)}),3e3))}this.getAllParticipants().forEach((function(t){if(!o[t].channels.length)return e.peers[t].createDataChannel(),e.renegotiate(t),void setTimeout((function(){o[t].channels.forEach((function(e){e.send(n)}))}),3e3);o[t].channels.forEach((function(e){e.send(n)}))}))}else I.send({text:n,channel:this,connection:e,remoteUserId:i})}},this.uuid=e.userid,this.getLocalConfig=function(n,o,r){return r||(r={}),{streamsToShare:r.streamsToShare||{},rtcMultiConnection:e,connectionDescription:r.connectionDescription,userid:o,localPeerSdpConstraints:r.localPeerSdpConstraints,remotePeerSdpConstraints:r.remotePeerSdpConstraints,dontGetRemoteStream:!!r.dontGetRemoteStream,dontAttachLocalStream:!!r.dontAttachLocalStream,renegotiatingPeer:!!r.renegotiatingPeer,peerRef:r.peerRef,channels:r.channels||[],onLocalSdp:function(e){t.onNegotiationNeeded(e,o)},onLocalCandidate:function(n){(n=P.processCandidates(e,n))&&t.onNegotiationNeeded(n,o)},remoteSdp:n,onDataChannelMessage:function(n){if(!e.fbr&&e.enableFileSharing&&i(),"string"!=typeof n&&e.enableFileSharing){var r=this;n instanceof ArrayBuffer||n instanceof DataView?e.fbr.convertToObject(n,(function(e){r.onDataChannelMessage(e)})):n.readyForNextChunk?e.fbr.getNextChunk(n,(function(t,n){e.peers[o].channels.forEach((function(e){e.send(t)}))}),o):n.chunkMissing?e.fbr.chunkMissing(n):e.fbr.addChunk(n,(function(t){e.peers[o].peer.channel.send(t)}))}else t.onDataChannelMessage(n,o)},onDataChannelError:function(e){t.onDataChannelError(e,o)},onDataChannelOpened:function(e){t.onDataChannelOpened(e,o)},onDataChannelClosed:function(e){t.onDataChannelClosed(e,o)},onRemoteStream:function(n){e.peers[o]&&e.peers[o].streams.push(n),t.onGettingRemoteMedia(n,o)},onRemoteStreamRemoved:function(e){t.onRemovingRemoteMedia(e,o)},onPeerStateChanged:function(e){t.onPeerStateChanged(e),"new"===e.iceConnectionState&&t.onNegotiationStarted(o,e),"connected"===e.iceConnectionState&&t.onNegotiationCompleted(o,e),-1!==e.iceConnectionState.search(/closed|failed/gi)&&(t.onUserLeft(o),t.disconnectWith(o))}}},this.createNewPeer=function(t,n){if(!(e.maxParticipantsAllowed<=e.getAllParticipants().length)){if(n=n||{},e.isInitiator&&e.session.audio&&"two-way"===e.session.audio&&!n.streamsToShare&&(n.isOneWay=!1,n.isDataOnly=!1,n.session=e.session),!n.isOneWay&&!n.isDataOnly)return n.isOneWay=!0,void this.onNegotiationNeeded({enableMedia:!0,userPreferences:n},t);n=e.setUserPreferences(n,t);var i=this.getLocalConfig(null,t,n);e.peers[t]=new O(i)}},this.createAnsweringPeer=function(t,n,i){i=e.setUserPreferences(i||{},n);var o=this.getLocalConfig(t,n,i);e.peers[n]=new O(o)},this.renegotiatePeer=function(t,n,i){if(e.peers[t]){n||(n={}),n.renegotiatingPeer=!0,n.peerRef=e.peers[t].peer,n.channels=e.peers[t].channels;var o=this.getLocalConfig(i,t,n);e.peers[t]=new O(o)}else e.enableLogs&&console.error("Peer ("+t+") does not exist. Renegotiation skipped.")},this.replaceTrack=function(t,n,i){if(!e.peers[n])throw"This peer ("+n+") does not exist.";var o=e.peers[n].peer;o.getSenders&&"function"==typeof o.getSenders&&o.getSenders().length?o.getSenders().forEach((function(o){i&&"video"===o.track.kind&&(e.peers[n].peer.lastVideoTrack=o.track,o.replaceTrack(t)),i||"audio"!==o.track.kind||(e.peers[n].peer.lastAudioTrack=o.track,o.replaceTrack(t))})):(console.warn("RTPSender.replaceTrack is NOT supported."),this.renegotiatePeer(n))},this.onNegotiationNeeded=function(e,t){},this.addNegotiatedMessage=function(n,i){if(n.type&&n.sdp)return"answer"==n.type&&e.peers[i]&&e.peers[i].addRemoteSdp(n),"offer"==n.type&&(n.renegotiatingPeer?this.renegotiatePeer(i,null,n):this.createAnsweringPeer(n,i)),void(e.enableLogs&&console.log("Remote peer's sdp:",n.sdp));if(n.candidate)return e.peers[i]&&e.peers[i].addRemoteCandidate(n),void(e.enableLogs&&console.log("Remote peer's candidate pairs:",n.candidate));if(n.enableMedia){e.session=n.userPreferences.session||e.session,e.session.oneway&&e.attachStreams.length&&(e.attachStreams=[]),n.userPreferences.isDataOnly&&e.attachStreams.length&&(e.attachStreams.length=[]);var o={};e.attachStreams.forEach((function(e){o[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}})),n.userPreferences.streamsToShare=o,t.onNegotiationNeeded({readyForOffer:!0,userPreferences:n.userPreferences},i)}n.readyForOffer&&e.onReadyForOffer(i,n.userPreferences)},this.onGettingRemoteMedia=function(e,t){},this.onRemovingRemoteMedia=function(e,t){},this.onGettingLocalMedia=function(e){},this.onLocalMediaError=function(t,n){e.onMediaError(t,n)},this.shareFile=function(t,n){i(),e.fbr.readAsArrayBuffer(t,(function(t){var i=e.getAllParticipants();n&&(i=[n]),i.forEach((function(n){e.fbr.getNextChunk(t,(function(t){e.peers[n].channels.forEach((function(e){e.send(t)}))}),n)}))}),{userid:e.userid,chunkSize:"Firefox"===DetectRTC.browser.name?15e3:e.chunkSize||0})};var o=new N(e);this.onDataChannelMessage=function(t,n){o.receive(JSON.parse(t),n,e.peers[n]?e.peers[n].extra:{})},this.onDataChannelClosed=function(t,n){t.userid=n,t.extra=e.peers[n]?e.peers[n].extra:{},e.onclose(t)},this.onDataChannelError=function(t,n){t.userid=n,event.extra=e.peers[n]?e.peers[n].extra:{},e.onerror(t)},this.onDataChannelOpened=function(t,n){e.peers[n].channels.length?e.peers[n].channels=[t]:(e.peers[n].channels.push(t),e.onopen({userid:n,extra:e.peers[n]?e.peers[n].extra:{},channel:t}))},this.onPeerStateChanged=function(t){e.onPeerStateChanged(t)},this.onNegotiationStarted=function(e,t){},this.onNegotiationCompleted=function(e,t){},this.getRemoteStreams=function(t){return t=t||e.peers.getAllParticipants()[0],e.peers[t]?e.peers[t].streams:[]}}function u(e,t,n){if("undefined"!=typeof CustomEvent){var i=new CustomEvent(t,{arguments:n,__exposedProps__:n});e.dispatchEvent(i)}}function f(e,t){t.stream&&t.stream&&t.stream.addEventListener&&(t.stream.addEventListener("mute",(function(n){(n=e.streamEvents[t.streamid]).session={audio:"audio"===n.muteType,video:"video"===n.muteType},e.onmute(n)}),!1),t.stream.addEventListener("unmute",(function(n){(n=e.streamEvents[t.streamid]).session={audio:"audio"===n.unmuteType,video:"video"===n.unmuteType},e.onunmute(n)}),!1))}function l(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var e=window.crypto.getRandomValues(new Uint32Array(3)),t="",n=0,i=e.length;n<i;n++)t+=e[n].toString(36);return t}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function p(e,t,n){if(n.autoCreateMediaElement){var i=!1;y(e,"video").length||e.isVideo||e.isScreen||(i=!0),"Firefox"===DetectRTC.browser.name&&(n.session.video||n.session.screen)&&(i=!1);var o=document.createElement(i?"audio":"video");if(o.srcObject=e,o.setAttribute("autoplay",!0),o.setAttribute("playsinline",!0),o.setAttribute("controls",!0),o.setAttribute("muted",!1),o.setAttribute("volume",1),"Firefox"===DetectRTC.browser.name){var r="ended";"oninactive"in o&&(r="inactive"),o.addEventListener(r,(function(){if(currentUserMediaRequest.remove(e.idInstance),"local"===e.type){r="ended","oninactive"in e&&(r="inactive"),L.onSyncNeeded(e.streamid,r),n.attachStreams.forEach((function(t,i){e.streamid===t.streamid&&delete n.attachStreams[i]}));var t=[];n.attachStreams.forEach((function(e){e&&t.push(e)})),n.attachStreams=t;var i=n.streamEvents[e.streamid];if(i)return void n.onstreamended(i);this.parentNode&&this.parentNode.removeChild(this)}}),!1)}var a=o.play();if(void 0!==a){var s=!1;setTimeout((function(){s||(s=!0,t(o))}),1e3),a.then((function(){s||(s=!0,t(o))})).catch((function(e){s||(s=!0,t(o))}))}else t(o)}else t({})}function m(e,t){window.removeEventListener(e,t),window.addEventListener(e,t,!1)}function v(e){var t=[];return e.forEach((function(e){e&&t.push(e)})),t}function h(e){return!e.audio&&!e.video&&!e.screen&&e.data}function g(e){return void 0===e}(s=void 0!==n?n:null)&&"undefined"==typeof window&&void 0!==n&&(n.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},n.console||(n.console={}),void 0===n.console.debug&&(n.console.debug=n.console.info=n.console.error=n.console.log=n.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(s.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""}};return e},document.addEventListener=document.removeEventListener=s.addEventListener=s.removeEventListener=function(){},s.HTMLVideoElement=s.HTMLMediaElement=function(){}),"undefined"==typeof io&&(s.io=function(){return{on:function(e,t){t=t||function(){},"connect"===e&&t()},emit:function(e,t,n){n=n||function(){},"open-room"!==e&&"join-room"!==e||n(!0,t.sessionid,null)}}}),"undefined"==typeof location&&(s.location={protocol:"file:",href:"",hash:"",origin:"self"}),"undefined"==typeof screen&&(s.screen={width:0,height:0}),"undefined"==typeof URL&&(s.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),s.window=n),function(){var r="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if(C="object"==typeof i&&"object"==typeof i.versions&&i.versions.node&&!i.browser){var a=i.versions.node.toString().replace("v","");r="Nodejs/"+a+" (NodeOS) AppleWebKit/"+a+" (KHTML, like Gecko) Nodejs/"+a+" Nodejs/"+a}!function(e){"undefined"==typeof window&&("undefined"==typeof window&&void 0!==n&&(n.navigator={userAgent:r,getUserMedia:function(){}},e.window=n),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}))}(void 0!==n?n:window);var s=window.navigator;void 0!==s?(void 0!==s.webkitGetUserMedia&&(s.getUserMedia=s.webkitGetUserMedia),void 0!==s.mozGetUserMedia&&(s.getUserMedia=s.mozGetUserMedia)):s={getUserMedia:function(){},userAgent:r};var c=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(s.userAgent||""),d=!(-1===s.userAgent.indexOf("Edge")||!s.msSaveOrOpenBlob&&!s.msSaveBlob),u=!!window.opera||s.userAgent.indexOf(" OPR/")>=0,f=void 0!==window.InstallTrigger,l=/^((?!chrome|android).)*safari/i.test(s.userAgent),p=!!window.chrome&&!u,m="undefined"!=typeof document&&!!document.documentMode&&!d;function v(e,t){var n=0,i=!1,o=window.setInterval((function(){e()&&(window.clearInterval(o),t(i)),n++>50&&(window.clearInterval(o),t(i=!0))}),10)}var h={Android:function(){return s.userAgent.match(/Android/i)},BlackBerry:function(){return s.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return s.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return s.userAgent.match(/Opera Mini/i)},Windows:function(){return s.userAgent.match(/IEMobile/i)},any:function(){return h.Android()||h.BlackBerry()||h.iOS()||h.Opera()||h.Windows()},getOsName:function(){var e="Unknown OS";return h.Android()&&(e="Android"),h.BlackBerry()&&(e="BlackBerry"),h.iOS()&&(e="iOS"),h.Opera()&&(e="Opera Mini"),h.Windows()&&(e="Windows"),e}};var g="Unknown OS",w="Unknown OS Version";var b,y,S=function(){for(var e,t=s.appVersion,n=s.userAgent,i="-",o=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],r=0;e=o[r];r++)if(e.r.test(n)){i=e.s;break}var a="-";switch(/Windows/.test(i)&&(/Windows (.*)/.test(i)&&(a=/Windows (.*)/.exec(i)[1]),i="Windows"),i){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(n)&&(a=/Mac OS X (10[\.\_\d]+)/.exec(n)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(n)&&(a=/Android ([\.\_\d]+)/.exec(n)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(n)&&(a=(a=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))[1]+"."+a[2]+"."+(0|a[3]))}return{osName:i,osVersion:a}}();S&&S.osName&&"-"!=S.osName?(g=S.osName,w=S.osVersion):h.any()&&"Android"==(g=h.getOsName())&&(w=!!(y=(b=(b||s.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&y[1]);var C="object"==typeof i&&"object"==typeof i.versions&&i.versions.node;"Unknown OS"===g&&C&&(g="Nodejs",w=i.versions.node.toString().replace("v",""));var k=!1,R=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!k&&e in document.createElement("canvas")&&(k=!0),!R&&e in document.createElement("video")&&(R=!0))}));var T=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,A=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,E=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/;var O=[],M=[],P=[],U=[];s.mediaDevices&&s.mediaDevices.enumerateDevices&&(s.enumerateDevices=function(e){var t=s.mediaDevices.enumerateDevices();t&&t.then?s.mediaDevices.enumerateDevices().then(e).catch((function(){e([])})):e([])});var D=!1;(void 0!==x&&"getSources"in x||s.mediaDevices&&s.mediaDevices.enumerateDevices)&&(D=!0);var L=!1,N=!1,I=!1,_=!1,B=!1;function F(e){if(D)if(!s.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(s.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!s.enumerateDevices&&s.enumerateDevices&&(s.enumerateDevices=s.enumerateDevices.bind(s)),s.enumerateDevices){O=[],M=[],P=[],U=[],L=!1,N=!1,I=!1,_=!1,B=!1;var t={};s.enumerateDevices((function(n){n.forEach((function(e){var n={};for(var i in e)try{"function"!=typeof e[i]&&(n[i]=e[i])}catch(e){}t[n.deviceId+n.label+n.kind]||("audio"===n.kind&&(n.kind="audioinput"),"video"===n.kind&&(n.kind="videoinput"),n.deviceId||(n.deviceId=n.id),n.id||(n.id=n.deviceId),n.label?("videoinput"!==n.kind||B||(B=!0),"audioinput"!==n.kind||_||(_=!0)):(n.isCustomLabel=!0,"videoinput"===n.kind?n.label="Camera "+(U.length+1):"audioinput"===n.kind?n.label="Microphone "+(M.length+1):"audiooutput"===n.kind?n.label="Speaker "+(P.length+1):n.label="Please invoke getUserMedia once.",void 0!==W&&W.browser.isChrome&&W.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(n.label="HTTPs is required to get label of this "+n.kind+" device.")),"audioinput"===n.kind&&(L=!0,-1===M.indexOf(n)&&M.push(n)),"audiooutput"===n.kind&&(N=!0,-1===P.indexOf(n)&&P.push(n)),"videoinput"===n.kind&&(I=!0,-1===U.indexOf(n)&&U.push(n)),O.push(n),t[n.deviceId+n.label+n.kind]=n)})),void 0!==W&&(W.MediaDevices=O,W.hasMicrophone=L,W.hasSpeakers=N,W.hasWebcam=I,W.isWebsiteHasWebcamPermissions=B,W.isWebsiteHasMicrophonePermissions=_,W.audioInputDevices=M,W.audioOutputDevices=P,W.videoInputDevices=U),e&&e()}))}else e&&e();else e&&e()}var W=window.DetectRTC||{};W.browser=function(){s.appVersion;var e,t,n,i=s.userAgent,o=s.appName,r=""+parseFloat(s.appVersion),a=parseInt(s.appVersion,10);if(l&&!p&&-1!==i.indexOf("CriOS")&&(l=!1,p=!0),u){o="Opera";try{a=(r=s.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){r="0.0.0.0",a=0}}else m?((t=i.indexOf("rv:"))>0?r=i.substring(t+3):(t=i.indexOf("MSIE"),r=i.substring(t+5)),o="IE"):p?(t=i.indexOf("Chrome"),o="Chrome",r=i.substring(t+7)):l?(t=i.indexOf("Safari"),o="Safari",r=i.substring(t+7),-1!==(t=i.indexOf("Version"))&&(r=i.substring(t+8)),-1!==s.userAgent.indexOf("Version/")&&(r=s.userAgent.split("Version/")[1].split(" ")[0])):f?(t=i.indexOf("Firefox"),o="Firefox",r=i.substring(t+8)):(e=i.lastIndexOf(" ")+1)<(t=i.lastIndexOf("/"))&&(o=i.substring(e,t),r=i.substring(t+1),o.toLowerCase()===o.toUpperCase()&&(o=s.appName));return d&&(o="Edge",r=s.userAgent.split("Edge/")[1]),-1!==(n=r.search(/[; \)]/))&&(r=r.substring(0,n)),a=parseInt(""+r,10),isNaN(a)&&(r=""+parseFloat(s.appVersion),a=parseInt(s.appVersion,10)),{fullVersion:r,version:a,name:o,isPrivateBrowsing:!1}}(),function(e){var t;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,(function(){t=!1}),(function(e){t=!0}));else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var n;try{(n=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){t=!0}void 0===t&&v((function(){return"done"===n.readyState}),(function(e){e||(t=!n.result)}))}else if(function(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var n=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);return!!(n&&parseInt(n[1],10)>=10)}(window.navigator.userAgent)){t=!1;try{window.indexedDB||(t=!0)}catch(e){t=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){t=!0}void 0===t&&(t=!1,window.localStorage.removeItem("test"))}}catch(e){t=!1}v((function(){return void 0!==t}),(function(n){e(t)}))}((function(e){W.browser.isPrivateBrowsing=!!e})),W.browser["is"+W.browser.name]=!0,W.osName=g,W.osVersion=w;"object"==typeof i&&"object"==typeof i.versions&&i.versions["node-webkit"];var V=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach((function(e){V||e in window&&(V=!0)})),W.isWebRTCSupported=V,W.isORTCSupported="undefined"!=typeof RTCIceGatherer;var q=!1;((W.browser.isChrome&&W.browser.version>=35||W.browser.isFirefox&&W.browser.version>=34||W.browser.isEdge&&W.browser.version>=17||"Android"===W.osName&&W.browser.isChrome)&&(q=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||""))||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(W.browser.isChrome||W.browser.isEdge||W.browser.isOpera)||W.browser.isFirefox)&&(q=!1);W.isScreenCapturingSupported=q;var j={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach((function(e){j.isSupported||e in window&&(j.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(j.isCreateMediaStreamSourceSupported=!0))})),W.isAudioContextSupported=j.isSupported,W.isCreateMediaStreamSourceSupported=j.isCreateMediaStreamSourceSupported;var G=!1;W.browser.isChrome&&W.browser.version>31&&(G=!0),W.isRtpDataChannelsSupported=G;var z=!1;(W.browser.isFirefox&&W.browser.version>28||W.browser.isChrome&&W.browser.version>25||W.browser.isOpera&&W.browser.version>=11)&&(z=!0),W.isSctpDataChannelsSupported=z,W.isMobileDevice=c;var Y=!1;(s.getUserMedia||s.mediaDevices&&s.mediaDevices.getUserMedia)&&(Y=!0),W.browser.isChrome&&W.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(Y="Requires HTTPs"),"Nodejs"===W.osName&&(Y=!1),W.isGetUserMediaSupported=Y;var H,J,X,K="";screen.width&&(K+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));W.displayResolution=K,W.displayAspectRatio=(H=screen.width,J=screen.height,X=function e(t,n){return 0==n?t:e(n,t%n)}(H,J),H/X/(J/X)).toFixed(2),W.isCanvasSupportsStreamCapturing=k,W.isVideoSupportsStreamCapturing=R,"Chrome"==W.browser.name&&W.browser.version>=53&&(W.isCanvasSupportsStreamCapturing||(W.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),W.isVideoSupportsStreamCapturing||(W.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),W.DetectLocalIPAddress=function(e,t){if(W.isWebRTCSupported){var n=!0,i=!0;!function(e,t){if("undefined"==typeof document||"function"!=typeof document.getElementById)return;var n={},i=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!i){var o=document.getElementById("iframe");if(!o)return;var r=o.contentWindow;i=r.RTCPeerConnection||r.mozRTCPeerConnection||r.webkitRTCPeerConnection}if(!i)return;var a=null;"Chrome"===W.browser&&W.browser.version<58&&(a={optional:[{RtpDataChannels:!0}]});var s=new i({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},a);t&&(s.addStream?s.addStream(t):s.addTrack&&t.getTracks()[0]&&s.addTrack(t.getTracks()[0],t));function c(t){if(t){var i=A.exec(t);if(i){var o=i[1],r=t.match(T);void 0===n[o]&&e(o,r,!0),n[o]=!0}}else e()}if(s.onicecandidate=function(e){e.candidate&&e.candidate.candidate?c(e.candidate.candidate):c()},!t)try{s.createDataChannel("sctp",{})}catch(e){}W.isPromisesSupported?s.createOffer().then((function(e){s.setLocalDescription(e).then(d)})):s.createOffer((function(e){s.setLocalDescription(e,d,(function(){}))}),(function(){}));function d(){s.localDescription.sdp.split("\n").forEach((function(e){e&&0===e.indexOf("a=candidate:")&&c(e)}))}}((function(t){t?t.match(T)?e("Local: "+t,n=!1,i):t.match(E)?e("Public: "+t,n,i=!1):e("Public: "+t,n,i):e()}),t)}},W.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,W.isWebSocketsBlocked=!W.isWebSocketsSupported,"Nodejs"===W.osName&&(W.isWebSocketsSupported=!0,W.isWebSocketsBlocked=!1),W.checkWebSocketsSupport=function(e){e=e||function(){};try{var t,n=new WebSocket("wss://echo.websocket.org:443/");n.onopen=function(){W.isWebSocketsBlocked=!1,t=(new Date).getTime(),n.send("ping")},n.onmessage=function(){W.WebsocketLatency=(new Date).getTime()-t+"ms",e(),n.close(),n=null},n.onerror=function(){W.isWebSocketsBlocked=!0,e()}}catch(t){W.isWebSocketsBlocked=!0,e()}},W.load=function(e){F(e=e||function(){})},W.MediaDevices=void 0!==O?O:[],W.hasMicrophone=L,W.hasSpeakers=N,W.hasWebcam=I,W.isWebsiteHasWebcamPermissions=B,W.isWebsiteHasMicrophonePermissions=_,W.audioInputDevices=M,W.audioOutputDevices=P,W.videoInputDevices=U;var $=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&($=!0),W.isSetSinkIdSupported=$;var Q=!1;W.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(Q=!0):W.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(Q=!0),W.isRTPSenderReplaceTracksSupported=Q;var Z=!1;W.browser.isFirefox&&W.browser.version>38&&(Z=!0),W.isRemoteStreamProcessingSupported=Z;var ee=!1;void 0!==x&&"applyConstraints"in x.prototype&&(ee=!0),W.isApplyConstraintsSupported=ee;var te=!1;W.browser.isFirefox&&W.browser.version>=43&&(te=!0),W.isMultiMonitorScreenCapturingSupported=te,W.isPromisesSupported=!!("Promise"in window),W.version="1.3.9",void 0===W&&(window.DetectRTC={});var ne=window.MediaStream;void 0===ne&&"undefined"!=typeof webkitMediaStream&&(ne=webkitMediaStream),W.MediaStream=void 0!==ne&&"function"==typeof ne&&Object.keys(ne.prototype),W.MediaStreamTrack=void 0!==x&&Object.keys(x.prototype);var ie=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;W.RTCPeerConnection=void 0!==ie&&Object.keys(ie.prototype),window.DetectRTC=W,e.exports=W,void 0===(o=function(){return W}.apply(t,[]))||(e.exports=o)}(),"undefined"!=typeof cordova&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),window.addEventListener||(window.addEventListener=function(e,t,n){e.attachEvent&&e.attachEvent("on"+t,n)}),window.attachEventListener=function(e,t,n,i){e.addEventListener(t,n,i)};var w=window.MediaStream;function b(e,t){return(!e.session.audio||"two-way"!==e.session.audio)&&("Firefox"===DetectRTC.browser.name&&!1!==t||!("Chrome"!==DetectRTC.browser.name||DetectRTC.browser.version<50)&&(!0===typeof t||!(void 0!==t||!e.session.audio||!e.session.screen||e.session.video)&&(t=!0,!0)))}function y(e,t){return e&&e.getTracks?e.getTracks().filter((function(e){return e.kind===(t||"audio")})):[]}function S(){var e=!1;try{if("undefined"==typeof RTCRtpTransceiver)return!1;if(!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var t=new k;try{t.addTransceiver("audio"),e=!0}catch(e){}t.close()}catch(t){e=!1}return e&&function(){var e=!1;try{var t=new k({sdpSemantics:"unified-plan"});try{var n=t.getConfiguration();e="unified-plan"==n.sdpSemantics||(n.sdpSemantics,!1)}catch(t){e=!1}}catch(t){e=!1}return e}()}function C(){if("undefined"!=typeof cordova&&void 0!==cordova.plugins&&void 0!==cordova.plugins.iosrtc){var e=cordova.plugins.iosrtc;window.webkitRTCPeerConnection=e.RTCPeerConnection,window.RTCSessionDescription=e.RTCSessionDescription,window.RTCIceCandidate=e.RTCIceCandidate,window.MediaStream=e.MediaStream,window.MediaStreamTrack=e.MediaStreamTrack,navigator.getUserMedia=navigator.webkitGetUserMedia=e.getUserMedia,e.debug.enable("iosrtc*"),"function"==typeof e.selectAudioOutput&&e.selectAudioOutput(window.iOSDefaultAudioOutputDevice||"speaker"),e.registerGlobals()}}void 0===w&&"undefined"!=typeof webkitMediaStream&&(w=webkitMediaStream),void 0!==w&&("stop"in w.prototype||(w.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))})),window.iOSDefaultAudioOutputDevice=window.iOSDefaultAudioOutputDevice||"speaker",document.addEventListener("deviceready",C,!1),C();var k,R={};function T(e){return{OfferToReceiveAudio:!!e.OfferToReceiveAudio,OfferToReceiveVideo:!!e.OfferToReceiveVideo}}void 0!==window.RTCPeerConnection?k=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?k=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(k=webkitRTCPeerConnection);var A=window.RTCSessionDescription||window.mozRTCSessionDescription,E=window.RTCIceCandidate||window.mozRTCIceCandidate,x=window.MediaStreamTrack;function O(e){if(void 0!==window.RTCPeerConnection?k=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?k=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(k=webkitRTCPeerConnection),A=window.RTCSessionDescription||window.mozRTCSessionDescription,E=window.RTCIceCandidate||window.mozRTCIceCandidate,x=window.MediaStreamTrack,!k)throw"WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.";var t=e.rtcMultiConnection;this.extra=e.remoteSdp?e.remoteSdp.extra:t.extra,this.userid=e.userid,this.streams=[],this.channels=e.channels||[],this.connectionDescription=e.connectionDescription,this.addStream=function(e){t.addStream(e,n.userid)},this.removeStream=function(e){t.removeStream(e,n.userid)};var n=this;e.remoteSdp&&(this.connectionDescription=e.remoteSdp.connectionDescription);var i,o={};R.sdpConstraints=T({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0});var r=!!e.renegotiatingPeer;e.remoteSdp&&(r=!!e.remoteSdp.renegotiatingPeer);var a=[];if(t.attachStreams.forEach((function(e){e&&a.push(e)})),r)i=e.peerRef;else{var s="all";(t.candidates.turn||t.candidates.relay)&&(t.candidates.stun||t.candidates.reflexive||t.candidates.host||(s="relay"));try{var c={iceServers:t.iceServers,iceTransportPolicy:t.iceTransportPolicy||s};void 0!==t.iceCandidatePoolSize&&(c.iceCandidatePoolSize=t.iceCandidatePoolSize),void 0!==t.bundlePolicy&&(c.bundlePolicy=t.bundlePolicy),void 0!==t.rtcpMuxPolicy&&(c.rtcpMuxPolicy=t.rtcpMuxPolicy),t.sdpSemantics&&(c.sdpSemantics=t.sdpSemantics||"unified-plan"),t.iceServers&&t.iceServers.length||(c=null,t.optionalArgument=null),i=new k(c,t.optionalArgument)}catch(e){try{c={iceServers:t.iceServers};i=new k(c)}catch(e){i=new k}}}!i.getRemoteStreams&&i.getReceivers&&(i.getRemoteStreams=function(){var e=new w;return i.getReceivers().forEach((function(t){e.addTrack(t.track)})),[e]}),!i.getLocalStreams&&i.getSenders&&(i.getLocalStreams=function(){var e=new w;return i.getSenders().forEach((function(t){e.addTrack(t.track)})),[e]}),i.onicecandidate=function(o){if(o.candidate)t.trickleIce&&e.onLocalCandidate({candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex});else if(!t.trickleIce){var r=i.localDescription;e.onLocalSdp({type:r.type,sdp:r.sdp,remotePeerSdpConstraints:e.remotePeerSdpConstraints||!1,renegotiatingPeer:!!e.renegotiatingPeer||!1,connectionDescription:n.connectionDescription,dontGetRemoteStream:!!e.dontGetRemoteStream,extra:t?t.extra:{},streamsToShare:p})}},a.forEach((function(o){e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream||e.dontAttachLocalStream||(o=t.beforeAddingStream(o,n))&&(i.getLocalStreams().forEach((function(e){o&&e.id==o.id&&(o=null)})),o&&o.getTracks&&o.getTracks().forEach((function(e){try{i.addTrack(e,o)}catch(e){}})))})),i.oniceconnectionstatechange=i.onsignalingstatechange=function(){var o=n.extra;t.peers[n.userid]&&(o=t.peers[n.userid].extra||o),i&&(e.onPeerStateChanged({iceConnectionState:i.iceConnectionState,iceGatheringState:i.iceGatheringState,signalingState:i.signalingState,extra:o,userid:n.userid}),i&&i.iceConnectionState&&-1!==i.iceConnectionState.search(/closed|failed/gi)&&n.streams instanceof Array&&n.streams.forEach((function(e){var n=t.streamEvents[e.id]||{streamid:e.id,stream:e,type:"remote"};t.onstreamended(n)})))};var d={OfferToReceiveAudio:!!a.length,OfferToReceiveVideo:!!a.length};e.localPeerSdpConstraints&&(d=e.localPeerSdpConstraints),R.sdpConstraints=T(d);var u={};i.ontrack=function(t){if(t&&"track"===t.type)if(t.stream=t.streams[t.streams.length-1],t.stream.id||(t.stream.id=t.track.id),u[t.stream.id]&&"Safari"!==DetectRTC.browser.name)t.track&&(t.track.onended=function(){i&&i.onremovestream(t)});else{u[t.stream.id]=t.stream.id;var n={};e.remoteSdp&&e.remoteSdp.streamsToShare?n=e.remoteSdp.streamsToShare:e.streamsToShare&&(n=e.streamsToShare);var r=n[t.stream.id];r?(t.stream.isAudio=r.isAudio,t.stream.isVideo=r.isVideo,t.stream.isScreen=r.isScreen):(t.stream.isVideo=!!y(t.stream,"video").length,t.stream.isAudio=!t.stream.isVideo,t.stream.isScreen=!1),t.stream.streamid=t.stream.id,o[t.stream.id]=t.stream,e.onRemoteStream(t.stream),t.stream.getTracks().forEach((function(e){e.onended=function(){i&&i.onremovestream(t)}})),t.stream.onremovetrack=function(){i&&i.onremovestream(t)}}},i.onremovestream=function(t){t.stream.streamid=t.stream.id,o[t.stream.id]&&delete o[t.stream.id],e.onRemoteStreamRemoved(t.stream)},"function"!=typeof i.removeStream&&(i.removeStream=function(e){e.getTracks().forEach((function(t){i.removeTrack(t,e)}))}),this.addRemoteCandidate=function(e){i.addIceCandidate(new E(e))},this.addRemoteSdp=function(e,n){n=n||function(){},"Safari"!==DetectRTC.browser.name&&(e.sdp=t.processSdp(e.sdp)),i.setRemoteDescription(new A(e)).then(n,(function(i){t.enableLogs&&console.error("setRemoteDescription failed","\n",i,"\n",e.sdp),n()})).catch((function(i){t.enableLogs&&console.error("setRemoteDescription failed","\n",i,"\n",e.sdp),n()}))};var f=!0;function l(t){t.binaryType="arraybuffer",t.onmessage=function(t){e.onDataChannelMessage(t.data)},t.onopen=function(){e.onDataChannelOpened(t)},t.onerror=function(t){e.onDataChannelError(t)},t.onclose=function(t){e.onDataChannelClosed(t)},t.internalSend=t.send,t.send=function(e){"open"===t.readyState&&t.internalSend(e)},i.channel=t}e.remoteSdp&&(f=!1),this.createDataChannel=function(){l(i.createDataChannel("sctp",{}))},!0!==t.session.data||r||(f?this.createDataChannel():i.ondatachannel=function(e){l(e.channel)}),this.enableDisableVideoEncoding=function(e){var t;if(i.getSenders().forEach((function(e){t||"video"!==e.track.kind||(t=e)})),t&&t.getParameters){var n=t.getParameters();n.encodings[1]&&(n.encodings[1].active=!!e),n.encodings[2]&&(n.encodings[2].active=!!e),t.setParameters(n)}},e.remoteSdp&&(e.remoteSdp.remotePeerSdpConstraints&&(d=e.remoteSdp.remotePeerSdpConstraints),R.sdpConstraints=T(d),this.addRemoteSdp(e.remoteSdp,(function(){m("createAnswer")}))),"two-way"!=t.session.audio&&"two-way"!=t.session.video&&"two-way"!=t.session.screen||(R.sdpConstraints=T({OfferToReceiveAudio:"two-way"==t.session.audio||e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio,OfferToReceiveVideo:"two-way"==t.session.video||"two-way"==t.session.screen||e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio}));var p={};function m(o){i[o](R.sdpConstraints).then((function(o){"Safari"!==DetectRTC.browser.name&&(o.sdp=t.processSdp(o.sdp)),i.setLocalDescription(o).then((function(){t.trickleIce&&(e.onLocalSdp({type:o.type,sdp:o.sdp,remotePeerSdpConstraints:e.remotePeerSdpConstraints||!1,renegotiatingPeer:!!e.renegotiatingPeer||!1,connectionDescription:n.connectionDescription,dontGetRemoteStream:!!e.dontGetRemoteStream,extra:t?t.extra:{},streamsToShare:p}),t.onSettingLocalDescription(n))}),(function(e){t.enableLogs&&console.error("setLocalDescription error",e)}))}),(function(e){t.enableLogs&&console.error("sdp-error",e)}))}i.getLocalStreams().forEach((function(e){p[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}})),f&&m("createOffer"),i.nativeClose=i.close,i.close=function(){if(i){try{i.nativeClose!==i.close&&i.nativeClose()}catch(e){}i=null,n.peer=null}},this.peer=i}var M=function(){function e(e,i){var o=n(e);return o.videoCodecNumbers?"vp8"===i&&o.vp8LineNumber===o.videoCodecNumbers[0]||"vp9"===i&&o.vp9LineNumber===o.videoCodecNumbers[0]||"h264"===i&&o.h264LineNumber===o.videoCodecNumbers[0]?e:e=t(e,i,o):e}function t(e,t,n,i){var o="";if("vp8"===t){if(!n.vp8LineNumber)return e;o=n.vp8LineNumber}if("vp9"===t){if(!n.vp9LineNumber)return e;o=n.vp9LineNumber}if("h264"===t){if(!n.h264LineNumber)return e;o=n.h264LineNumber}var r=n.videoCodecNumbersOriginal.split("SAVPF")[0]+"SAVPF ",a=[o];return i&&(a=[]),n.videoCodecNumbers.forEach((function(e){e!==o&&a.push(e)})),r+=a.join(" "),e=e.replace(n.videoCodecNumbersOriginal,r)}function n(e){var t={};return e.split("\n").forEach((function(e){0===e.indexOf("m=video")&&(t.videoCodecNumbers=[],e.split("SAVPF")[1].split(" ").forEach((function(n){(n=n.trim())&&n.length&&(t.videoCodecNumbers.push(n),t.videoCodecNumbersOriginal=e)}))),-1===e.indexOf("VP8/90000")||t.vp8LineNumber||(t.vp8LineNumber=e.replace("a=rtpmap:","").split(" ")[0]),-1===e.indexOf("VP9/90000")||t.vp9LineNumber||(t.vp9LineNumber=e.replace("a=rtpmap:","").split(" ")[0]),-1===e.indexOf("H264/90000")||t.h264LineNumber||(t.h264LineNumber=e.replace("a=rtpmap:","").split(" ")[0])})),t}function i(e,t,n){return function(e,t,n,i,o){for(var r=-1!==n?n:e.length,a=t;a<r;++a)if(0===e[a].indexOf(i)&&(!o||-1!==e[a].toLowerCase().indexOf(o.toLowerCase())))return a;return null}(e,0,-1,t,n)}function o(e){var t=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),n=e.match(t);return n&&2===n.length?n[1]:null}return{removeVPX:function(e){var i=n(e);return e=t(e,"vp9",i,!0),e=t(e,"vp8",i,!0)},disableNACK:function(e){if(!e||"string"!=typeof e)throw"Invalid arguments.";return e=(e=(e=(e=e.replace("a=rtcp-fb:126 nack\r\n","")).replace("a=rtcp-fb:126 nack pli\r\n","a=rtcp-fb:126 pli\r\n")).replace("a=rtcp-fb:97 nack\r\n","")).replace("a=rtcp-fb:97 nack pli\r\n","a=rtcp-fb:97 pli\r\n")},prioritize:function(e,t){if(t&&t.getSenders&&t.getSenders().length){if(!e||"string"!=typeof e)throw"Invalid arguments.";t.getSenders().forEach((function(t){for(var n=t.getParameters(),i=0;i<n.codecs.length;i++)if(n.codecs[i].mimeType==e){n.codecs.unshift(n.codecs.splice(i,1));break}t.setParameters(n)}))}},removeNonG722:function(e){return e.replace(/m=audio ([0-9]+) RTP\/SAVPF ([0-9 ]*)/g,"m=audio $1 RTP/SAVPF 9")},setApplicationSpecificBandwidth:function(e,t,n){return function(e,t,n){return t?("undefined"!=typeof isFirefox&&isFirefox||(n&&(t.screen?t.screen<300&&console.warn("It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail."):console.warn("It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.")),t.screen&&n&&(e=(e=e.replace(/b=AS([^\r\n]+\r\n)/g,"")).replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+t.screen+"\r\n")),(t.audio||t.video)&&(e=e.replace(/b=AS([^\r\n]+\r\n)/g,"")),t.audio&&(e=e.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:"+t.audio+"\r\n")),t.screen?e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+t.screen+"\r\n"):t.video&&(e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+t.video+"\r\n"))),e):e}(e,t,n)},setVideoBitrates:function(e,t){return function(e,t){var n,r=(t=t||{}).min,a=t.max,s=e.split("\r\n"),c=i(s,"a=rtpmap","VP8/90000");if(c&&(n=o(s[c])),!n)return e;var d,u=i(s,"a=rtpmap","rtx/90000");if(u&&(d=o(s[u])),!u)return e;var f=i(s,"a=fmtp:"+d.toString());if(null!==f){var l="\r\n";l+="a=fmtp:"+n+" x-google-min-bitrate="+(r||"228")+"; x-google-max-bitrate="+(a||"228"),s[f]=s[f].concat(l),e=s.join("\r\n")}return e}(e,t)},setOpusAttributes:function(e,t){return function(e,t){t=t||{};var n,r=e.split("\r\n"),a=i(r,"a=rtpmap","opus/48000");if(a&&(n=o(r[a])),!n)return e;var s=i(r,"a=fmtp:"+n.toString());if(null===s)return e;var c="";return c+="; stereo="+(void 0!==t.stereo?t.stereo:"1"),c+="; sprop-stereo="+(void 0!==t["sprop-stereo"]?t["sprop-stereo"]:"1"),void 0!==t.maxaveragebitrate&&(c+="; maxaveragebitrate="+(t.maxaveragebitrate||1048576)),void 0!==t.maxplaybackrate&&(c+="; maxplaybackrate="+(t.maxplaybackrate||1048576)),void 0!==t.cbr&&(c+="; cbr="+(void 0!==t.cbr?t.cbr:"1")),void 0!==t.useinbandfec&&(c+="; useinbandfec="+t.useinbandfec),void 0!==t.usedtx&&(c+="; usedtx="+t.usedtx),void 0!==t.maxptime&&(c+="\r\na=maxptime:"+t.maxptime),r[s]=r[s].concat(c),e=r.join("\r\n")}(e,t)},preferVP9:function(t){return e(t,"vp9")},preferCodec:e,forceStereoAudio:function(e){for(var t=e.split("\r\n"),n=null,i=0;i<t.length;i++)if(-1!==t[i].search("opus/48000")){var o=extractSdp(t[i],/:(\d+) opus\/48000/i);break}for(i=0;i<t.length;i++){if(-1!==t[i].search("a=fmtp"))if(extractSdp(t[i],/a=fmtp:(\d+)/)===o){n=i;break}}return null===n?e:(t[n]=t[n].concat("; stereo=1; sprop-stereo=1"),e=t.join("\r\n"))}}}();window.BandwidthHandler=M;var P={processCandidates:function(e,t){var n=t.candidate,i=e.candidates,o=i.stun,r=i.turn;if(g(i.reflexive)||(o=i.reflexive),g(i.relay)||(r=i.relay),(i.host||!n.match(/typ host/g))&&(r||!n.match(/typ relay/g))&&(o||!n.match(/typ srflx/g))){var a=e.iceProtocols;if((a.udp||!n.match(/ udp /g))&&(a.tcp||!n.match(/ tcp /g)))return e.enableLogs&&console.debug("Your candidate pairs:",n),{candidate:n,sdpMid:t.sdpMid,sdpMLineIndex:t.sdpMLineIndex}}}},U={getIceServers:function(e){return[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun.l.google.com:19302?transport=udp"]}]}};function D(e){if(!0!==currentUserMediaRequest.mutex){currentUserMediaRequest.mutex=!0;var t=JSON.stringify(e.localMediaConstraints);if(currentUserMediaRequest.streams[t])r(currentUserMediaRequest.streams[t].stream,!0);else{if(!!/BB10|BlackBerry/i.test(navigator.userAgent||"")||void 0===navigator.mediaDevices||"function"!=typeof navigator.mediaDevices.getUserMedia)return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,void navigator.getUserMedia(e.localMediaConstraints,(function(e){e.streamid=e.streamid||e.id||l(),e.idInstance=t,r(e)}),(function(t){e.onLocalMediaError(t,e.localMediaConstraints)}));if(void 0===navigator.mediaDevices){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var n,i,o=function(){};navigator.mediaDevices={getUserMedia:function(e){return navigator.getUserMedia(e,(function(e){e(stream),n=stream}),(function(e){o(e),i=e})),{then:function(e){if(!n)return e,{then:function(e){i?e(i):o=e}};e(n)}}}}}if(!0===e.localMediaConstraints.isScreen){if(navigator.mediaDevices.getDisplayMedia)navigator.mediaDevices.getDisplayMedia(e.localMediaConstraints).then((function(e){e.streamid=e.streamid||e.id||l(),e.idInstance=t,r(e)})).catch((function(t){e.onLocalMediaError(t,e.localMediaConstraints)}));else{if(!navigator.getDisplayMedia)throw new Error("getDisplayMedia API is not availabe in this browser.");navigator.getDisplayMedia(e.localMediaConstraints).then((function(e){e.streamid=e.streamid||e.id||l(),e.idInstance=t,r(e)})).catch((function(t){e.onLocalMediaError(t,e.localMediaConstraints)}))}return}navigator.mediaDevices.getUserMedia(e.localMediaConstraints).then((function(e){e.streamid=e.streamid||e.id||l(),e.idInstance=t,r(e)})).catch((function(t){e.onLocalMediaError(t,e.localMediaConstraints)}))}}else currentUserMediaRequest.queueRequests.push(e);function r(n,i){!function(e,t){e.mandatory&&e.mandatory.chromeMediaSource||e.mozMediaSource||e.mediaSource?t.isScreen=!0:e.video?t.isVideo=!0:e.audio&&(t.isAudio=!0)}(e.localMediaConstraints,n);var o="ended";"oninactive"in n&&(o="inactive"),n.addEventListener(o,(function(){delete currentUserMediaRequest.streams[t],currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.indexOf(e)&&(delete currentUserMediaRequest.queueRequests[currentUserMediaRequest.queueRequests.indexOf(e)],currentUserMediaRequest.queueRequests=v(currentUserMediaRequest.queueRequests))}),!1),currentUserMediaRequest.streams[t]={stream:n},currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.length&&D(currentUserMediaRequest.queueRequests.shift()),e.onGettingLocalMedia(n,i)}}window.currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[],remove:function(e){this.mutex=!1;var t=this.streams[e];if(t){var n=(t=t.stream).currentUserMediaRequestOptions;this.queueRequests.indexOf(n)&&(delete this.queueRequests[this.queueRequests.indexOf(n)],this.queueRequests=v(this.queueRequests)),this.streams[e].stream=null,delete this.streams[e]}}};var L=function(){function e(e){if(e)return"string"==typeof e||void 0===e?e:e.audio&&e.video?null:e.audio?"audio":e.video?"video":void 0}return{setHandlers:function(t,n,i){if(t&&t.addEventListener){if(void 0===n||1==n){var o="ended";"oninactive"in t&&(o="inactive"),t.addEventListener(o,(function(){L.onSyncNeeded(this.streamid,o)}),!1)}t.mute=function(o,r){o=e(o),void 0!==r&&(n=r),void 0!==o&&"audio"!=o||y(t,"audio").forEach((function(e){e.enabled=!1,i.streamEvents[t.streamid].isAudioMuted=!0})),void 0!==o&&"video"!=o||y(t,"video").forEach((function(e){e.enabled=!1})),void 0!==n&&1!=n||L.onSyncNeeded(t.streamid,"mute",o),i.streamEvents[t.streamid].muteType=o||"both",u(t,"mute",o)},t.unmute=function(o,r){o=e(o),void 0!==r&&(n=r),function(){if(!i.streamEvents[t.streamid].mediaElement)return;var e=i.streamEvents[t.streamid].mediaElement;e.volume=0,function e(t,n,i,o){if((o=(o||0)+1)>=n)return;setTimeout((function(){i(),e(t,n,i,o)}),t)}(200,5,(function(){try{e.volume+=.2}catch(t){e.volume=1}}))}(),void 0!==o&&"audio"!=o||y(t,"audio").forEach((function(e){e.enabled=!0,i.streamEvents[t.streamid].isAudioMuted=!1})),void 0!==o&&"video"!=o||(y(t,"video").forEach((function(e){e.enabled=!0})),void 0!==o&&"video"==o&&i.streamEvents[t.streamid].isAudioMuted&&function e(n){n||(n=0),++n<100&&i.streamEvents[t.streamid].isAudioMuted&&(t.mute("audio"),setTimeout((function(){e(n)}),50))}()),void 0!==n&&1!=n||L.onSyncNeeded(t.streamid,"unmute",o),i.streamEvents[t.streamid].unmuteType=o||"both",u(t,"unmute",o)}}},onSyncNeeded:function(e,t,n){}}}();function N(e){var t={};return{receive:function(n,i,o){var r=n.uuid;if(t[r]||(t[r]=[]),t[r].push(n.message),n.last){var a=t[r].join("");n.isobject&&(a=JSON.parse(a));var s={data:a,userid:i,extra:o,latency:(new Date).getTime()-n.sendingTime};e.autoTranslateText?(s.original=s.data,e.Translator.TranslateText(s.data,(function(t){s.data=t,e.onmessage(s)}))):e.onmessage(s),delete t[r]}}}}var I={send:function(e){var t=e.connection,n=e.channel,i=e.remoteUserId,o=e.text,r=t.chunkSize||1e3,a="",s=!1;"string"!=typeof o&&(s=!0,o=JSON.stringify(o));var c=l(),d=(new Date).getTime();!function e(o,u){var f={type:"text",uuid:c,sendingTime:d};o&&(u=o,f.packets=parseInt(u.length/r));u.length>r?f.message=u.slice(0,r):(f.message=u,f.last=!0,f.isobject=s);n.send(f,i),(a=u.slice(f.message.length)).length&&setTimeout((function(){e(null,a)}),t.chunkInterval||100)}(o)}},_={handle:function(e){var t={};e.onFileStart=function(n){var i=document.createElement("div");if(i.title=n.name,i.innerHTML="<label>0%</label> <progress></progress>",n.remoteUserId&&(i.innerHTML+=" (Sharing with:"+n.remoteUserId+")"),e.filesContainer||(e.filesContainer=document.body||document.documentElement),e.filesContainer.insertBefore(i,e.filesContainer.firstChild),!n.remoteUserId)return t[n.uuid]={div:i,progress:i.querySelector("progress"),label:i.querySelector("label")},void(t[n.uuid].progress.max=n.maxChunks);t[n.uuid]||(t[n.uuid]={}),t[n.uuid][n.remoteUserId]={div:i,progress:i.querySelector("progress"),label:i.querySelector("label")},t[n.uuid][n.remoteUserId].progress.max=n.maxChunks},e.onFileProgress=function(e){var n=t[e.uuid];n&&(e.remoteUserId&&!(n=t[e.uuid][e.remoteUserId])||(n.progress.value=e.currentPosition||e.maxChunks||n.progress.max,function(e,t){if(-1!==e.position){var n=+e.position.toFixed(2).split(".")[1]||100;t.innerHTML=n+"%"}}(n.progress,n.label)))},e.onFileEnd=function(e){var n=t[e.uuid];if(n){if(!e.remoteUserId||(n=t[e.uuid][e.remoteUserId])){var i=n.div;-1!=e.type.indexOf("image")?i.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><img src="'+e.url+'" title="'+e.name+'" style="max-width: 80%;">':i.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><iframe src="'+e.url+'" title="'+e.name+'" style="width: 80%;border: 0;height: inherit;margin-top:1em;"></iframe>'}}else console.error("No such progress-helper element exist.",e)}}},B={handle:function(e){e.autoTranslateText=!1,e.language="en",e.googKey="AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE",e.Translator={TranslateText:function(t,n){var i=document.createElement("script");i.type="text/javascript";var o=encodeURIComponent(t),r="method"+e.token();window[r]=function(e){e.data&&e.data.translations[0]&&n?n(e.data.translations[0].translatedText):e.error&&"Daily Limit Exceeded"===e.error.message?console.error('Text translation failed. Error message: "Daily Limit Exceeded."'):e.error?console.error(e.error.message):console.error(e)};var a="https://www.googleapis.com/language/translate/v2?key="+e.googKey+"&target="+(e.language||"en-US")+"&callback=window."+r+"&q="+o;i.src=a,document.getElementsByTagName("head")[0].appendChild(i)},getListOfLanguages:function(t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState==XMLHttpRequest.DONE){var e=JSON.parse(n.responseText);if(e&&e.data&&e.data.languages)return void t(e.data.languages);if(e.error&&"Daily Limit Exceeded"===e.error.message)return void console.error('Text translation failed. Error message: "Daily Limit Exceeded."');if(e.error)return void console.error(e.error.message);console.error(e)}};var i="https://www.googleapis.com/language/translate/v2/languages?key="+e.googKey+"&target=en";n.open("GET",i,!0),n.send(null)}}}};!function(e){a=a||{useDefaultDevices:!0},e.channel=e.sessionid=(r||location.href.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join(""))+"";var t=new d(e),n={};function i(t){if(e.socketAutoReConnect=!0,e.socket)t&&t(e.socket);else{if(void 0===c)if("undefined"!=typeof FirebaseConnection)window.SocketConnection=FirebaseConnection;else{if("undefined"==typeof PubNubConnection)throw"SocketConnection.js seems missed.";window.SocketConnection=PubNubConnection}new c(e,(function(n){t&&t(e.socket)}))}}function o(n,i){e.socket.emit("join-room",{sessionid:e.sessionid,session:e.session,mediaConstraints:e.mediaConstraints,sdpConstraints:e.sdpConstraints,streams:u(),extra:e.extra,password:void 0!==e.password&&"object"!=typeof e.password?e.password:""},(function(o,r){if(!0===o){if(e.enableLogs&&console.log("isRoomJoined: ",o," roomid: ",e.sessionid),e.peers[e.sessionid])return;t.onNegotiationNeeded(n)}!1===o&&e.enableLogs&&console.warn("isRoomJoined: ",r," roomid: ",e.sessionid),i(o,e.sessionid,r)}))}function s(t){e.enableLogs&&console.log("Sending open-room signal to socket.io"),e.waitingForLocalMedia=!1,e.socket.emit("open-room",{sessionid:e.sessionid,session:e.session,mediaConstraints:e.mediaConstraints,sdpConstraints:e.sdpConstraints,streams:u(),extra:e.extra,identifier:e.publicRoomIdentifier,password:void 0!==e.password&&"object"!=typeof e.password?e.password:""},(function(n,i){!0===n&&(e.enableLogs&&console.log("isRoomOpened: ",n," roomid: ",e.sessionid),t(n,e.sessionid)),!1===n&&(e.enableLogs&&console.warn("isRoomOpened: ",i," roomid: ",e.sessionid),t(n,e.sessionid,i))}))}function u(){try{return e.streamEvents.selectAll("local").map((function(e){return{streamid:e.streamid,tracks:e.stream.getTracks().length}}))}catch(e){return[]}}function v(n,i){if(e.dontCaptureUserMedia||n.isDataOnly)i();else{var o={};n.localPeerSdpConstraints.OfferToReceiveAudio&&(o.audio=e.mediaConstraints.audio),n.localPeerSdpConstraints.OfferToReceiveVideo&&(o.video=e.mediaConstraints.video);var r=n.session||e.session;r.oneway&&"two-way"!==r.audio&&"two-way"!==r.video&&"two-way"!==r.screen?i():(r.oneway&&r.audio&&"two-way"===r.audio&&(r={audio:!0}),(r.audio||r.video||r.screen)&&(r.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:b(e)}).then((function(n){n.isScreen=!0,t.onGettingLocalMedia(n),!r.audio&&!r.video||b(e)?i(n):e.invokeGetUserMedia(null,i)}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:b(e),video:!0,isScreen:!0},!r.audio&&!r.video||b(e)?i:e.invokeGetUserMedia(null,i)):(r.audio||r.video)&&e.invokeGetUserMedia(null,i,r)))}}function g(t,n){t?(n.audio&&y(t,"audio").forEach((function(e){e.applyConstraints(n.audio)})),n.video&&y(t,"video").forEach((function(e){e.applyConstraints(n.video)}))):e.enableLogs&&console.error("No stream to applyConstraints.")}function C(n,i,o){i?t.replaceTrack(n,i,o):e.peers.getAllParticipants().forEach((function(e){t.replaceTrack(n,e,o)}))}t.onGettingLocalMedia=function(t,i){if(i=i||function(){},n[t.streamid])i();else{n[t.streamid]=!0;try{t.type="local"}catch(e){}e.setStreamEndHandler(t),p(t,(function(n){n.id=t.streamid,n.muted=!0,n.volume=0,-1===e.attachStreams.indexOf(t)&&e.attachStreams.push(t),void 0!==L&&L.setHandlers(t,!0,e),e.streamEvents[t.streamid]={stream:t,type:"local",mediaElement:n,userid:e.userid,extra:e.extra,streamid:t.streamid,isAudioMuted:!0};try{!function(e,t){if(t.stream&&y(t.stream,"audio").length){if(!e||!t)throw"Both arguments are required.";if(e.onspeaking&&e.onsilence){if("undefined"==typeof hark)throw"hark.js not found.";hark(t.stream,{onspeaking:function(){e.onspeaking(t)},onsilence:function(){e.onsilence(t)},onvolumechange:function(n,i){e.onvolumechange&&e.onvolumechange(merge({volume:n,threshold:i},t))}})}}}(e,e.streamEvents[t.streamid]),f(e,e.streamEvents[t.streamid]),e.onstream(e.streamEvents[t.streamid])}catch(e){}i()}),e)}},t.onGettingRemoteMedia=function(t,n){try{t.type="remote"}catch(e){}e.setStreamEndHandler(t,"remote-stream"),p(t,(function(i){i.id=t.streamid,void 0!==L&&L.setHandlers(t,!1,e),e.streamEvents[t.streamid]={stream:t,type:"remote",userid:n,extra:e.peers[n]?e.peers[n].extra:{},mediaElement:i,streamid:t.streamid},f(e,e.streamEvents[t.streamid]),e.onstream(e.streamEvents[t.streamid])}),e)},t.onRemovingRemoteMedia=function(t,n){var i=e.streamEvents[t.streamid];i||(i={stream:t,type:"remote",userid:n,extra:e.peers[n]?e.peers[n].extra:{},streamid:t.streamid,mediaElement:e.streamEvents[t.streamid]?e.streamEvents[t.streamid].mediaElement:null}),e.peersBackup[i.userid]&&(i.extra=e.peersBackup[i.userid].extra),e.onstreamended(i),delete e.streamEvents[t.streamid]},t.onNegotiationNeeded=function(t,n,o){o=o||function(){};var r={remoteUserId:n=n||t.remoteUserId,message:t=t||"",sender:e.userid};t.remoteUserId&&t.message&&t.sender&&(r=t),i((function(){e.socket.emit(e.socketMessageEvent,r,o)}))},t.onUserLeft=function(t){e.deletePeer(t)},t.disconnectWith=function(t,n){e.socket&&e.socket.emit("disconnect-with",t,n||function(){}),e.deletePeer(t)},e.socketOptions={transport:"polling"},e.openOrJoin=function(t,n){n=n||function(){},e.checkPresence(t,(function(t,i){if(t){e.sessionid=i;var r,a,c=!!e.session.oneway,d=h(e.session);a={OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},r={OfferToReceiveAudio:c?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:c?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo};var u={remoteUserId:e.sessionid,message:{newParticipationRequest:!0,isOneWay:c,isDataOnly:d,localPeerSdpConstraints:r,remotePeerSdpConstraints:a},sender:e.userid};v(u.message,(function(){o(u,n)}))}else e.waitingForLocalMedia=!0,e.isInitiator=!0,e.sessionid=i||e.sessionid,h(e.session)?s(n):e.captureUserMedia((function(){s(n)}))}))},e.waitingForLocalMedia=!1,e.open=function(t,n){n=n||function(){},e.waitingForLocalMedia=!0,e.isInitiator=!0,e.sessionid=t||e.sessionid,i((function(){h(e.session)?s(n):e.captureUserMedia((function(){s(n)}))}))},e.peersBackup={},e.deletePeer=function(t){if(t&&e.peers[t]){var n={userid:t,extra:e.peers[t]?e.peers[t].extra:{}};if(e.peersBackup[n.userid]&&(n.extra=e.peersBackup[n.userid].extra),e.onleave(n),e.peers[t]){e.peers[t].streams.forEach((function(e){e.stop()}));var i=e.peers[t].peer;if(i&&"closed"!==i.iceConnectionState)try{i.close()}catch(e){}e.peers[t]&&(e.peers[t].peer=null,delete e.peers[t])}}},e.rejoin=function(t){if(!e.isInitiator&&t&&Object.keys(t).length){var n={};e.peers[t.remoteUserId]&&(n=e.peers[t.remoteUserId].extra,e.deletePeer(t.remoteUserId)),t&&t.remoteUserId&&(e.join(t.remoteUserId),e.onReConnecting({userid:t.remoteUserId,extra:n}))}},e.join=function(t,n){e.sessionid=!!t&&(t.sessionid||t.remoteUserId||t)||e.sessionid,e.sessionid+="";var r=!1,a=!1,s=!1,c=!1;if(t&&t.session||!t||"string"==typeof t){var d=t&&t.session||e.session;s=!!d.oneway,c=h(d),a={OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},r={OfferToReceiveAudio:s?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo}}var u=function(){};"function"==typeof(n=n||{})&&(u=n,n={}),void 0!==n.localPeerSdpConstraints&&(r=n.localPeerSdpConstraints),void 0!==n.remotePeerSdpConstraints&&(a=n.remotePeerSdpConstraints),void 0!==n.isOneWay&&(s=n.isOneWay),void 0!==n.isDataOnly&&(c=n.isDataOnly);var f={remoteUserId:e.sessionid,message:{newParticipationRequest:!0,isOneWay:s,isDataOnly:c,localPeerSdpConstraints:r,remotePeerSdpConstraints:a},sender:e.userid};return v(f.message,(function(){i((function(){o(f,u)}))})),f},e.publicRoomIdentifier="",e.getUserMedia=e.captureUserMedia=function(n,i){n=n||function(){};var o=i||e.session;e.dontCaptureUserMedia||h(o)?n():(o.audio||o.video||o.screen)&&(o.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:b(e)}).then((function(r){if(r.isScreen=!0,t.onGettingLocalMedia(r),!o.audio&&!o.video||b(e))n(r);else{var a={};for(var s in o)"screen"!==s&&(a[s]=o[s]);e.invokeGetUserMedia(i,n,a)}}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:b(e),video:!0,isScreen:!0},(function(t){if(!o.audio&&!o.video||b(e))n(t);else{var r={};for(var a in o)"screen"!==a&&(r[a]=o[a]);e.invokeGetUserMedia(i,n,r)}})):(o.audio||o.video)&&e.invokeGetUserMedia(i,n,o))},e.onbeforeunload=function(n,i){e.closeBeforeUnload&&(e.peers.getAllParticipants().forEach((function(n){t.onNegotiationNeeded({userLeft:!0},n),e.peers[n]&&e.peers[n].peer&&e.peers[n].peer.close(),delete e.peers[n]})),i||e.closeSocket(),e.isInitiator=!1)},window.ignoreBeforeUnload?e.closeBeforeUnload=!1:(e.closeBeforeUnload=!0,window.addEventListener("beforeunload",e.onbeforeunload,!1)),e.userid=l(),e.changeUserId=function(t,n){n=n||function(){},e.userid=t||l(),e.socket.emit("changed-uuid",e.userid,n)},e.extra={},e.attachStreams=[],e.session={audio:!0,video:!0},e.enableFileSharing=!1,e.bandwidth={screen:!1,audio:!1,video:!1},e.codecs={audio:"opus",video:"VP9"},e.processSdp=function(t){return S()||"Safari"===DetectRTC.browser.name?t:("VP8"===e.codecs.video.toUpperCase()&&(t=M.preferCodec(t,"vp8")),"VP9"===e.codecs.video.toUpperCase()&&(t=M.preferCodec(t,"vp9")),"H264"===e.codecs.video.toUpperCase()&&(t=M.preferCodec(t,"h264")),"G722"===e.codecs.audio&&(t=M.removeNonG722(t)),"Firefox"===DetectRTC.browser.name||((e.bandwidth.video||e.bandwidth.screen)&&(t=M.setApplicationSpecificBandwidth(t,e.bandwidth,!!e.session.screen)),e.bandwidth.video&&(t=M.setVideoBitrates(t,{min:8*e.bandwidth.video*1024,max:8*e.bandwidth.video*1024})),e.bandwidth.audio&&(t=M.setOpusAttributes(t,{maxaveragebitrate:8*e.bandwidth.audio*1024,maxplaybackrate:8*e.bandwidth.audio*1024,stereo:1,maxptime:3}))),t)},void 0!==M&&(e.BandwidthHandler=e.CodecsHandler=M),e.mediaConstraints={audio:{mandatory:{},optional:e.bandwidth.audio?[{bandwidth:8*e.bandwidth.audio*1024||1048576}]:[]},video:{mandatory:{},optional:e.bandwidth.video?[{bandwidth:8*e.bandwidth.video*1024||1048576},{facingMode:"user"}]:[{facingMode:"user"}]}},"Firefox"===DetectRTC.browser.name&&(e.mediaConstraints={audio:!0,video:!0}),a.useDefaultDevices||DetectRTC.isMobileDevice||DetectRTC.load((function(){var t,n;if(DetectRTC.MediaDevices.forEach((function(i){"audioinput"===i.kind&&!1!==e.mediaConstraints.audio&&(t=i),"videoinput"===i.kind&&!1!==e.mediaConstraints.video&&(n=i)})),t){if("Firefox"===DetectRTC.browser.name)return void(!0!==e.mediaConstraints.audio?e.mediaConstraints.audio.deviceId=t.id:e.mediaConstraints.audio={deviceId:t.id});1==e.mediaConstraints.audio&&(e.mediaConstraints.audio={mandatory:{},optional:[]}),e.mediaConstraints.audio.optional||(e.mediaConstraints.audio.optional=[]);var i=[{sourceId:t.id}];e.mediaConstraints.audio.optional=i.concat(e.mediaConstraints.audio.optional)}if(n){if("Firefox"===DetectRTC.browser.name)return void(!0!==e.mediaConstraints.video?e.mediaConstraints.video.deviceId=n.id:e.mediaConstraints.video={deviceId:n.id});1==e.mediaConstraints.video&&(e.mediaConstraints.video={mandatory:{},optional:[]}),e.mediaConstraints.video.optional||(e.mediaConstraints.video.optional=[]);i=[{sourceId:n.id}];e.mediaConstraints.video.optional=i.concat(e.mediaConstraints.video.optional)}})),e.sdpConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{VoiceActivityDetection:!1}]},e.sdpSemantics=null,e.iceCandidatePoolSize=null,e.bundlePolicy=null,e.rtcpMuxPolicy=null,e.iceTransportPolicy=null,e.optionalArgument={optional:[{DtlsSrtpKeyAgreement:!0},{googImprovedWifiBwe:!0},{googScreencastMinBitrate:300},{googIPv6:!0},{googDscp:!0},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:85},{googSuspendBelowMinBitrate:!0},{googCpuOveruseDetection:!0}],mandatory:{}},e.iceServers=U.getIceServers(e),e.candidates={host:!0,stun:!0,turn:!0},e.iceProtocols={tcp:!0,udp:!0},e.onopen=function(t){e.enableLogs&&console.info("Data connection has been opened between you & ",t.userid)},e.onclose=function(t){e.enableLogs&&console.warn("Data connection has been closed between you & ",t.userid)},e.onerror=function(t){e.enableLogs&&console.error(t.userid,"data-error",t)},e.onmessage=function(t){e.enableLogs&&console.debug("data-message",t.userid,t.data)},e.send=function(t,n){e.peers.send(t,n)},e.close=e.disconnect=e.leave=function(){e.onbeforeunload(!1,!0)},e.closeEntireSession=function(t){t=t||function(){},e.socket.emit("close-entire-session",(function n(){e.getAllParticipants().length?setTimeout(n,100):(e.onEntireSessionClosed({sessionid:e.sessionid,userid:e.userid,extra:e.extra}),e.changeUserId(null,(function(){e.close(),t()})))}))},e.onEntireSessionClosed=function(t){e.enableLogs&&console.info("Entire session is closed: ",t.sessionid,t.extra)},e.onstream=function(t){var n=e.videosContainer;n.insertBefore(t.mediaElement,n.firstChild);var i=t.mediaElement.play();void 0===i?setTimeout((function(){t.mediaElement.play()}),2e3):i.catch((function(){})).then((function(){setTimeout((function(){t.mediaElement.play()}),2e3)}))},e.onstreamended=function(e){e.mediaElement||(e.mediaElement=document.getElementById(e.streamid)),e.mediaElement&&e.mediaElement.parentNode&&e.mediaElement.parentNode.removeChild(e.mediaElement)},e.direction="many-to-many",e.removeStream=function(t,n){var i;e.attachStreams.forEach((function(e){e.id===t&&(i=e)})),i?(e.peers.getAllParticipants().forEach((function(t){if(!n||t===n){var o=e.peers[t];try{o.peer.removeStream(i)}catch(e){}}})),e.renegotiate()):console.warn("No such stream exist.",t)},e.addStream=function(n,i){if(n.getTracks)return-1===e.attachStreams.indexOf(n)&&(n.streamid||(n.streamid=n.id),e.attachStreams.push(n)),void e.renegotiate(i);function o(t){n.streamCallback&&n.streamCallback(t),e.renegotiate(i)}h(n)?e.renegotiate(i):(n.audio||n.video||n.screen)&&(n.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:b(e)}).then((function(i){i.isScreen=!0,t.onGettingLocalMedia(i),!n.audio&&!n.video||b(e)?o(i):e.invokeGetUserMedia(null,(function(e){o(e)}))}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:b(e),video:!0,isScreen:!0},(function(t){!n.audio&&!n.video||b(e)?o(t):e.invokeGetUserMedia(null,(function(e){o(e)}))})):(n.audio||n.video)&&e.invokeGetUserMedia(null,o))},e.invokeGetUserMedia=function(n,i,o){o||(o=e.session),n||(n=e.mediaConstraints),D({onGettingLocalMedia:function(e){var o=n.video;o&&(o.mediaSource||o.mozMediaSource||o.mandatory&&o.mandatory.chromeMediaSource)&&(e.isScreen=!0),e.isScreen||(e.isVideo=!!y(e,"video").length,e.isAudio=!e.isVideo&&y(e,"audio").length),t.onGettingLocalMedia(e,(function(){"function"==typeof i&&i(e)}))},onLocalMediaError:function(e,n){t.onLocalMediaError(e,n)},localMediaConstraints:n||{audio:!!o.audio&&n.audio,video:!!o.video&&n.video}})},e.applyConstraints=function(t,n){if(x&&x.prototype.applyConstraints){var i;if(n)return e.streamEvents[n]&&(i=e.streamEvents[n].stream),void g(i,t);e.attachStreams.forEach((function(e){g(e,t)}))}else alert("track.applyConstraints is NOT supported in your browser.")},e.replaceTrack=function(n,i,o){if(n=n||{},k.prototype.getSenders)if(n instanceof x)C(n,i,o);else{if(n instanceof w)return y(n,"video").length&&C(y(n,"video")[0],i,!0),void(y(n,"audio").length&&C(y(n,"audio")[0],i,!1));if(h(n))throw"connection.replaceTrack requires audio and/or video and/or screen.";(n.audio||n.video||n.screen)&&(n.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:b(e)}).then((function(i){i.isScreen=!0,t.onGettingLocalMedia(i),!n.audio&&!n.video||b(e)?r(i):e.invokeGetUserMedia(null,r)}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:b(e),video:!0,isScreen:!0},!n.audio&&!n.video||b(e)?r:e.invokeGetUserMedia(null,r)):(n.audio||n.video)&&e.invokeGetUserMedia(null,r))}else e.addStream(n);function r(t){e.replaceTrack(t,i,o||n.video||n.screen)}},e.resetTrack=function(t,n){t||(t=e.getAllParticipants()),"string"==typeof t&&(t=[t]),t.forEach((function(t){var i=e.peers[t].peer;void 0!==n&&!0!==n||!i.lastVideoTrack||e.replaceTrack(i.lastVideoTrack,t,!0),void 0!==n&&!1!==n||!i.lastAudioTrack||e.replaceTrack(i.lastAudioTrack,t,!1)}))},e.renegotiate=function(n){n?t.renegotiatePeer(n):e.peers.getAllParticipants().forEach((function(e){t.renegotiatePeer(e)}))},e.setStreamEndHandler=function(t,n){if(t&&t.addEventListener&&(n=!!n,!t.alreadySetEndHandler)){t.alreadySetEndHandler=!0;var i="ended";"oninactive"in t&&(i="inactive"),t.addEventListener(i,(function(){if(t.idInstance&&currentUserMediaRequest.remove(t.idInstance),!n){var i=[];e.attachStreams.forEach((function(e){e.id!=t.id&&i.push(e)})),e.attachStreams=i}var o=e.streamEvents[t.streamid];if(o||(o={stream:t,streamid:t.streamid,type:n?"remote":"local",userid:e.userid,extra:e.extra,mediaElement:e.streamEvents[t.streamid]?e.streamEvents[t.streamid].mediaElement:null}),n&&e.peers[o.userid]){var r=e.peers[o.userid].peer;i=[];r.getRemoteStreams().forEach((function(e){e.id!=t.id&&i.push(e)})),e.peers[o.userid].streams=i}o.userid===e.userid&&"remote"===o.type||(e.peersBackup[o.userid]&&(o.extra=e.peersBackup[o.userid].extra),e.onstreamended(o),delete e.streamEvents[t.streamid])}),!1)}},e.onMediaError=function(t,n){e.enableLogs&&console.error(t,n)},e.autoCloseEntireSession=!1,e.filesContainer=e.videosContainer=document.body||document.documentElement,e.isInitiator=!1,e.shareFile=t.shareFile,void 0!==_&&_.handle(e),void 0!==B&&B.handle(e),e.token=l,e.onNewParticipant=function(t,n){e.acceptParticipationRequest(t,n)},e.acceptParticipationRequest=function(e,n){n.successCallback&&(n.successCallback(),delete n.successCallback),t.createNewPeer(e,n)},void 0!==L&&(e.StreamsHandler=L),e.onleave=function(e){},e.invokeSelectFileDialog=function(e){var t=new FileSelector;t.accept="*.*",t.selectSingleFile(e)},e.onmute=function(e){if(e&&e.mediaElement)if("both"===e.muteType||"video"===e.muteType){e.mediaElement.src=null;var t=e.mediaElement.pause();void 0!==t?t.then((function(){e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"})):e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"}else"audio"===e.muteType&&(e.mediaElement.muted=!0)},e.onunmute=function(e){e&&e.mediaElement&&e.stream&&("both"===e.unmuteType||"video"===e.unmuteType?(e.mediaElement.poster=null,e.mediaElement.srcObject=e.stream,e.mediaElement.play()):"audio"===e.unmuteType&&(e.mediaElement.muted=!1))},e.onExtraDataUpdated=function(t){t.status="online",e.onUserStatusChanged(t,!0)},e.getAllParticipants=function(t){return e.peers.getAllParticipants(t)},void 0!==L&&(L.onSyncNeeded=function(n,i,o){e.peers.getAllParticipants().forEach((function(e){t.onNegotiationNeeded({streamid:n,action:i,streamSyncNeeded:!0,type:o||"both"},e)}))}),e.connectSocket=function(e){i(e)},e.closeSocket=function(){try{io.sockets={}}catch(e){}e.socket&&("function"==typeof e.socket.disconnect&&e.socket.disconnect(),"function"==typeof e.socket.resetProps&&e.socket.resetProps(),e.socket=null)},e.getSocket=function(t){return!t&&e.enableLogs&&console.warn("getSocket.callback paramter is required."),t=t||function(){},e.socket?t(e.socket):i((function(){t(e.socket)})),e.socket},e.getRemoteStreams=t.getRemoteStreams;var R=["selectFirst","selectAll","forEach"];if(e.streamEvents={selectFirst:function(t){return e.streamEvents.selectAll(t)[0]},selectAll:function(t){t||(t={local:!0,remote:!0,isScreen:!0,isAudio:!0,isVideo:!0}),"local"==t&&(t={local:!0}),"remote"==t&&(t={remote:!0}),"screen"==t&&(t={isScreen:!0}),"audio"==t&&(t={isAudio:!0}),"video"==t&&(t={isVideo:!0});var n=[];return Object.keys(e.streamEvents).forEach((function(i){var o=e.streamEvents[i];if(-1===R.indexOf(i)){var r=!0;t.local&&"local"===o.type&&(r=!1),t.remote&&"remote"===o.type&&(r=!1),t.isScreen&&o.stream.isScreen&&(r=!1),t.isVideo&&o.stream.isVideo&&(r=!1),t.isAudio&&o.stream.isAudio&&(r=!1),t.userid&&o.userid===t.userid&&(r=!1),!1===r&&n.push(o)}})),n}},e.socketURL="/",e.socketMessageEvent="RTCMultiConnection-Message",e.socketCustomEvent="RTCMultiConnection-Custom-Message",e.DetectRTC=DetectRTC,e.setCustomSocketEvent=function(t){t&&(e.socketCustomEvent=t),e.socket&&e.socket.emit("set-custom-socket-event-listener",e.socketCustomEvent)},e.getNumberOfBroadcastViewers=function(t,n){e.socket&&t&&n&&e.socket.emit("get-number-of-users-in-specific-broadcast",t,n)},e.onNumberOfBroadcastViewersUpdated=function(t){e.enableLogs&&e.isInitiator&&console.info("Number of broadcast (",t.broadcastId,") viewers",t.numberOfBroadcastViewers)},e.onUserStatusChanged=function(t,n){e.enableLogs&&!n&&console.info(t.userid,t.status)},e.getUserMediaHandler=D,e.multiPeersHandler=t,e.enableLogs=!0,e.setCustomSocketHandler=function(e){void 0!==c&&(c=e)},e.chunkSize=4e4,e.maxParticipantsAllowed=1e3,e.disconnectWith=t.disconnectWith,e.checkPresence=function(t,n){t=t||e.sessionid,"SSEConnection"!==c.name?e.socket?e.socket.emit("check-presence",t+"",(function(t,i,o){e.enableLogs&&console.log("checkPresence.isRoomExist: ",t," roomid: ",i),n(t,i,o)})):e.connectSocket((function(){e.checkPresence(t,n)})):SSEConnection.checkPresence(t,(function(t,i,o){if(!e.socket)return t||(e.userid=i),void e.connectSocket((function(){n(t,i,o)}));n(t,i)}))},e.onReadyForOffer=function(t,n){e.multiPeersHandler.createNewPeer(t,n)},e.setUserPreferences=function(t){return e.dontAttachStream&&(t.dontAttachLocalStream=!0),e.dontGetRemoteStream&&(t.dontGetRemoteStream=!0),t},e.updateExtraData=function(){e.socket.emit("extra-data-updated",e.extra)},e.enableScalableBroadcast=!1,e.maxRelayLimitPerUser=3,e.dontCaptureUserMedia=!1,e.dontAttachStream=!1,e.dontGetRemoteStream=!1,e.onReConnecting=function(t){e.enableLogs&&console.info("ReConnecting with",t.userid,"...")},e.beforeAddingStream=function(e){return e},e.beforeRemovingStream=function(e){return e},"undefined"!=typeof isChromeExtensionAvailable&&(e.checkIfChromeExtensionAvailable=isChromeExtensionAvailable),"undefined"!=typeof isFirefoxExtensionAvailable&&(e.checkIfChromeExtensionAvailable=isFirefoxExtensionAvailable),"undefined"!=typeof getChromeExtensionStatus&&(e.getChromeExtensionStatus=getChromeExtensionStatus),e.modifyScreenConstraints=function(e){return e},e.onPeerStateChanged=function(t){e.enableLogs&&-1!==t.iceConnectionState.search(/closed|failed/gi)&&console.error("Peer connection is closed between you & ",t.userid,t.extra,"state:",t.iceConnectionState)},e.isOnline=!0,m("online",(function(){e.isOnline=!0})),m("offline",(function(){e.isOnline=!1})),e.isLowBandwidth=!1,navigator&&navigator.connection&&navigator.connection.type&&(e.isLowBandwidth=-1!==navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g),e.isLowBandwidth)){if(e.bandwidth={audio:!1,video:!1,screen:!1},e.mediaConstraints.audio&&e.mediaConstraints.audio.optional&&e.mediaConstraints.audio.optional.length){var T=[];e.mediaConstraints.audio.optional.forEach((function(e){void 0===e.bandwidth&&T.push(e)})),e.mediaConstraints.audio.optional=T}if(e.mediaConstraints.video&&e.mediaConstraints.video.optional&&e.mediaConstraints.video.optional.length){T=[];e.mediaConstraints.video.optional.forEach((function(e){void 0===e.bandwidth&&T.push(e)})),e.mediaConstraints.video.optional=T}}e.getExtraData=function(t,n){if(!t)throw"remoteUserId is required.";if("function"!=typeof n)return e.peers[t]?e.peers[t].extra:e.peersBackup[t]?e.peersBackup[t].extra:{};e.socket.emit("get-remote-user-extra-data",t,(function(e,t,i){n(e,t,i)}))},a.autoOpenOrJoin&&e.openOrJoin(e.sessionid),e.onUserIdAlreadyTaken=function(t,n){e.close(),e.closeSocket(),e.isInitiator=!1,e.userid=e.token(),e.join(e.sessionid),e.enableLogs&&console.warn("Userid already taken.",t,"Your new userid:",e.userid)},e.trickleIce=!0,e.version="3.6.9",e.onSettingLocalDescription=function(t){e.enableLogs&&console.info("Set local description for remote user",t.userid)},e.resetScreen=function(){sourceId=null,DetectRTC&&DetectRTC.screen&&delete DetectRTC.screen.sourceId,currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[]}},e.autoCreateMediaElement=!0,e.password=null,e.setPassword=function(t,n){n=n||function(){},e.socket?e.socket.emit("set-password",t,n):(e.password=t,n(!0,e.sessionid,null))},e.onSocketDisconnect=function(t){e.enableLogs&&console.warn("socket.io connection is closed")},e.onSocketError=function(t){e.enableLogs&&console.warn("socket.io connection is failed")},e.errors={ROOM_NOT_AVAILABLE:"Room not available",INVALID_PASSWORD:"Invalid password",USERID_NOT_AVAILABLE:"User ID does not exist",ROOM_PERMISSION_DENIED:"Room permission denied",ROOM_FULL:"Room full",DID_NOT_JOIN_ANY_ROOM:"Did not join any room yet",INVALID_SOCKET:"Invalid socket",PUBLIC_IDENTIFIER_MISSING:"publicRoomIdentifier is required",INVALID_ADMIN_CREDENTIAL:"Invalid username or password attempted"}}(this)};e.exports=t=r,void 0===(o=function(){return r}.apply(t,[]))||(e.exports=o)}).call(this,n("yLpj"),n("8oxB"))}}]);
//# sourceMappingURL=live-as-guest.js.map?id=4e47f8419f8b928d9764